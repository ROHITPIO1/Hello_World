     ********************************************************************
     *  IBM SYSTEM/38  11/20/85  K WAYNE MADDEN                         *
     *  MINERAL SYSTEM - DIVISION ORDER FILE MAINTENANCE                *
     *                                                                  *
     *=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-*
     *  MNDPF7 - HOLD MINERAL OWNERSHIP CHANGES                         *
     *                                                                  *
     *  ACCESSED THRU SUBROUTINES:                                      *
     *                                                                  *
     *  WOCDLT - OWNERSHIP DELETE                                       *
     *  WOCSPL - OWNERSHIP SPLITS                                       *
     *  WOCAOW - OWNERSHIP ADDS                                         *
     *  WOCCOW - OWNERSHIP CHANGES                                      *
     *  WOCCTY - OWNERSHIP INTEREST TYPE CHANGES                        *
     *=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-*
     *********************************************************************
     * MODIFICATION LOG
     *********************************************************************
     *  DATE          P/A     DESCRIPTION                               *
     *  07/24/2017    MMCN    JUST RECOMPILE PROGRAM DUE TO CHANGE      *
     *                        IN SCREEN MNDF01/MNDR05 FORMAT.           *
     *                        DISPLAY ERROR MESSAGE FOR INVALID TYPE.   *
     *                        (LEASE INTEREST TYPES: RI,OR,OP,WI,RA)    *
     ********************************************************************
     *
     * MINERAL OWNER FILE BY OWNER NUMBER
     *
     h Option(*debugio:*srcstmt) INDENT('|')
     FMNOLFO    UF A E           K DISK
     *
     * MINERAL OWNER FILE BY OWNER NAME
     *
     FMNOLFN    IF   E           K DISK
     F                                     RENAME(MNOPR:MNOLRN)
     *
     * MINERAL OWNER FILE BY AGENT#/NAME20
     *
     FMNOLFAN   IF   E           K DISK
     F                                     RENAME(MNOPR:MNOLRAN)
     *   agent communication
     fmnopf5    uf a e           k disk
     *
     *  Harris county acct# / group #
     fmnopf3    uf a e           k disk
     fmnolf3a   if   e           k disk    rename(mnopr3:pf03acct)
     f                                     usropn
     fmnolf3g   if   e           k disk    rename(mnopr3:pf03grup)
     f                                     usropn
     *
     * MINERAL LEASE HEADER FILE BY LEASE#,RRC#
     *
     FMNHLFL    UF A E           K DISK
     *
     * MINERAL LEASE HEADER FILE BY LEASE NAME
     *
     FMNHLFN    IF   E           K DISK
     F                                     RENAME(MNHPR:MNHLRN)
     *
     * MINERAL LEASE HEADER FILE BY DESCRIPTION
     *
     FMNHLFD    IF   E           K DISK
     F                                     RENAME(MNHPR:MNHLRD)
     *
     * MINERAL LEASE HEADER FILE BY OPERATOR NAME
     *
     FMNHLFO    IF   E           K DISK
     F                                     RENAME(MNHPR:MNHLRO)
     *
     *  MINERAL LEASE HEADER - LEASES FLAGGED FOR DELETE
     *
     FMNHLFDEL  UF   E           K DISK
     F                                     RENAME(MNHPR:MNHLRDEL)
     *
     * MINERAL APPRAISAL FILE BY LEASE#,RRC#
     *
     FMNALFLR   IF   E           K DISK
     *
     * MINERAL APPRAISAL FILE BY job, arrc, lse
     *
     FMNALFrl   IF   E           K DISK     rename(mnapr:@@mnapr)
     *
     * MINERAL UNIT APPRAISAL FILE BY LEASE#,RRC#
     *
     FMNULFL    IF   E           K DISK
     * MINERAL INTERNET PASSWORD
     *
     FMNOLF6    IF   E           K DISK
     *
     * MINERAL DIVISION ORDER WORK FILE FOR VIEWING ON SCREEN
     *
     FMNDPF1    UF A E           K DISK    USROPN
     *
     * MINERAL DIVISION ORDER WORK FILE FOR DUPLSR SR
     *
     FMNDWPF1   UF A E           K DISK    USROPN
     *
     * MINERAL DIVISION ORDER FILE BY LEASE#,OWNER AND LEASE TYPE
     *
     FMNDLFL    UF A E           K DISK
     *
     * MINERAL DIVISION ORDER FILE BY OWNER# THEN LEASE#
     *
     FMNDLFO    UF   E           K DISK
     F                                     RENAME(MNDPR:MNDLRO)
     FMNDLF7A   IF   E           K DISK
     F                                     RENAME(MNDPR7:MNDLR7A)
     FMNDLF7B   IF   E           K DISK
     F                                     RENAME(MNDPR7:MNDLR7B)
     FMNDLF7C   IF   E           K DISK
     F                                     RENAME(MNDPR7:MNDLR7C)
     FMNDLF7E   IF   E           K DISK    USROPN
     F                                     RENAME(MNDPR7:MNDLR7E)
     FMNDPF7    O  A E             DISK
     FMNDLF5OA  IF   E           K DISK
     *
     * D/O OWNERSHIP CHANGES NEXT REFERENCE NUMBER
     FMNDACTPF  UF A E           K DISK
     *
     *  HOLD OWNER RECORD CHANGES
     FMNOLF2DE  IF   E           K DISK
     F                                     RENAME(MNOPR2:MNOLR2DE)
     FMNOPF2    O    E             DISK
     *
     * MINERAL AGENT FILE BY AGENT NUMBER
     *
     FMNGLFA    IF   E           K DISK
     *
     * MINERAL OWNER VALUE SAVE FILE
     *
     FMNDEPF1   IF   E           K DISK    USROPN
     *
     * MINERAL DIVISION ORDER CUSTOMER GEO# FILE
     *
     FMNXPF     UF A E           K DISK
     *
     * MINERAL DIVISION ORDER CUSTOMER GEO# LOGICAL FILE
     *
     FMNXLFA    IF   E           K DISK    RENAME(mnxpr:@mnxpr) prefix(X#)
     *
     * MINERAL INVENTORY FILE FOR
     *
     FMNILFOS   IF   E           K DISK
     *
     * UTILITY NOTES FILE (STORES NOTES ENTERED VIA C13 UTFM01)
     *
     FUTNPF     IF   E           K DISK
     *
     * MINERAL - SPLIT CHANGE FILE
     *
     FMNDLF8L   O    E           K DISK
     *
     *
     * JOB FILE - LOGICAL WITH MINERAL FIELDS ONLY IN RECORD FORMAT
     *
     * LFMN    IF   E           K DISK
     FJFLFJM    IF   E           K DISK
     *
     *  OWNER REASON CODE TABLE FILE
     *
     FMNTPF13   IF   E           K DISK
     *
     *  SPECIAL OPERATOR JOB FILE
     *
     FMNTPF18   IF   E           K DISK
     *
     * MINERAL - NEXT OWNER/PARCEL NUMBER FILE
     *
     FMNNPF     UF   E           K DISK
     * OWNER EMAIL ADDRESS
     *
     FMNOPF4    UF A E           K DISK    prefix(M#)
     * Lousianna owner cross ref
     Fmnoxolf   uF a E           K DISK
     Fmnoxlfo   iF   E           K DISK    rename(mnoxpr:@mnoxpr)
     *
     FQPRINT    O    F  132        PRINTER OFLIND(*INOF)
     F                                     USROPN
     *
     *    saved file for notices
     fXMLMPF2   if   e           k disk    prefix(Q)
     * MINERAL DIVISION ORDER PROGRAM DISPLAY FILE
     *
     FMNDF01    CF   E             WORKSTN
     F                                     SFILE(MNSF02:NMERRN)
     F                                     SFILE(MNSF04:HLDRRN)
     F                                     SFILE(MNSF06:OWNRRN)
     F                                     SFILE(MNSF08:LSERRN)
     F                                     SFILE(MNSF10:OWNRRN)
     F                                     SFILE(MNSF10A:OWNRRN)
     F                                     SFILE(MNSFAG:NMERRN)
     f                                     infds(cfkeys)
     *
     d cfkeys          ds
     d   enterkee            369    369
     d scrnname        s             20    inz('OBJPASYS/MNDF01N')
     *scrnname        s             20    inz('VBRO/MNDF01')
     D PR1             S             14    DIM(2) CTDATA PERRCD(1)              QCAEXEC PARM
     *
     D JJR             S              2    DIM(999)                             JOBFILE JSC
     *
     D SO              S              7  0 DIM(400)                             SPLIT OWNERS
     D ST              S             30    DIM(400)                             SPLIT NAMES
     D SI              S              7  6 DIM(400)                             SPLIT INTEREST
     D SP              S              4  4 DIM(400)                             SPLIT PERCENT
     D ASO             S              7  0 DIM(400)                             ALT SPLIT OWNERS
     D AST             S             30    DIM(400)                             ALT SPLIT NAMES
     D SVSO            S              7  0 DIM(400)
     D SVSP            S              4  4 DIM(400)
     D ASVSO           S              7  0 DIM(400)                             ALTERNATE
     D ASVSP           S              4  4 DIM(400)                             ALTERNATE
     *
     D @CD             S              3  0 DIM(6)
     *
     d dtli          e ds                  extname(mnalflr:mnapr:*input)
     d                                     qualified
     *
     D                 DS
     D  NAME30                 1     30
     D  NAME26                 1     26
     D  NAME27                 1     27
     D  NAME25                 1     25
     d  name24                 1     24
     D  NAME20                 1     20
     D  NAME10                21     30
     D  NM                     1     30
     D                                     DIM(30)                              NAME CHECK
     D                 DS
     D CARE                          30
     D  AD1                          10    OVERLAY(CARE)
     D                 DS
     D STREET                        30
     D  AD2                          10    OVERLAY(STREET)
     D                 DS
     D CTST30                        30
     D  CITY16                       16    OVERLAY(CTST30)
     *                                       1   8 AD38
     *                                       1  10 AD3
     D  @ICSZ1                        1    INZ(' ')
     D                                     OVERLAY(CTST30:17)
     D  STE2A                         2    OVERLAY(CTST30:18)
     D  @ICSZ2                        1    INZ(' ')
     D                                     OVERLAY(CTST30:20)
     D  ZIPA                          5    OVERLAY(CTST30:21)
     D  ZDASH                         1    OVERLAY(CTST30:26)
     D  PLUS4                         4    OVERLAY(CTST30:27)
     D                 DS
     D LNAME                         30
     D  LNAM28                       28    OVERLAY(LNAME)
     D   LNAM25                      25    OVERLAY(LNAM28)
     D    LNAM20                     20    OVERLAY(LNAM25)
     D  LNAM10                       10    OVERLAY(LNAME:21)
     D                 DS
     D DESC1                         30
     D  DSC125                       25    OVERLAY(DESC1)
     D   DSC120                      20    OVERLAY(DSC125)
     D  DSC110                       10    OVERLAY(DESC1:21)
     D                 DS
     D OPRN                          20
     D  OPRN10                       10    OVERLAY(OPRN)
     D   OPRN8                        8    OVERLAY(OPRN10)
     D                 DS
     D  LJR1                   1      2
     D  LJR2                   3      4
     D  LJR3                   5      6
     D  LJR4                   7      8
     D  LJR5                   9     10
     D  LJR6                  11     12
     D  LJR7                  13     14
     D  LJR8                  15     16
     D  LJR9                  17     18
     D  LJR                    1     18
     D                                     DIM(9)                               LEASE JSC
     D  LJRC                   1     18
     D                 DS
     D  LJP1                   1      7  6
     D  LJP2                   8     14  6
     D  LJP3                  15     21  6
     D  LJP4                  22     28  6
     D  LJP5                  29     35  6
     D  LJP6                  36     42  6
     D  LJP7                  43     49  6
     D  LJP8                  50     56  6
     D  LJP9                  57     63  6
     D  LJP                    1     63  6
     D                                     DIM(9)                               LEASE PERCENT
     D                 DS
     D  LJRI1                  1     11  0
     D  LJRI2                 12     22  0
     D  LJRI3                 23     33  0
     D  LJRI4                 34     44  0
     D  LJRI5                 45     55  0
     D  LJRI6                 56     66  0
     D  LJRI7                 67     77  0
     D  LJRI8                 78     88  0
     D  LJRI9                 89     99  0
     D  LJRI10               100    110  0
     D  LJRI11               111    121  0
     D  LJRI12               122    132  0
     D  LJRI                   1    132  0
     D                                     Dim(12)
     D                 DS
     D  LJWI1                  1     11  0
     D  LJWI2                 12     22  0
     D  LJWI3                 23     33  0
     D  LJWI4                 34     44  0
     D  LJWI5                 45     55  0
     D  LJWI6                 56     66  0
     D  LJWI7                 67     77  0
     D  LJWI8                 78     88  0
     D  LJWI9                 89     99  0
     D  LJWI10               100    110  0
     D  LJWI11               111    121  0
     D  LJWI12               122    132  0
     D  LJWI                   1    132  0
     D                                     Dim(12)
     D                 DS
     D  DJR1                   1      2
     D  DJR2                   3      4
     D  DJR3                   5      6
     D  DJR4                   7      8
     D  DJR5                   9     10
     D  DJR6                  11     12
     D  DJR7                  13     14
     D  DJR8                  15     16
     D  DJR9                  17     18
     D  DJR                    1     18
     D                                     DIM(9)                               D/O JSC
     D  DJRC                   1     18

     D                 DS
     D  DJV1                   1      5P 0
     D  DJV2                   6     10P 0
     D  DJV3                  11     15P 0
     D  DJV4                  16     20P 0
     D  DJV5                  21     25P 0
     D  DJV6                  26     30P 0
     D  DJV7                  31     35P 0
     D  DJV8                  36     40P 0
     D  DJV9                  41     45P 0
     D  DJV                    1     45P 0
     D                                     DIM(9)                               D/O JSC VALUES

     D                 DS
     D  RC1                    1      7  0
     D  RC2                    8     14  0
     D  RC3                   15     21  0
     D  RC4                   22     28  0
     D  RC5                   29     35  0
     D  RC6                   36     42  0
     D  RC7                   43     49  0
     D  RC8                   50     56  0
     D  RC9                   57     63  0
     D  RC10                  64     70  0
     D  RC11                  71     77  0
     D  RC12                  78     84  0
     D  RC13                  85     91  0
     D  RC14                  92     98  0
     D  RC15                  99    105  0
     D  RC16                 106    112  0
     D  RC17                 113    119  0
     D  RC18                 120    126  0
     D  RC                     1    126  0
     D                                     DIM(18)                              LEASE RRC#

     D                 DS
     D  uRC1                   1      7  0
     D  uRC2                   8     14  0
     D  uRC3                  15     21  0
     D  uRC4                  22     28  0
     D  uRC5                  29     35  0
     D  urc                    1     35  0
     D                                     DIM(5)                               LEASE RRC#

     D                 DS
     D  UC1                    1      7  0
     D  UC2                    8     14  0
     D  UC3                   15     21  0
     D  UC4                   22     28  0
     D  UC5                   29     35  0
     D  UC6                   36     42  0
     D  UC7                   43     49  0
     D  UC8                   50     56  0
     D  UC9                   57     63  0
     D  UC                     1     63  0
     D                                     DIM(9 )

     D                 DS
     D @LJUR1                  1      2
     D @LJUR2                  3      4
     D @LJUR3                  5      6
     D @LJUR4                  7      8
     D @LJUR5                  9     10
     D @LJUR6                 11     12
     D @LJUR7                 13     14
     D @LJUR8                 15     16
     D @LJUR9                 17     18
     D @LJUR                   1     18
     D                                     DIM(9)                               LEASE JSC
      *
     D                 DS
     D  LYV01                  1     11  0
     D  LYV02                 12     22  0
     D  LYV03                 23     33  0
     D  LYV04                 34     44  0
     D  LYV05                 45     55  0
     D  LYV06                 56     66  0
     D  LYV07                 67     77  0
     D  LYV08                 78     88  0
     D  LYV09                 89     99  0
     D  LYV                    1     99  0
     D                                     DIM(9) INZ(0)                        MKT
      *
      * cap amount
     D*                DS
     D* CCV1                   1     09  0
     D* CCV2                  10     18  0
     D* CCV3                  19     27  0
     D* CCV4                  28     36  0
     D* CCV5                  37     45  0
     D* CCV6                  46     54  0
     D* CCV7                  55     63  0
     D* CCV8                  64     72  0
     D* CCV9                  73     81  0
     D* CCV                    1     81  0
     D*                                    Dim(09) INZ(0)
      *
      * cap loss
     D                 DS
     D  CPL01                  1     11  0
     D  CPL02                 12     22  0
     D  CPL03                 23     33  0
     D  CPL04                 34     44  0
     D  CPL05                 45     55  0
     D  CPL06                 56     66  0
     D  CPL07                 67     77  0
     D  CPL08                 78     88  0
     D  CPL09                 89     99  0
     D  CPL10                100    110  0
     D  CPL11                111    121  0
     D  CPL12                122    132  0
     D  CPL                    1    132  0
     D                                     Dim(12) INZ(0)
      *

     D                 DS
 N2Kd***                                     1   60UDATE2
     D UDATE2                         8  0
 N2Kd***                                     1   20YY
     D  YY                            4  0 OVERLAY(UDATE2)
 N2Kd***                                     3   40MM
     D  MM                            2  0 OVERLAY(UDATE2:5)
 N2Kd***                                     5   60DD
     D  DD                            2  0 OVERLAY(UDATE2:7)
     D                 DS
     D  PR2                    1     50
     D                                     DIM(1) CTDATA PERRCD(1)              QCAEXEC PARM
     D  PR2JB                 10     16
     D  PR2JSC                23     24
     D  PR2OPT                31     31
     D  PR2BG                 39     45
     D                 DS
     D  PR3                    1     70
     D                                     DIM(1) CTDATA PERRCD(1)              QCAEXEC PARM
     D  SEL2                  26     27  0
     D  NBR1                  35     41  0
     D  NBR2                  49     55  0
     D  NBR3                  63     69  0
     D                 DS
     D  PR4                    1     81
     D                                     DIM(1) CTDATA PERRCD(1)              QCAEXEC PARM
     D  PR4JB                 12     18
     D  PR4BG                 25     31
     D  PR4EMAIL              40     81
     *
     D                 DS
     D CODATE                         8  0
     D  COYR4                         4  0 OVERLAY(CODATE)
     D  COMM2                         2  0 OVERLAY(CODATE:5)
     D  CODD2                         2  0 OVERLAY(CODATE:7)
     *
     *           DS
     *                                       1   70NREF#
     *                                       1   70NACT#
     *
     D                 DS
     D  OCCD01                 1      3  0
     D  OCCD02                 4      6  0
     D  OCCD03                 7      9  0
     D  OCCD04                10     12  0
     D  OCCD05                13     15  0
     D  OCCD06                16     18  0
     D  OCD                    1     18  0
     D                                     DIM(6)
     *
     D DSUSR           DS
     D MT13LB                101    104
     *
     d  dummyrec       ds                  likerec(mnhpr)
     * PROGRAM STATUS INFORMATION
     D                SDS
     D @PGM                          10
     D @STAT#                         5  0
     D @PSTA#                         5  0
     D @ROUTN                 29     36
     D @PARMS                         3  0
     D @PLIB                  81     90
     D @JOB                  244    253
     D @USER                         10
     D @JOB#                          6  0
     D @UDATE                         6  0
     D @EDATE                         6  0
     D @ETIME                         6  0
     *
 N2Ka* INTO2000 Common DS
IN2KaD                 DS
     D IN2KX8                         8  0
     D  IN2KX6                        6  0 OVERLAY(IN2KX8)
     D   IN2KX4                       4  0 OVERLAY(IN2KX6)
     D    IN2KP1                      2  0 OVERLAY(IN2KX4)
     D    IN2KP2                      2  0 OVERLAY(IN2KX4:3)
     D   IN2KP3                       2  0 OVERLAY(IN2KX6:5)
     D  IN2KP4                        2  0 OVERLAY(IN2KX8:7)
 N2Ka* Flip Year Structure
 N2Ka* Flip year structure
IN2KaD                 DS
     D Y2KYMD                         8  0
     D  Y2KYYL                        4  0 OVERLAY(Y2KYMD)
     D Y2KMDY                  5     12  0
     D  Y2KYYR                        4  0 OVERLAY(Y2KMDY:5)
     *---------------------------------------------------------------------
     * Stand Alone Fields - TOP
     *---------------------------------------------------------------------
     D white           c                   const(x'22')
     d flag            s              2a   inz
     d hcad            s              1A   inz
     d hcacgr          s              1A   inz
     d wrkda           s               d
     D #L              S              5  0
     D @A              S              5  0
     D @B              S              5  0
     D @IN04           S                   LIKE(*IN01)
     D @IN31           S                   LIKE(*IN01)
     D @IN32           S                   LIKE(*IN01)
     D @IN33           S                   LIKE(*IN01)
     D @IN34           S                   LIKE(*IN01)
     D @IN35           S                   LIKE(*IN01)
     D @IN36           S                   LIKE(*IN01)
     D @IN37           S                   LIKE(*IN01)
     D @IN38           S                   LIKE(*IN01)
     D @IN39           S                   LIKE(*IN01)
     D @IN01           S              1
     D @IN27           S              1
     D @L              S              5  0
     D @PF3TM          S              6  0
     D #OWNER          S                   LIKE(OWNER)
     D @OWNER          S                   LIKE(OWNER)
     D A               S              5  0
     D ADJSCO          S              2
     D ADSAV           S              2
     D AD3             S             10
     D B               S              5  0
     D BITDSP          S              1
     D C               S              5  0
     D CLCLSE          S             10
     D CODLTY          S                   LIKE(COTYPE)
     D COWN            S                   LIKE(OWNER)
     D CSOPR           S                   LIKE(SOPR)
     D DCINEW          S              7  6
     D DCISAV          S              7  6
     D DECSAV          S              7  6
     D DEC2            S              7  6
     D DL#             S              3  0
     D DNMPRV          S             30
     D DUPLS#          S                   LIKE(LSE#)
     D D20PRV          S             20
     D EXDATE          S              8  0
     D EXUSER          S             10
     D JOBHIH          S              7  0
     D JOBLOW          S              7  0
     D JOBNAM          S             30
     D JOBSAV          S              7  0
     D LSE#SAVE        S                    LIKE(LSE#)
     D JOBSV           S                    LIKE(JOB)
     D JOBSAVE         S                    LIKE(JOB)
     D JPASS           S              7  0
     D lcodsv          S                    LIKE(lcod)
     D LOCKDL          S              1
     D LOCKDO          S              1
     D LOCKH           S              1
     D LOCKO           S              1
     D LSEPRV          S              7  0
     D LSESAV          S              7  0
     D LSNPRV          S             20
     D LSTHLD          S              1  0
     D LSTOHL          S                   LIKE(LSE#)
     D LSTPRV          S              1  0
     D LSETTL          S             11  0
     D LSTSAV          S              1  0
     D M2SRDT          S              8  0
     D M2SRID          S             10
     D NAMPRV          S             20
     D NAMSAV          S             30
     D NEWNAM          S             30
     D NEWTOT          S              7  6
     D NMC2            S             30
     D NMC2NW          S             30
     D NNAM30          S             30
     D NULL            S              1
     D NXCOCS          S                   LIKE(COPSQ#)
     D OPNPRV          S             20
     D OVWTYP          S              4
     D OWNFRM          S                   LIKE(OWNER)
     D OWNHLD          S              7  0
     D jobHLD          S                   like(job)
     D LSEHLD          S                   like(LSE#)
     D OWNIN           S              7  0
     D OWNPRV          S              7  0
     D OWNSAV          S              7  0
     D OWNTO           S                   LIKE(OWNER)
     D PARM1           S             14
     D PARM2           S             15  5
     D PARM3           S             50
     D PARM4           S             15  5
     D PARM5           S             70
     D PARM6           S             15  5
     D*PARM7           S             30
     D PARM7           S             83
     D PARM8           S             15  5
     D PARM9           S             14
     D PF5FLG          S              1
     D PF7FLG          S              1
     D POWN            S                   LIKE(OWNER)
     D PSOPR           S                   LIKE(SOPR)
     D R#              S              2  0
     D RSCDIN          S                   LIKE(REAS)
     D RTNCDE          S              8
     D S@LSE#          S                   LIKE(LSE#)
     D S@LSET          S                   LIKE(LSETYP)
     D S@SOPR          S                   LIKE(SOPR)
     D SELOWN          S              1
     D SEL1            S             10
     D SOPPRV          S              3  0
     D SOPSAV          S              3  0
     D SpOprFlag       S              1A                                        Specl Operator Flag
     D SPLFLG          S              1
     D SRTPRV          S              5  0
     D STRCOL          S              3  0
     D STRROW          S              3  0
     D STRTME          S              6  0
     D SVALTY          S                   LIKE(INTA)
     D SVCACT          S                   LIKE(COCACT)
     D SVCDEC          S                   LIKE(COCDEC)
     D SVCSQ#          S                   LIKE(COCSQ#)
     D SVDCAC          S                   LIKE(COCACT)
     D SVLCSQ          S                   LIKE(COCSQ#)
     D SVLSE#          S                   LIKE(LSE#)
     D SVOWN           S                   LIKE(OWNER)
     D SVPACT          S                   LIKE(COCACT)
     D SVPDEC          S                   LIKE(COCDEC)
     D SVPSQ#          S                   LIKE(COPSQ#)
     D SVREAS          S                   LIKE(REAS)
     D SVAGENT#        S                   LIKE(AGENT#)
     D @agent#         S                   LIKE(AGENT#)
     D SVSHRE          S              6  4
     D TESTJ           S              2
     D TOTINT          S              7  6
     D TOTOP           S              7  6
     D TOTOR           S              7  6
     D TOTRA           S              7  6
     D TOTRI           S              7  6
     D TOTRIT          S              7  6
     D TOTRV           S              9  0
     D TOTWI           S              7  6
     D TOTWIT          S              7  6
     D TOTWV           S              9  0
     D TSSIAF          S              9  6
     D TSSIBF          S              9  6
     D TSSOAF          S              9  0
     D TSSOBF          S              9  0
     D TSSPAF          S              4  4
     D TSSPBF          S              4  4
     D TURV            S              9  0
     D TUWV            S              9  0
     D USER            S             10
     D X               S              5  0
     D Z               S              5  0
     D @STREET         S             30A   VARYING
     D @OBJ            S             10    INZ('MNOPF')
     D @TYPE           S             10    INZ('*FILE')
     D @AUTH           S              1    INZ(*BLANKS)
     D #NAME30         S                   LIKE(NAME30)
     D #CARE           S                   LIKE(CARE  )
     D #STREET         S                   LIKE(STREET)
     D #CITYSTZP       S                   LIKE(ALTCSZ)
     d entr            s             25a   inz('Press ENTER to ADD/CHG')
     d EnterKey        c                   const(x'F1')
     *---------------------------------------------------------------------
     * Stand Alone Fields - BOTTOM
     *---------------------------------------------------------------------
     ****************************************************************
     *  THESE ARRARYS ARE USED TO RETURN THE DATA WHEN MULTIPLE
     *  MATCHES ARE FOUND
     d  a1#            s             64    dim(100)                             mlt sec addr
     d  a2#            s             64    dim(100)                             MLT DEL ADDR
     d  no#            s             10    dim(100)                             MLT STR NO
     d  pr#            s              2    dim(100)                             MLT PRE DIR
     d  nm#            s             28    dim(100)                             MLT NTR NAME
     d  sf#            s              4    dim(100)                             MLT STR SUFFIX
     d  ps#            s              2    dim(100)                             MLT POST DIR
     d  at#            s              4    dim(100)                             MLT APT TYPE
     d  an#            s              8    dim(100)                             MLT APT NUMBER
     d  ct#            s             28    dim(100)                             MLT CITY NAME
     d  ca#            s             13    dim(100)                             MLT CITY ABRV
     d  st#            s              2    dim(100)                             MLT STATE CODE
     d  z5#            s              5    dim(100)                             MLT ZIP CODE
     d  Z4#            s              4    dim(100)                             MLT ZIP+4
     d  LL#            s             64    dim(100)                             MLT LAST LINE
     d  CR#            s              4    dim(100)                             MLT CARRIER RTE
     d  DP#            s              3    dim(100)                             MLT DEL PT
     d  CO#            s             25    dim(100)                             MLT COUNTY NAME
     d  CS#            s              2    dim(100)                             MLT COUNTY STATE CD
     d  FS#            s              2    dim(100)                             MLT FIPS STATE #
     d  FC#            s              3    dim(100)                             MLT FIPS COUNTY #
     d  CD#            s              2    dim(100)                             MLT CONG DIST#
     d  LC#            s              1    dim(100)                             MLT LACS IND
     d  SL#            s              1    dim(100)                             MLT STR MATCHLEV
     d  AF#            s              1    dim(100)                             MLT SEC ADR FLAG
     ****************************************************************
     *  archive table
     d  ark#           s              5p 0 inz
     d  arkl           s              7p 0 dim(2500) inz
     *
     IJFPR
     I              JOBNAM                      MNJNAM
     *
     IMNOLR2DE
     I              MNODEL                      M2ODEL
     I              JOB                         M2B
     I              OWNER                       M2NER
     I              NAME20                      M2ME20
     I              NAME10                      M2ME10
     I              CARE                        M2RE
     I              STREET                      M2REET
     I              ALTCSZ                      M2TCSZ
     I              CITY16                      M2TY16
     I              STE2A                       M2E2A
     I              ZIPA                        M2PA
     I              ZDASH                       M2ASH
     I              PLUS4                       M2US4
     I              AGENT#                      M2ENT#
     I              REND                        M2ND
     I              SORT                        M2RT
     I              REAS                        M2AS
     I              DVAMT                       M2AMT
     I              MNOXC1                      M2OXC1
     I              MNOXC2                      M2OXC2
IN2K+I              MPF3DT                      M2F3DT
     I              MPF3TM                      M2F3TM
     I              MPF3US                      M2F3US
     I              MNASEQ                      M2ASEQ
     I              PRIVCD                      M2IVCD
     I              MUSRC1                      M2SRC1
     I              MUSRC2                      M2SRC2
     I              MUSRC3                      M2SRC3
     *
     ixmlmpr
     i              typrop                      xtypp
 N2Ka*
     C     *ENTRY        PLIST
     C                   PARM                    USER
     *
 1b  C     @IN01         CASNE     *ON           SRINIT
 1e  C                   ENDCS
      /EJECT
     *
     *******************************************************************
     *                                                                 *
     * BEGIN MAINLINE CALCULATIONS                                     *
     *                                                                 *
     *       DISPLAY SCREEN FOR ENTERING JOB NUMBER TO PROCESS         *
     *                                                                 *
     *       VERIFY THAT JOB NUMBER IS VALID AND LOAD JURISDICTIONS    *
     *              FOR THAT APPRAISAL DISTRICT.                       *
     *                                                                 *
     *******************************************************************
     *
     C     START         TAG                                                    START       Tag
     C                   EVAL      JOB = 0
     C                   MOVEA     *ALL'0'       *IN
     *
     * USED FOR RECORD LOCKING FLAGS
     *
     C                   MOVE      'N'           LOCKO
     C                   MOVE      'N'           LOCKH
     C                   MOVE      'N'           LOCKDL
     C                   MOVE      'N'           LOCKDO
     *
     *  DISPLAY SCREEN FOR JOB NUMBER ENTRY
     *
     C     JOBAGN        TAG                                                    JOBAGN      Tag
     * Flip Year Left to Right
     * Flip year from YYYYMMDD (8) to MMDDYYYY (8) for Output
     C                   MOVE      USDTDE        Y2KYMD
     C                   EVAL      Y2KYYR = Y2KYYL
     C                   MOVE      Y2KMDY        Y2K001
     *
     c                   exsr      getlouisown
     *
     c                   eval      USERPWD  = *blanks
     C     OWNKEY        CHAIN     MNOLF6
     C                   EXFMT     MNDR00                                                   I/O
     *
     C                   EVAL      *IN61 = (JOB = 309801 or job = 215400
     c                                     or job = 317900 or job = 416600
     C                             OR JOB >= 980000 AND JOB <= 992700           LOUISIANNA
     c                                     or job = 125200)
     *** to open up
     *** the owner nbr  EVAL      *IN99 = (JOB = 219800)
     ***                EVAL      *IN99 = (JOB = 304400)
     c                   eval      *in99 = *off
 1b  c                   if        job = 304400
     C                             OR JOB >= 980000 AND JOB <= 999900           LOUISIANNA
     c                   eval      *in99 = *on
 1e  c                   endif
     *
     **    set for harris county jobs
 1b  c                   if        job = 410100
     c                   eval      *in64 = *on
     c                   eval      hcad = 'Y'
 1x  c                   else
     c                   eval      *in64 = *off
     c                   eval      hcad = 'N'
 1e  c                   endif
     c                   clear                   hcacgr
     *
     C     *INKA         CABEQ     *ON           FMEND                          THIS ROUTINE
     C     *INKC         CABEQ     *ON           START
     *
     *  CHECK FOR VALID JOB NUMBER
     *
     C     JOB           CABEQ     0             JOBAGN                   21
     C                   EVAL      JOBSAV = JOB
     *    JOB           CHAIN     JFLFMN                             21         JFLFMN      In
     C     JOB           CHAIN     JFLFJM                             21         JFLFMN      In
     C     *IN21         CABEQ     *ON           JOBAGN
     C                   MOVE      MNJNAM        JOBNAM
     C                   MOVE      JOBNO         ADSAV
     *
     * SPECIAL FOR FRANKLIN
 1b  C                   IF        JOBNO =  250100
     C                   EVAL      ADSAV = '01'
 1e  C                   ENDIF
     *
     ***                EXSR      SETLIB
     ***                MOVEL     CURLIB        MT13LB
     C                   MOVEL     MT13LB        RSNLIB            4
     *****              ENDIF
     *
     *  GET VALID JURISDICTIONS FOR THAT A/D FROM JOBFILE
     *
     C                   MOVEA     *ALL' '       JJR
     C                   EVAL      JOBLOW = JOB
     C                   MOVE      '00'          JOBLOW
     C                   EVAL      JOBHIH = JOB
     C                   MOVE      '99'          JOBHIH
     C                   EVAL      A = *ZEROS
     C     JOBLOW        SETLL     JFLFJM
     C                   READ      JFLFJM                                 90     JFLFMN      In
 1b  C                   DOW       *IN90 = *OFF
     C     JOBNO         CABGT     JOBHIH        JFOUT
 2b  C                   IF        ADJSCO = 'AD'
     C                   MOVE      ADSAV         ADJSCO
 2e  C                   ENDIF
 2b  C                   IF        ADJSCO = ADSAV
     C                   ADD       1             A
 3b  C                   IF        ADJSCB > '  '
     C                   MOVE      ADJSCB        JJR(A)
 3x  C                   ELSE
     C                   MOVE      JOBNO         JJR(A)
 3e  C                   ENDIF
 2e  C                   ENDIF
     C                   READ      JFLFJM                                 90     JFLFMN      In
 1e  C                   ENDDO
     *
     * GET ORIGINAL JOB NAME FOR SCREEN DISPLAY
     C     JFOUT         TAG                                                    JFOUT       Tag
     *
     *    JOB           CHAIN     JFLFMN                             21         JFLFMN      In
     C     JOB           CHAIN     JFLFJM                             21         JFLFMN      In
     C                   EVAL      *IN51 = *ON
     C                   EVAL      LSE# = *ZEROS
     *
     C     JOB           CHAIN     MNTPF18                            91
 1b  C                   If        *IN91 = *Off                                 Spcl Oper Allowed
     C                   Eval      SpOprFlag = 'X'
 1x  C                   Else
     C                   Eval      SpOprFlag = *Blanks
 1e  C                   Endif                                                  *In21 = *Off
     *
     C                   MOVE      'N'           SFBOV
     C                   MOVE      'N'           SFDSP
     C                   MOVE      *ZEROS        DELSE#
     C                   MOVE      *ZEROS        DEUSDT
     C                   EVAL      DEUSID = *BLANKS
     C                   EVAL      *IN33 = *OFF
     C                   EVAL      *IN34 = *OFF
     C                   EVAL      *IN37 = *OFF
     *
     C     ARRC#in       CABGT     0             DOWVEW
     *
     *******************************************************************
     *                                                                 *
     * LEASE SELECTION MENU                                            *
     *                                                                 *
     *       ENTER LEASE NUMBER ......                                 *
     *   OR  ENTER DESCRIPTION  ......                                 *
     *   OR  ENTER OPRATOR NAME ......                                 *
     *                                                                 *
     *******************************************************************
     *
     C     KEYLSE        TAG                                                    KEYLSE      Tag
     C                   EVAL      *IN05 = *OFF
     C                   EVAL      *IN81 = *OFF
     C                   EVAL      *IN82 = *OFF
     C                   EVAL      *IN83 = *OFF
     C                   EVAL      *IN84 = *OFF
     C                   MOVE      'N'           HDYN
     C                   EVAL      LSTOHL = *ZEROS
     *
 1b  C                   IF        LOCKO = 'Y'
     C                   EXCEPT    RELO
     C                   MOVE      'N'           LOCKO
 1e  C                   ENDIF
 1b  C                   IF        LOCKH = 'Y'
     C                   EXCEPT    RELH
     C                   MOVE      'N'           LOCKH
 1e  C                   ENDIF
 1b  C                   IF        LOCKDL = 'Y'
     C                   EXCEPT    RELDL
     C                   MOVE      'N'           LOCKDL
 1e  C                   ENDIF
 1b  C                   IF        LOCKDO = 'Y'
     C                   EXCEPT    RELDO
     C                   MOVE      'N'           LOCKDO
 1e  C                   ENDIF
     *
     *  THIS IS THE MAIN RETURN POINT
     C     MENU          TAG                                                    MENU        Tag
     C                   EVAL      LSE# = *ZEROS
     *
     *  FOR THE OWNER VALUE SAVE FILE OPTIONS, THIS IS
     *   THE RETURN POINT
     C     MENU2         TAG
     *
     *  SEE IF JOB# EXISTS IN OWNER VALUE SAVE FILE
     C                   EVAL      *IN23 = *OFF
     C                   OPEN      MNDEPF1
     C     JOB           CHAIN     MNDEPF1                            23
 1b  C                   IF        *IN23 = *OFF
     C                   EVAL      *IN34 = *ON
 1x  C                   ELSE
     C                   EVAL      *IN33 = *OFF
     C                   EVAL      *IN34 = *OFF
 1e  C                   ENDIF
     C                   CLOSE     MNDEPF1
     *
     * Flip Year Left to Right
     * Flip year from YYYYMMDD (8) to MMDDYYYY (8) for Output
     C                   MOVE      USDTDE        Y2KYMD
     C                   EVAL      Y2KYYR = Y2KYYL
     C                   MOVE      Y2KMDY        Y2K001
     *
     C                   EXFMT     MNDR00                                                   I/O
     C                   EVAL      *IN37 = *OFF
     C                   EVAL      *IN48 = *OFF
     *
     C                   EVAL      *IN61 = (JOB = 309801 or job = 215400
     C                              OR JOB = 317900 or job = 416600
     C                             OR JOB >= 980000 AND JOB <= 992700           LOUISIANNA
     c                                     or job = 125200)
     *
     C     *INKA         CABEQ     *ON           FMEND                          THIS ROUTINE
     *
     *  IF PIPELINE DIVISON ORDERS ARE CHOSEN (CA05)...
     *  CALL PROGRAM MNFM12 TO VIEW THOSE...ADDED 4/01/88..DS
 1b  C                   IF        *INKJ = *ON
     C                   CALL      'MNFM12'                             80
     C                   PARM      JOB           JPASS
 1e  C                   ENDIF
     *
     C     *INKB         CABEQ     *ON           KEYOWN
     C     *INKC         CABEQ     *ON           START
     C     *INKI         CABEQ     *ON           LSETAG                   01
     *
     *  REINSTATE HEADER FROM DELETE FILE?
 1b  C                   IF        *INKJ = *ON
     *
     C                   EVAL      *IN48 = *OFF
     C     LSE#          CABLE     *ZEROS        MENU2                  5656
     *
     *  IF LEASE NUMBER SUPPLIED
     *
     *  FIRST, SEE IF ON MNHLFL FILE
     C                   EVAL      *IN55 = *OFF
     C     LSEKEY        CHAIN     MNHLFL                             55
 2b  C                   IF        *IN55 = *OFF
     C                   EVAL      *IN55 = *ON
 GO  C                   GOTO      MENU2
 2x  C                   ELSE
     C                   EVAL      *IN55 = *OFF
 2e  C                   ENDIF
     *
     *  NEXT, SEE IF ON MNHLFDEL FILE
     C                   EVAL      *IN49 = *OFF
     C     LSEKEY        CHAIN     MNHLFDEL                           49
 2b  C                   IF        *IN49 = *OFF
     C                   EVAL      MNHDEL = *BLANKS
     C                   UPDATE    MNHLRDEL
     C                   EVAL      *IN01 = *OFF
     C                   EVAL      *IN57 = *ON
 GO  C                   GOTO      LSETAG
 2x  C                   ELSE
     C                   EVAL      *IN49 = *OFF
     C                   EVAL      *IN01 = *ON
     C                   EVAL      *IN48 = *ON
     C                   EVAL      *IN57 = *ON
 GO  C                   GOTO      LSETAG
 2e  C                   ENDIF
     *
 1e  C                   ENDIF                                                  END KJ=*ON
     *
     *  IF LEASE OWNER VALUE SAVE FILE IS TO BE BUILT
     *   SEE IF JOB/LEASE EXISTS
 1b  C                   IF        LSE# > *ZEROS
     C                             AND SFBOV = 'Y'
     C                   CALL      'MNUT80A'
     C                   PARM      *BLANKS       RTNCDE
     C                   PARM      JOB           DEJOB
     C                   PARM      LSE#          DELSE#
     C                   PARM      *ZEROS        EXDATE
     C                   PARM      *BLANKS       EXUSER
 2b  C                   IF        EXDATE > *ZEROS
     C                             OR EXUSER <> *BLANKS
     C                   EVAL      LSE#DE = LSE#
     C                   EVAL      USDTDE = EXDATE
     C                   MOVEL     EXUSER        USIDDE
     C                   MOVE      'N'           SFBOV
     C                   EVAL      *IN33 = *ON
     C                   EVAL      *IN34 = *ON
 GO  C                   GOTO      MENU2
 2e  C                   ENDIF
 1e  C                   ENDIF
     *
     *  IF LEASE OWNER VALUE SAVE FILE IS TO BE BUILT
     *   SEE IF JOB LEASE EXISTS
 1b  C                   IF        LSE# > *ZEROS
     C                             AND SFBOV = 'Y'
     C                   EVAL      *IN23 = *OFF
     C                   OPEN      MNDEPF1
     C     LSEKEY        CHAIN     MNDEPF1                            23
     C                   CLOSE     MNDEPF1
 2b  C                   IF        *IN23 = *ON
     C                   MOVEL     'NOADD   '    RTNCDE                         DEFAULT
     C                   CALL      'MNUT80B'
     C                   PARM      *BLANKS       RTNCDE
     C                   PARM      JOB           DEJOB
     C                   PARM      LSE#          DELSE#
 3b  C                   IF        RTNCDE = 'NOADD   '
     C                   EVAL      *IN37 = *ON
     C                   EVAL      *IN33 = *OFF
     C                   EVAL      *IN34 = *OFF
 3e  C                   ENDIF
 3b  C                   IF        RTNCDE = 'ADD     '
     C                   EVAL      *IN33 = *ON
     C                   EVAL      *IN34 = *ON
     C                   EVAL      LSE#DE = LSE#
     C     *DATE         MULT      10000.0001    USDTDE
     C                   MOVEL     @USER         USIDDE
     C                   MOVE      'N'           SFBOV
 3e  C                   ENDIF
 GO  C                   GOTO      MENU2
 2x  C                   ELSE                                                   IN23=0
     C                   EVAL      *IN33 = *ON
     C                   EVAL      *IN34 = *ON
     C                   EVAL      LSE#DE = DELSE#
     C                   EVAL      USDTDE = DEUSDT
     C                   MOVEL     DEUSID        USIDDE
     C                   MOVE      'N'           SFBOV
 GO  C                   GOTO      MENU2
 2e  C                   ENDIF
 1e  C                   ENDIF
     *
     *  IF DISPLAY SAVE FILE WANTED
 1b  C                   IF        SFDSP = 'Y'
     C                   CALL      'MNFM01W1'
     C                   PARM      JOB           DEJOB
     C                   MOVE      'N'           SFDSP
 GO  C                   GOTO      MENU2
 1e  C                   ENDIF
     *
     *  IF LSE# IS KEYED, DISPLAY EITHER LEASE HEADER OR LEASE D/O
 1b  C                   IF        LSE# > 0
     C                   EVAL      *IN81 = *ON
     C     HDYN          CABEQ     'Y'           LSETAG
 GO  C                   GOTO      DOWVEW
 1e  C                   ENDIF
     *
     *  IF LEASE NAME IS KEYED, VIEW BY LEASE NAME
     C     LNAM20        CABNE     *BLANK        LSEVEW               8282
     *
     *  IF DESCRIPTION IS KEYED, VIEW BY DESCRIPTION
     C     DSC120        CABNE     *BLANK        LSEVEW               8383
     *
     *  IF OPERATOR NAME IS KEYED, VIEW OPERATOR NAME
     C     OPRN          CABNE     *BLANK        LSEVEW               8484
     *
     *
     C     ARRC#in       CABGT     0             DOWVEW
     *
     *  REDISPLAY MENU SCREEN
 GO  C                   GOTO      MENU
     *
     *******************************************************************
     *                                                                 *
     * OWNER SELECTION MENU                                            *
     *                                                                 *
     *       ENTER OWNER NUMBER ......                                 *
     *   OR  ENTER OWNER NAME   ......                                 *
     *                                                                 *
     *******************************************************************
     *
     C     KEYOWN        TAG
     *
     C                   EVAL      *IN05 = *ON
     C                   EVAL      LSTOHL = *ZEROS
     C     JOB           COMP      219800                                 60
     *
 1b  C                   IF        LOCKO = 'Y'
     C                   EXCEPT    RELO
     C                   MOVE      'N'           LOCKO
 1e  C                   ENDIF
 1b  C                   IF        LOCKDO = 'Y'
     C                   EXCEPT    RELDO
     C                   MOVE      'N'           LOCKDO
 1e  C                   ENDIF
     *
     c                   eval      arkvsw = *blanks
     c                   eval      ageo   = *blanks
     c                   eval      Cgeo1  = *blanks
     c                   eval      Cgeo2  = *blanks
     c                   eval      Cgeo3  = *blanks
     c                   eval      Cgeo4  = *blanks
     c                   eval      Cgeo5  = *blanks
     C                   EXFMT     MNDR01                                        MNDR01     I/O
     *
     C     *INKA         CABEQ     *ON           FMEND
     C     *INKB         CABEQ     *ON           KEYLSE                         TO LEASE SELECT
     C     *INKI         CABEQ     *ON           OWNTAG                   01    OWNER ADD
     *
     c     xkey          klist
     c                   kfld                    job
     c                   kfld                    ageo
     **                               (for robertson cad only)
 1b  c                   if        job =  219800
 2b  C                   If        (Cgeo1 <> *blanks  or Cgeo2 <> *blanks
     c                             or Cgeo3 <> *blanks or Cgeo4 <> *blanks
     c                             or Cgeo5 <> *blanks or Cgeo6 <> *blanks
     c                             or Cgeo7 <> *blanks )
     c                   eval      ageo=Cgeo1+Cgeo2+Cgeo3+Cgeo4+Cgeo5+
     c                             Cgeo6+Cgeo7
     c                   move      *blanks       alpha7            7
     c                   eval      alpha7='0'+cgeo4
     c                   move      alpha7        lse#
     c                   eval      sopr = 0
 3b  c                   select
 3x  c                   when      cgeo6 = 'R'
     c                   eval      lsetyp = 1
 3x  c                   when      cgeo6 = 'O'
     c                   eval      lsetyp = 1
 3x  c                   when      cgeo6 = 'W'
     c                   eval      lsetyp = 1
 3x  c                   other
     c                   eval      lsetyp = 0
 3e  c                   endsl
     c                   move      *blanks       alpha7            7
     c                   eval      alpha7='0'+cgeo7
     c                   move      alpha7        owner
     C     LSEKEY        CHAIN     MNHLFL                             24         MNDLFL      In
     C                   OPEN      MNDPF1                               90
 GO  c                   goto      dowtag
 2e  c                   endif
 1e  c                   endif
     **
 1b  c                   if        ageo <> *blanks
     c     xkey          chain(e)  mnxlfa
 2b  c                   if        %found(mnxlfa)
     c                   eval      owner = x#owner
 2e  c                   endif
 1e  c                   endif
     *
     c     lownerkey     klist
     c                   kfld                    job
     c                   kfld                    lowner
           if        lowner <> 0;
            owner = 0;
     c     lownerkey     chain(e)  mnoxlfo
 1b  c                   if          not %found(mnoxlfo)
     c                   eval        owner = 1
 1e  C                   endif
           endif;
     *
     *  SELECTION TYPE
     ***   FOR HARRIS COUNTY ONLY
 1b  C                   IF        *IN64 = *ON
 2b  C                   IF        BYACCT <> *BLANKS
     C                   EVAL      HCACGR = 'A'
 GO  C                   GOTO      OWNVEW
 2e  C                   ENDIF
 2b  C                   IF        BYGRUP <> *BLANKS
     C                   EVAL      HCACGR = 'G'
 GO  C                   GOTO      OWNVEW
 2e  C                   ENDIF
 1e  C                   ENDIF
     ****
 1b  C                   IF        OWNER > *ZEROS
     C                   EVAL      *IN02 = *ON
     *
     *  OWNER HOLDINGS REQUESTED?
 2b  C                   IF        *INKF = *ON
     C                   EVAL      LSTOHL = *ZEROS
 GO  C                   GOTO      HLDTAG
 2e  C                   ENDIF
     *
     *  C21 = OWNERSHIP CHANGES
 2b  C                   IF        *INKV = *ON
     *
     *  CALL OWNERSHIP DISPLAY PROGRAM
     C                   CALL      'MNFMOC01'                           95
     C                   PARM                    JOB
     C                   PARM                    OWNER
     *
 GO  C                   GOTO      KEYOWN
 2e  C                   ENDIF
     *
     C                   MOVEL     'OWN#'        OVWTYP
 GO  C                   GOTO      OWNTAG
     *
 1x  C                   ELSE
     *
 2b  C                   IF        STREETWITH <> *BLANKS
     C                             AND NAME20 = *BLANKS
     C                   EVAL      NAME20 = 'A'
 2e  C                   ENDIF
 2b  C                   IF        NAME20 <> *BLANKS
     C                   EVAL      *IN30 = *ON
     C                   MOVEL     'NAME'        OVWTYP
     *
 2x  C                   ELSE
     *
 3b  C                   IF        AGENT# > *ZEROS
     C                   EVAL      *IN29 = *ON
     C                   MOVEL     'AGT#'        OVWTYP
     *
 3x  C                   ELSE
     *
 GO  C                   GOTO      KEYOWN
 3e  C                   ENDIF
 2e  C                   ENDIF
 1e  C                   ENDIF
     *
      /EJECT
     *
     *******************************************************************
     *                                                                 *
     * OWNER SELECTION MENU                                            *
     *                                                                 *
     *  VIEW BY OWNER/OWNER NAME      *IN02 = "0" THEN BY OWNER NUMBER *
     *                                *IN30 = "1" THEN BY OWNER NAME   *
     *                                *IN29 = "1" THEN BY AGT#/NAME    *
     *                                                                 *
     *******************************************************************
     *
     C     OWNVEW        TAG
     *
     C                   EVAL      *IN02 = *OFF
     C                   EVAL      *IN29 = *OFF
     C                   EVAL      *IN30 = *OFF
     C                   EVAL      OWNPRV = 0
     C                   EVAL      NAMPRV = *BLANK
     *
 1b  C                   IF        HCACGR = 'A'
 2b  C                   IF        BYACCT = *BLANKS
     C     JOB           SETLL     MNOLF3A
 GO  C                   GOTO      ROLO
 2x  C                   ELSE
     C                   MOVEL     BYACCT        ACCNUM
     C     ACCKEE        SETLL     MNOLF3A
     C                   EVAL      *INKJ = *ON
 GO  C                   GOTO      ROLO
 2e  C                   ENDIF
 1e  C                   ENDIF
 1b  C                   IF        HCACGR = 'G'
 2b  C                   IF        BYGRUP = *BLANKS
     C     JOB           SETLL     MNOLF3G
 GO  C                   GOTO      ROLO
 2x  C                   ELSE
     C                   MOVEL     BYGRUP        GRPNUM
     C     GRPKEE        SETLL     MNOLF3G
     C                   EVAL      *INKK = *ON
 GO  C                   GOTO      ROLO
 2e  C                   ENDIF
 1e  C                   ENDIF
 1b  C                   IF        OVWTYP = 'OWN#'                              BY OWNER#
     C                   EVAL      *IN02 = *ON
     C     OWNKEY        SETLL     MNOLFO
 1x  C                   ELSE
 2b  C                   IF        OVWTYP = 'NAME'                              BY NAME
     C                   EVAL      *IN30 = *ON
     C                   EVAL      OWNER = 0
     C     NMEKEY        SETLL     MNOLFN
 2x  C                   ELSE
 3b  C                   IF        OVWTYP = 'AGT#'                              BY AGT#/NAME
     C                   EVAL      *IN29 = *ON
     C                   EVAL      NAME20 = *BLANKS
     *
     *  IF SELECTING BY AGENT# & AGENT# DOES NOT EXIST,
     *   SHOW NEXT AVAILABLE AGENT#
     C     AGTKEY        SETLL     MNOLFAN
     C     JOB           READE     MNOLFAN                                93
 4b  C                   IF        *IN93 = *OFF
     C     AGTKEY        SETLL     MNOLFAN
 4e  C                   ENDIF
     C                   EVAL      *IN93 = *OFF
 3e  C                   ENDIF
 2e  C                   ENDIF
 1e  C                   ENDIF
     *
     C     ROLO          TAG                                                    ROLO        Tag
     *
     C                   EVAL      *IN45 = *ON
     C                   WRITE     MNSF01                               93      CLEAR SUBFILE
     c                   write     mnsf99
     C                   EVAL      *IN45 = *OFF
     C                   MOVE      *ZEROS        NMERRN
     C                   MOVE      ' '           NOINV
     *
     C     REPETE        TAG
 1b  C                   IF        HCACGR = 'A'
     C     JOB           READE     MNOLF3A                                98
 2b  C                   IF        *IN98 = *OFF
 3b  C                   IF        HCADAC = *BLANKS   AND
     C                             HCADGR = *BLANKS
 GO  C                   GOTO      REPETE
 3e  C                   ENDIF
 2e  C                   ENDIF
     C  N98OWNKEY        CHAIN     MNOLFO
     C                   CLEAR                   OVWTYP
 GO  C                   GOTO      HARC
 1e  C                   ENDIF
 1b  C                   IF        HCACGR = 'G'
     C     JOB           READE     MNOLF3G                                98
 2b  C                   IF        *IN98 = *OFF
 3b  C                   IF        HCADAC = *BLANKS  AND
     C                             HCADGR = *BLANKS
 GO  C                   GOTO      REPETE
 3e  C                   ENDIF
 2e  C                   ENDIF
     C  N98OWNKEY        CHAIN     MNOLFO
     C                   CLEAR                   OVWTYP
 GO  C                   GOTO      HARC
 1e  C                   ENDIF
     ****   selective read
     C     DOITAGAIN     TAG
 1b  c                   select
 1x  C     ovwtyp        wheneq    'OWN#'                                       BY OWNER#
     C     job           reade     mnolfo                                 98
     **
 1x  c     streetwith    whenne    *blanks
     C     job           reade     mnolfn                                 98
     **
 1x  C     ovwtyp        wheneq    'NAME'                                       BY OWNER#
     C     job           reade     mnolfn                                 98
     **
 1x  C     ovwtyp        wheneq    'AGT#'                                       BY OWNER#
     C     job           reade     mnolfan                                98
     **
 1e  c                   endsl
     **
     C     *NOKEY        CLEAR                   MNOPR4
     C     OWNKEY        CHAIN(N)  MNOPF4
           if      M#SNDFILE = ' ' ;
                   M#SNDFILE = 'N' ;
           endif;
     **
     c                   eval      @STREET  = %trim(streetwith)
 1b  c                   if        streetwith <> *blanks
 2b  c                   if        not *in98
     c     @STREET       SCAN      STREET                                 92
 3b  c                   if        not *in92
 GO  c                   GOTO      DOITAGAIN
 3e  C                   endif
 2e  C                   endif
 1e  C                   endif
     ***
     ***  GET HARRIS CO ACCT # / GROUP #
     c                   clear                   grupno
     c                   clear                   acctno
     c                   clear                   hcadac
     c                   clear                   hcadgr
     c   64ownkey        chain(E)  mnopf3
 1b  c   64              if        not %found(mnopf3)
     c                   exsr      addpf3
 1e  c                   endif
     c                   eval      acctno = hcadac
     c                   eval      grupno = hcadgr
     c
     C     HARC          TAG
     *
     C                   EXSR      CHKAUT
     *
 1b  C                   DOW       *IN98 = *OFF
     *
     *  SEE IF INVENTORIES EXIST FOR OWNER
     C     INVKEY        CHAIN     MNILFOS                            95
 2b  C                   IF        *IN95 = *ON
     C                   MOVE      '*'           NOINV                           NO INV
 2x  C                   ELSE
     C                   MOVE      ' '           NOINV                           INV EXISTS
 2e  C                   ENDIF
     *
     *  SEE IF OWNERSHIP CHANGES EXIST FOR OWNER
     C                   EVAL      COJOB = JOB
     C                   EVAL      COCOWN = OWNER
     C                   EVAL      COTYPR = 1
     *
     *  CHECK MNDLF5OA FILE FIRST (OLD CHANGE FILE)
     C                   EVAL      *IN95 = *OFF
     C     COKY7C        CHAIN     MNDLF5OA                           95
 2b  C                   IF        *IN95 = *ON
     C                   MOVE      'N'           PF5FLG
 2e  C                   ENDIF
 2b  C                   IF        *IN95 = *OFF
     C                   MOVE      'Y'           PF5FLG
 2e  C                   ENDIF
     *
     *  CHECK MNDLF7C FILE SECOND (NEW CHANGE FILE)
     C                   EVAL      *IN95 = *OFF
     C     COKY7C        CHAIN     MNDLF7C                            95
 2b  C                   IF        *IN95 = *ON
     C                   MOVE      'N'           PF7FLG
 2e  C                   ENDIF
 2b  C                   IF        *IN95 = *OFF
     C                   MOVE      'Y'           PF7FLG
 2e  C                   ENDIF
     *
 2b  C                   IF        PF5FLG = 'Y'
     C                             OR PF7FLG = 'Y'
     C                   MOVE      'Y'           OWSCHG
 2x  C                   ELSE
     C                   MOVE      ' '           OWSCHG
 2e  C                   ENDIF
     *
 2b  C                   IF        CITY16 <> *BLANKS
     C                             OR STE2A <> *BLANKS
     C                   MOVEL     CITY16        AD3
 2x  C                   ELSE
     C                   MOVEL     ALTCSZ        AD3
 2e  C                   ENDIF
     c                   eval      accnum = hcadac
     c                   eval      grpnum = hcadgr
     *
     C                   ADD       1             NMERRN
     C                   WRITE     MNSF02                                 95
     c                   write     mnsfag
 2b  C                   IF        OVWTYP = 'OWN#'                              BY OWNER#
     C                   EXCEPT    RELO
 2e  C                   ENDIF
     *
     C     NMERRN        CABGE     15            NONRRN
     *
 2b  C                   IF        HCACGR = 'A'
     C     JOB           READE     MNOLF3A                                98
     C  N98OWNKEY        CHAIN     MNOLFO
 GO  C                   GOTO      HARC2
 2e  C                   ENDIF
 2b  C                   IF        HCACGR = 'G'
     C     JOB           READE     MNOLF3G                                98
     C  N98OWNKEY        CHAIN     MNOLFO
 GO  C                   GOTO      HARC2
 2e  C                   ENDIF
     C     DOITAGAIN2    TAG
 2b  c                   select
 2x  C     ovwtyp        wheneq    'OWN#'                                       BY OWNER#
     C     JOB           READE     MNOLFO                                 98
     **
 2x  c     streetwith    whenne    *blanks
     C     job           reade     mnolfn                                 98
     **
 2x  C     ovwtyp        wheneq    'NAME'                                       BY NAME
     C     JOB           READE     MNOLFN                                 98
     **
 2x  C     ovwtyp        wheneq    'AGT#'                                       BY AGT#/NAME
     C     JOB           READE     MNOLFAN                                98
     **
 2e  C                   endsl
     **
     C     *NOKEY        CLEAR                   MNOPR4
     c     OWNKEY        CHAIN(N)  MNOPF4
           if      M#SNDFILE = ' ' ;
                   M#SNDFILE = 'N' ;
           endif;
     **
     c                   eval      @STREET  = %trim(streetwith)
 2b  c                   if        streetwith <> *blanks
 3b  c                   if        not *in98
     c     @STREET       SCAN      STREET                                 92
 4b  c                   if        not *in92
 GO  c                   GOTO      DOITAGAIN2
 4e  C                   endif
 3e  C                   endif
 2e  C                   endif
     **
     ***  GET HARRIS CO ACCT # / GROUP #
     c                   clear                   grupno
     c                   clear                   acctno
     c                   clear                   hcadac
     c                   clear                   hcadgr
     c   64ownkey        chain(E)  mnopf3
 2b  c   64              if        not %found(mnopf3)
     c                   exsr      addpf3
 2e  c                   endif
     c                   eval      acctno = hcadac
     c                   eval      grupno = hcadgr
     *
     C     HARC2         TAG
     C                   EXSR      CHKAUT
     *
 1e  C                   ENDDO
     *
     C     NONRRN        TAG                                                    NONRRN      Tag
     *
     C                   EVAL      RRN = 0
     C                   EVAL      *IN43 = *ON
     C                   EVAL      *IN42 = NMERRN <> *ZEROS
 1b  c                   if        hcacgr <> 'A'  AND
     C                             HCACGR <> 'G'
     C                   EXFMT     MNSF01                                        MNSF01     I/O
 1x  c                   else
     c                   exfmt     mnsf99
 1e  c                   endif
     C                   EVAL      *IN42 = *OFF
     C                   EVAL      *IN43 = *OFF
 1b  c                   if        hcad = 'Y'
 2b  c                   if        *inkj = *on
     c                   eval      hcacgr = 'A'
 GO  C                   GOTO      OWNVEW
 2e  c                   endif
 2b  c                   if        *inkk = *on
     c                   eval      hcacgr = 'G'
 GO  C                   GOTO      OWNVEW
 2e  c                   endif
 1e  c                   endif
     C     *INKA         CABEQ     *ON           FMEND
 1b  C                   IF        *IN05 = *ON
     ***  *INKB         CABEQ     *ON           KEYOWN
 2b  C                   IF        *INKB = *ON
     C                   CLEAR                   HCACGR
 GO  C                   GOTO      KEYOWN
 2e  C                   ENDIF
 1e  C                   ENDIF
 1b  C                   IF        *IN05 = *OFF
     C     *INKB         CABEQ     *ON           KEYLSE
 1e  C                   ENDIF
 1b  C                   IF        *IN01 = *ON
     C     *INKC         CABEQ     *ON           DOWBGN
 1e  C                   ENDIF
     *
     * CHECK FOR ADD *INKI - THEN ADD AN OWNER
     *
 1b  C                   IF        *INKI = *ON
     C                   EVAL      *IN01 = *ON
 GO  C                   GOTO      OWNTAG
 1e  C                   ENDIF
     *
     * ROLL UP
 1b  C                   IF        *IN10 = *ON
     *
 2b  C                   IF        HCACGR <> 'A'  AND
     C                             HCACGR <> 'G'
     C     15            CHAIN     MNSF02                             93
 2x  C                   ELSE
     C     15            CHAIN     MNSFAG                             93
 2e  C                   ENDIF
     C
 2b  C                   IF        *IN93 = *ON
 3b  C                   IF        HCACGR <> 'A'   AND
     C                             HCACGR <> 'G'
     C     1             CHAIN     MNSF02                             93
 3x  C                   ELSE
     C     1             CHAIN     MNSFAG                             93
 3e  C                   ENDIF
     **VB *IN93         CABEQ     *ON           NONRRN
 3b  C                   SELECT
 3x  C     HCACGR        WHENEQ    'A'
     C     ACCKEE        SETLL     MNOLF3A
     *
 3x  C     HCACGR        WHENEQ    'G'
     C     GRPKEE        SETLL     MNOLF3G
     *
 3x  C     OVWTYP        WHENEQ    'OWN#'
     C     OWNKEY        SETLL     MNOLFO
     *
 3x  C     OVWTYP        WHENEQ    'NAME'
     C     NMEKEY        SETLL     MNOLFN
     *
 3x  C     OVWTYP        WHENEQ    'AGT#'
     C     AGTKY2        SETLL     MNOLFAN
     *
 3e  C                   ENDSL
     *
 2x  C                   ELSE
     *
 3b  C                   SELECT
 3x  C     HCACGR        WHENEQ    'A'
     C     ACCKEE        SETGT     MNOLF3A
     *
 3x  C     HCACGR        WHENEQ    'G'
     C     GRPKEE        SETGT     MNOLF3G
     *
 3x  C     OVWTYP        WHENEQ    'OWN#'
     C     OWNKEY        SETGT     MNOLFO
     *
 3x  C     OVWTYP        WHENEQ    'NAME'
     C     NMEKEY        SETGT     MNOLFN
     *
 3x  C     OVWTYP        WHENEQ    'AGT#'
     C     AGTKY2        SETGT     MNOLFAN
     *
 3e  C                   ENDSL
     *
 2e  C                   ENDIF
     *
 GO  C                   GOTO      ROLO
 1e  C                   ENDIF
     *
     * ROLL DOWN
 1b  C                   IF        *IN11 = *ON
     *
 2b  C                   IF        HCACGR <> 'A'   AND
     C                             HCACGR <> 'G'
     C     1             CHAIN     MNSF02                             93
 2x  C                   ELSE
     C     1             CHAIN     MNSFAG                             93
 2e  C                   ENDIF
     **VB *IN93         CABEQ     *ON           NONRRN
     *
 2b  C                   SELECT
 2x  C     HCACGR        WHENEQ    'A'
     C     ACCKEE        SETLL     MNOLF3A
     **
 2x  C     HCACGR        WHENEQ    'G'
     C     GRPKEE        SETLL     MNOLF3G
     **
 2x  C     OVWTYP        WHENEQ    'OWN#'
     C     OWNKEY        SETLL     MNOLFO
     **
 2x  C     OVWTYP        WHENEQ    'NAME'
     C     NMEKEY        SETLL     MNOLFN
     **
 2x  C     OVWTYP        WHENEQ    'AGT#'
     C     AGTKY2        SETLL     MNOLFAN
     **
 2e  C                   ENDSL
     *
 2b  C                   DO        15            X
     *
 3b  C                   SELECT
 3x  C     HCACGR        WHENEQ    'A'
     C     JOB           READPE    MNOLF3A                                98
     *
 3x  C     HCACGR        WHENEQ    'G'
     C     JOB           READPE    MNOLF3G                                98
     *
 3x  C     OVWTYP        WHENEQ    'OWN#'
     C     JOB           READPE    MNOLFO                                 98
     *
 3x  C     OVWTYP        WHENEQ    'NAME'
     C     JOB           READPE    MNOLFN                                 98
     *
 3x  C     OVWTYP        WHENEQ    'AGT#'
     C     JOB           READPE    MNOLFAN                                98
     *
 3e  C                   ENDSL
     *
     C     *NOKEY        CLEAR                   MNOPR4
     C     OWNKEY        CHAIN(N)  MNOPF4
           if      M#SNDFILE = ' ' ;
                   M#SNDFILE = 'N' ;
           endif;
     *
     ***  GET HARRIS CO ACCT # / GROUP #
     c   64ownkey        chain(E)  mnopf3
 3b  c   64              if        not %found(mnopf3)
     c                   exsr      addpf3
 3e  c                   endif
     c                   eval      accNUM = hcadac
     c                   eval      grPNUM = hcadgr
     *
     C                   EXSR      CHKAUT
     *
 3b  C                   IF        *IN98 = *ON
     C                   EVAL      X = 15
 3e  C                   ENDIF
 2e  C                   ENDDO
     *
 2b  C                   SELECT
 2x  C     HCACGR        WHENEQ    'A'
     C     ACCKEE        SETLL     MNOLF3A
     **
 2x  C     HCACGR        WHENEQ    'G'
     C     GRPKEE        SETLL     MNOLF3G
     **
 2x  C     OVWTYP        WHENEQ    'OWN#'
     C     OWNKEY        SETLL     MNOLFO
     **
 2x  C     OVWTYP        WHENEQ    'NAME'
     C     NMEKEY        SETLL     MNOLFN
     **
 2x  C     OVWTYP        WHENEQ    'AGT#'
     C     AGTKY2        SETLL     MNOLFAN
     **
 2e  C                   ENDSL
     *
 GO  C                   GOTO      ROLO
 1e  C                   ENDIF
     *
     *  IF NEXT OWNER NUMBER KEYED THEN GO TO DISPLAY OWNER OR HOLDINGS
     *  IF NEXT OWNER NAME KEYED THEN VIEW BY OWNER NAME
     *
 1b  C                   IF        NOWN > 0
     C                   EVAL      OWNER = NOWN
 2b  C                   IF        *INKF = *ON
     C                   EVAL      LSTOHL = *ZEROS
 GO  C                   GOTO      HLDTAG
 2e  C                   ENDIF
 GO  C                   GOTO      OWNTAG
 1e  C                   ENDIF
 1b  C                   IF        NNAM <> *BLANK
     C                   EVAL      OWNER = 0
     C                   MOVE      NNAM          NAME20
     C                   MOVEL     'NAME'        OVWTYP
 GO  C                   GOTO      OWNVEW
 1e  C                   ENDIF
 1b  C                   IF        NAGT# > *ZEROS
     C                   EVAL      NAME20 = *BLANKS
     C                   EVAL      AGENT# = NAGT#
     C                   MOVEL     'AGT#'        OVWTYP
 GO  C                   GOTO      OWNVEW
 1e  C                   ENDIF
     *
     c     rrn           cabeq     0             nonrrn
     C     RRN           CHAIN     MNSF02                             93         MNSF02      In
     C     *IN93         CABEQ     *ON           NONRRN
     *
     *  C21 = OWNERSHIP CHANGES
 1b  C                   IF        *INKV = *ON
     C     OWSCHG        CABNE     'Y'           NONRRN
     *
     *  CALL OWNERSHIP DISPLAY PROGRAM
     C                   CALL      'MNFMOC01'                           95
     C                   PARM                    JOB
     C                   PARM                    OWNER
     *
 GO  C                   GOTO      NONRRN
 1e  C                   ENDIF
     *
     * POSITION NAME FILE FOR POSSIBLE ROLL FUNCTION
     *
     C     OWNKEY        CHAIN     MNOLFO                             22         MNOLFO      In
 1b  C                   IF        *IN22 = *OFF
     C                   EXCEPT    RELO                                          RELO       Out
 1e  C                   ENDIF
     C                   MOVE      'N'           LOCKO
     C     *NOKEY        CLEAR                   MNOPR4
     C     OWNKEY        CHAIN(N)  MNOPF4
           if      M#SNDFILE = ' ' ;
                   M#SNDFILE = 'N' ;
           endif;
     C     NMEKEY        CHAIN     MNOLFN                             22        POS FOR ROLL
     C     AGTKY2        CHAIN     MNOLFAN                            22        POS FOR ROLL
     C                   EVAL      *IN22 = *OFF
     ***  GET HARRIS CO ACCT # / GROUP #
     c                   clear                   grupno
     c                   clear                   acctno
     c                   clear                   hcadac
     c                   clear                   hcadgr
     c   64ownkey        chain(E)  mnopf3
 1b  c   64              if        not %found(mnopf3)
     c                   exsr      addpf3
 1e  c                   endif
     c                   eval      acctno = hcadac
     c                   eval      grupno = hcadgr
     *
     C                   EXSR      CHKAUT
     *
     *
     *  GO TO OWNER HOLDINGS IF C6 ENTERED....
     *
 1b  C  N01              IF        *INKF = *ON
     C                   EVAL      LSTOHL = *ZEROS
 GO  C                   GOTO      HLDTAG
 1e  C                   ENDIF
     *
     * SEARCHING FOR NEW D/O OWNER - GO BACK TO D/O
     *
 1b  C                   IF        *IN01 = *ON
     C     OWNKEY        CHAIN     MNOLFO                             22         MNOLFO      In
     C                   MOVE      'Y'           LOCKO
     C                   EXSR      CHKAUT
 GO  C                   GOTO      DONOTE
 1e  C                   ENDIF
     *
     * IF NOT COMING FROM D/O ADD SEARCH SETOF ADD INDICATOR
     C                   EVAL      *IN01 = *OFF
      /EJECT
     *
     *******************************************************************
     *                                                                 *
     * OWNER DISPLAY SECTION                                           *
     *                                                                 *
     *               IF *IN01 = "1' THEN PROGRAM IS IN ADD MODE        *
     *               IN *IN01 = "0" THE PROGRAM IS IN CHANGE MODE      *
     *                                                                 *
     *******************************************************************
     *
     C     OWNTAG        TAG
     C                   EVAL      *IN50 = *OFF
     C                   EVAL      *IN35 = *OFF
     C                   EVAL      *IN32 = *OFF
     C                   MOVE      ' '           OWSCHG
     c                   clear                   errmsg
 1b  C                   IF        *IN01 = *ON
     C                   EVAL      OWNER = 0
     C                   EVAL      NAME30 = *BLANKS
     C                   EVAL      CARE = *BLANKS
     C                   EVAL      STREET = *BLANKS
     C                   EVAL      CTST30 = *BLANKS
     C                   EVAL      ALTCSZ = *BLANKS
     C                   EVAL      AGENT# = 0
     C                   EVAL      DVAMT = 0
     C                   EVAL      REND = *BLANKS
     C                   EVAL      SORT = *BLANKS
     C                   EVAL      REAS = *BLANKS
     C                   EVAL      SVREAS = *BLANKS
     C                   EVAL      SVAGENT# = *ZEROS
     C                   EVAL      MNOXC1 = *BLANKS
     C                   EVAL      MNOXC2 = *BLANKS
     C                   EVAL      OUSRID = *BLANKS
     C                   EVAL      OUSRDT = 0
     C                   EVAL      MT13DS = *BLANKS
     C                   EVAL      MUSRC1 = *BLANKS
     C                   EVAL      MUSRC2 = *BLANKS
     C                   EVAL      MUSRC3 = *BLANKS
     C                   EVAL      ACCTNO = *BLANKS
     C                   EVAL      GRUPNO = *BLANKS
     C                   EVAL      M#EMLADR = *blanks
     C                   EVAL      M#sndfile= *blanks
     *
 1x  C                   ELSE
     *
     *  SEE IF OWNER RECORD CHANGES EXIST FOR CF24
     C     OWNKEY        CHAIN     MNOLF2DE                           22
 2b  C                   IF        *IN22 = *ON
     C                   EVAL      *IN32 = *OFF
 2x  C                   ELSE
     C                   EVAL      *IN32 = *ON
 2e  C                   ENDIF
     *
     * IF OWNER IS FOUND THEN DISPLAY FOR CHANGE
     * IF OWNER IS NOT FOUND THEN GO BACK TO VIEW OWNERS
     *
     C     OWNKEY        CHAIN     MNOLFO                             22         MNOLFO      In
 2b  C                   IF        *IN22 = *ON
     C                   EVAL      *IN32 = *OFF
     C                   MOVEL     'OWN#'        OVWTYP
 GO  C                   GOTO      OWNVEW
 2e  C                   ENDIF
     C     *NOKEY        CLEAR                   MNOPR4
     C     OWNKEY        CHAIN(N)  MNOPF4
           if      M#SNDFILE = ' ' ;
                   M#SNDFILE = 'N' ;
           endif;
     ***  GET HARRIS CO ACCT # / GROUP #
     c                   clear                   grupno
     c                   clear                   acctno
     c                   clear                   hcadac
     c                   clear                   hcadgr
     c   64ownkey        chain(E)  mnopf3
 2b  c   64              if        not %found(mnopf3)
     c                   exsr      addpf3
 2e  c                   endif
     c                   eval      acctno = hcadac
     c                   eval      grupno = hcadgr
     *
     C                   EXSR      CHKAUT
     *
     C                   MOVE      'Y'           LOCKO                           RECORD LOCKED
     *
     *  SEE IF OWNERSHIP CHANGES EXIST FOR OWNER
     C                   EVAL      COJOB = JOB
     C                   EVAL      COCOWN = OWNER
     C                   EVAL      COTYPR = 1
     *
     *  CHECK MNDLF5OA FILE FIRST (OLD CHANGE FILE)
     C                   EVAL      *IN22 = *OFF
     C     COKY7C        CHAIN     MNDLF5OA                           22
 2b  C                   IF        *IN22 = *ON
     C                   MOVE      'N'           PF5FLG
 2e  C                   ENDIF
 2b  C                   IF        *IN22 = *OFF
     C                   MOVE      'Y'           PF5FLG
 2e  C                   ENDIF
     *
     *  CHECK MNDLF7C FILE SECOND (NEW CHANGE FILE)
     C                   EVAL      *IN22 = *OFF
     C     COKY7C        CHAIN     MNDLF7C                            22
 2b  C                   IF        *IN22 = *ON
     C                   MOVE      'N'           PF7FLG
 2e  C                   ENDIF
 2b  C                   IF        *IN22 = *OFF
     C                   MOVE      'Y'           PF7FLG
 2e  C                   ENDIF
     *
 2b  C                   IF        PF5FLG = 'Y'
     C                             OR PF7FLG = 'Y'
     C                   MOVE      'Y'           OWSCHG
     C                   EVAL      *IN35 = *ON
 2x  C                   ELSE
     C                   EVAL      *IN35 = *OFF
     C                   MOVE      ' '           OWSCHG
 2e  C                   ENDIF
     *
     * CHECK FOR NOTATIONS IN UTNPF UTILITY NOTES FILE
     C                   EVAL      SEL2 = 1
     C                   EVAL      NBR1 = JOB
     C                   EVAL      NBR2 = OWNER
     C                   EVAL      NBR3 = 0
     C     UTNKEY        CHAIN     UTNPF                              26         UTNPF       In
     *
     *  IF OWNER HAS REASON CODE, GET DESCRIPTION
     c                   exsr      resoncd
     *
 1e  C                   ENDIF
     C                   EVAL      *IN27 = *OFF
     C                   EVAL      *IN44 = *OFF
     *
     C     OWNAGN        TAG                                                    OWNAGN      Tag
     * Flip Year Left to Right
     * Flip year from YYYYMMDD (8) to MMDDYYYY (8) for Output
     C                   MOVE      OUSRDT        Y2KYMD
     C                   EVAL      Y2KYYR = Y2KYYL
     C                   MOVE      Y2KMDY        Y2K002
     *
     C                   EVAL      *IN59 = PRIVCD = 'Y'
     *
 1b  C                   IF        AGENT# > 0
     C     AGENT#        CHAIN(E)  MNGLFA                                        MNGLFA      In
 2b  C                   IF        NOT %FOUND(MNGLFA)
     C                   CLEAR                   AGENTN
 2e  C                   ENDIF
 1x  C                   ELSE
     C                   CLEAR                   AGENTN
 1e  C                   ENDIF
     C                   CLEAR                   GETAGT
     C                   EVAL      SVAGENT# = AGENT#
     *
     *  SEE IF INVENTORIES EXIST FOR OWNER
     C     iNVKEY        CHAIN     MNILFOS                            95
 1b  C                   IF        *IN95 = *ON
     C                   MOVE      'NO INVENTORY'invflg                          NO INV
 1x  C                   ELSE
     C                   clear                   invflg                          INV EXISTS
 1e  C                   ENDIF
     *
     c                   clear                   set15             1
     **                 if        agent# > 0
            agthldmsg = ' ';
            if agent# = 883;
            chain(n) (job:owner) mndlfo;
            if %found(mndlfo);
            agthldmsg = 'Has Holdings';
            endif;
            endif;

            chain(E) (job:owner) mnopf5;
            if not %found(mnopf5);
               commcd = ' ';
               comend = 0;
               usernm = ' ';
               chgdte = 0;
             endif;
     c                   exsr      getlouisown
     c                   eval      USERPWD  = *blanks
     C     OWNKEY        CHAIN     MNOLF6
     c     *like         define    lowner        @lowner
     C                   move      lowner        @lowner
     c                   move      commcd        comsv             1
     C                   MOVE      COMMCD        AGTCOM
     c                   eval      agtend = comend
     **                 endif
     C     RESHOW        TAG
     C                   EXFMT(E)  MNDR02
     C                   CLEAR                   ERRMSG
     ** vb 09/14
 1b  C                   IF        *IN15 = *OFF
 2b  c                   if        arkvsw = 'C'
     c                   unlock    mnolfo
     c                   call      'MNARCV001'
     c                   parm                    job
     c                   parm                    owner
     c     ownkey        chain     mnolfo
     c                   clear                   arkvsw
 2e  c                   endif
 1e  C                   ENDIF
     ** vb 09/14
 1b  c                   if        agent# = 0
     c                   eval      agtcom = ' '
 1e  c                   endif
 1b  c                   if        agent# > 0  or
     c                             agtcom <> ' '  or
     c                             commcd <> agtcom
 2b  c                   if        %error()
     c                   eval      agtcom = '1'
     c                   eval      agtend = 20991231
 GO  c                   goto      reshow
 2e  c                   endif
 2b  c                   if        comqm = '?'
     c                   exfmt     mndr02ag
     C                   EVAL      COMQM = ' '
 GO  C                   GOTO      RESHOW
 2e  c                   endif
                    commcd = agtcom;
                    comend = agtend;
                    usernm = @user;
                    wrkda  = %date();
     C                   MOVE      WRKDA         CHGDTE
                     if chgdte = 0;
                        chgdte = 20991231;
 2b                   endif;
                IF %FOUND(MNOPF5);
                    update(E) mnopr5;
                  else;
                    write(E) mnopr5;
                 endif;
             if agtcom = *blank and
                agent# <> 0;
                   chain(E) (job:owner) mnopf5;
                      if not %found(mnopf5);
                         commcd = ' ';
                         comend = 0;
                         usernm = ' ';
                         chgdte = 0;
 3b                   endif;
                 errmsg = 'Agent comm default to 1';
                 agtcom = '1';
                 agtend = 20991231;
                 if svagent# <> agent#;
                    if *in15 = *on;
                       set15 = 'Y';
                     else;
                       set15 = 'N';
                     endif;
                  endif;
 GO  c                   goto      reshow
              endif;
 3e  c                   endif
 3b  c                   if        set15 = 'Y'
     c                   eval      *in15 = *on
 3e  c                   endif
     *

     *  IF AGENT ADDRESS RETRIEVED, TURN ON *IN15
     C  N15              EVAL      *IN15 = *IN44 = *ON

     C                   EVAL      *IN27 = *OFF
     C                   EVAL      *IN44 = *OFF

     C     *INKA         CABEQ     *ON           FMEND
 3b  C                   IF        *IN05 = *ON
     C     *INKB         CABEQ     *ON           KEYOWN
 3e  C                   ENDIF
 3b  C                   IF        *IN05 = *OFF
     C     *INKB         CABEQ     *ON           KEYLSE
 3e  C                   ENDIF
 3b  C   50              IF        *INKC = *ON
     C                   EVAL      *IN01 = *OFF
 GO  C                   GOTO      OWNTAG
 3e  C                   ENDIF
     C     *INKC         CABEQ     *ON           OWNTAG
     *
 3b  C                   IF        *INKD = *ON
     C                   MOVE      OWNER         OWNX              7
     C                   MOVE      *BLANKS       CTZ              30
     C                   EVAL      CTZ = %TRIM(CITY16) + ' ' +
     C                                   STE2A + ' ' + ZIPA
 4b  C                   if        city16 = *blanks
     c                   eval      ctz = altcsz
 4e  c                   endif
     C                   MOVE      JOB           ONRJOB            7
     C                   Unlock    MNOLFO
     C                   CALL      'MNFM26'
     C                   PARM                    ONRJOB
     C                   PARM                    OWNX
     C                   PARM                    NAME30
     C                   PARM                    CARE
     C                   PARM                    STREET
     C                   PARM                    CTZ
 GO  C                   GOTO      OWNTAG
 3e  C                   ENDIF
     *
     * C8 PROTEST ALL LEASES/OWNERS
 3b  C                   IF        *INKH = *ON
     C                   EVAL      NEWPROCD = *BLANKS
     C                   Exfmt     WINDOW3
     C     *INKC         CABEQ     *ON           OWNTAG
 4b  C                   IF        *INKH = *ON
     C                   CALL      'MNUP044CL'
     C                   PARM                    JOB
     C                   PARM                    OWNER
     C                   PARM                    allownr
     C                   PARM                    allri
     C                   PARM                    allwi
     C                   PARM                    thisownr
 GO  C                   GOTO      OWNTAG
 4e  C                   ENDIF
 3e  C                   ENDIF
     *
     *  C21 = OWNERSHIP CHANGES
 3b  C                   IF        *INKV = *ON
     C     OWSCHG        CABNE     'Y'           OWNAGN
     *
     *  CALL OWNERSHIP DISPLAY PROGRAM
     C                   CALL      'MNFMOC01'                           95
     C                   PARM                    JOB
     C                   PARM                    OWNER
     *
 GO  C                   GOTO      OWNTAG
 3e  C                   ENDIF
     *
     *  CF24 = DISPLAY OWNER RECORD CHANGES
 3b  C                   IF        *INKY = *ON
     *
     C                   CALL      'MNFM15'                             95
     C                   PARM                    JOB
     C                   PARM      OWNER         M2NER
     C                   PARM      NAME20        M2ME20
     C                   PARM      NAME10        M2ME10
     C                   PARM      CARE          M2RE
     C                   PARM      STREET        M2REET
     C                   PARM      ALTCSZ        M2TCSZ
     C                   PARM      CITY16        M2TY16
     C                   PARM      STE2A         M2E2A
     C                   PARM      ZIPA          M2PA
     C                   PARM      ZDASH         M2ASH
     C                   PARM      PLUS4         M2US4
     C                   PARM      AGENT#        M2ENT#
     C                   PARM      REND          M2ND
     C                   PARM      SORT          M2RT
     C                   PARM      DVAMT         M2AMT
     C                   PARM      MNOXC1        M2OXC1
     C                   PARM      MNOXC2        M2OXC2
     C                   PARM      OUSRID        M2SRID
     C                   PARM      OUSRDT        M2SRDT
     C                   PARM      REAS          M2AS
     C                   PARM      PRIVCD        M2IVCD
     *
 GO  C                   GOTO      OWNTAG
 3e  C                   ENDIF
     *
     * *INKF TO OWNER HOLDINGS
     *
 3b  C   05              IF        *INKF = *ON
 4b  C                   IF        LOCKO = 'Y'
     C                   EXCEPT    RELO
     C                   MOVE      'N'           LOCKO
 4e  C                   ENDIF
     C                   EVAL      LSTOHL = *ZEROS
 GO  C                   GOTO      HLDTAG
 3e  C                   ENDIF
     *
     * *INKM TO DISPLAY/CHANGE NOTATIONS IN UTNPF
     *
 3b  C  N01              IF        *INKM = *ON
     C                   MOVEA     PR3           PARM5
     C                   CALL      'QCAEXEC'                                    'QCAEXEC'  Call
     C                   PARM                    PARM5
     C                   PARM      70            PARM6
     C     UTNKEY        CHAIN     UTNPF                              26         UTNPF       In
 GO  C                   GOTO      OWNAGN
 3e  C                   ENDIF
     * ADD ANOTHER RECORD IF PROGRAM IS IN ADD MODE
 3b  C                   IF        *IN50 = *ON
     C                   EVAL      *IN01 = *ON
 GO  C                   GOTO      OWNTAG
 3e  C                   ENDIF
     * VERIFY FIELD CONTENTS
     C     NAME30        CABEQ     *BLANKS       OWNAGN                   67
     *
     *  PERIOD IN NAME NOT ALLOWED
     C     '.'           LOOKUP    NM                                     68
     C     *IN68         CABEQ     *ON           OWNAGN
     *
     *  COMMAS IN NAME NOT ALLOWED
     C     ','           LOOKUP    NM                                     69
     C     *IN69         CABEQ     *ON           OWNAGN
     *
     *
 3b  C                   IF        GETAGT = '?'
     C                   Eval      @agent# = AGENT#
     C                   CLEAR                   GETAGT
     C                   EVAL      M2ENT# = AGENT#
     C                   CALL      'MNFM01W2'
     C                   PARM      0             AGENT#
     C                   PARM                    AGENTN
 4b  C                   IF        AGENT# = 0
     C                   Eval      AGENT# = @agent#
 4e  C                   Endif
 3e  C                   ENDIF
     *  VERIFY AGENT# IF GIVEN
     *
 3b  C                   IF        AGENT# > 0
     C     AGENT#        CHAIN     MNGLFA                             28         MNGLFA      In
     C     *IN28         CABEQ     *ON           OWNAGN

     *  IF ADDRESS IS BLANK W/AGENT#, REPLACE ADDRESS WITH OWNERS ADDRESS
 4b  C                   IF        CARE = *BLANKS
     C                             AND STREET = *BLANKS
     C                             AND CITY16 = *BLANKS
     C                             AND STE2A = *BLANKS
     C                             AND ZIPA = *BLANKS
     C                             AND PLUS4 = *BLANKS
     C                             AND ALTCSZ = *BLANKS
     C                   EVAL      CARE = '% ' + AGENTN
     C                   EVAL      STREET = AGSTRT
     C                   EVAL      CITY16 = AGCT16
     C                   EVAL      STE2A = AGST2A
     C                   EVAL      ZIPA = AGZIPA
     C                   EVAL      ZDASH = AGDASH
     C                   EVAL      PLUS4 = AGPLUS
     C                   EVAL      *IN44 = *ON
 GO  C                   GOTO      OWNAGN
 4e  C                   ENDIF
 3e  C                   ENDIF
     *
     *  EITHER CITY/STATE/ZIP OR ALTERNATE, NOT BOTH
 3b  C                   IF        (CITY16 <> *BLANKS
     C                              OR STE2A <> *BLANKS
     C                              OR ZIPA <> *BLANKS
     C                              OR PLUS4 <> *BLANKS)
     C                             AND ALTCSZ <> *BLANKS
     C                   EVAL      *IN27 = *ON
 GO  C                   GOTO      OWNAGN
 3e  C                   ENDIF
     *
 3b  C                   IF        CITY16 <> *BLANKS
     C                             OR STE2A <> *BLANKS
 4b  C                   IF        PLUS4 <> *BLANKS
     C                             AND PLUS4 <> '0000'
     C                   MOVE      '-'           ZDASH
 4x  C                   ELSE
     C                   EVAL      ZDASH = *BLANKS
 4e  C                   ENDIF
 3e  C                   ENDIF
     *
     *  CHANGE REASON CODE SELECT/MAINTENANCE
     c                   exsr      resonsl
     *
     *  REASON CODE MUST BE SAVED HERE BECAUSE THE OWNER
     *   SAVE ROUTINES WILL REVERT TO SCREEN FIELDS
     C                   MOVEL     REAS          SVREAS
     C                   EVAL      SVAGENT# = AGENT#
     *
 3b  C                   IF        *IN15 = *ON
     C                   EVAL      OUSRDT = UDATE2
     C                   MOVE      USER          OUSRID
     c                   eval      usernm = ousrid
     c                   eval      chgdte = ousrdt
 3e  C                   ENDIF
     *   save mail cass data here
     c                   movel     street        svstrt           30
     c                   movel     city16        svcity           16
     c                   movel     ste2a         svst              2
     c                   movel     zipa          svzip             9
     c                   move      plus4         svzip
     c                   move      musrc3        svrte             4
     c                   movel     musrc2        svcarr            3
     c                   move      musrc1        svcarr
     c                   move      acctno        svacno           13
     c                   move      grupno        svgrup            7
     *
     *  ROLL DOWN - PREVIOUS RECORD
 3b  C                   IF        *IN11 = *ON
 4b  C                   IF        (*IN15 = *ON)
     C                   EXSR      SAVE1
     C                   UPDATE    MNOPR                                         MNOPR      Out
     C                   EXSR      chgcomm
     c                   exsr      updownxref
     c   64              update    mnopr3
     C                   EXSR      SAVE2
     C                   EXSR      LOWUP                                        <> LOWUP
 4x  C                   ELSE
 5b  C                   IF        LOCKO = 'Y'
     C                   EXCEPT    RELO                                          REOLRO     Out
 5e  C                   ENDIF
 4e  C                   ENDIF
     C                   MOVE      'N'           LOCKO
     *
 4b  c                   select
 4x  C     ovwtyp        wheneq    'OWN#'
     C     JOB           READPE    MNOLFO                                 13    BEG OF FILE
 5b  C                   IF        *IN13 = *ON
     C     OWNKEY        CHAIN     MNOLFO                             13
     ***  GET HARRIS CO ACCT # / GROUP #
     c                   clear                   grupno
     c                   clear                   acctno
     c   64ownkey        chain(E)  mnopf3
 6b  c   64              if        not %found(mnopf3)
     c                   exsr      addpf3
 6e  c                   endif
     C     *NOKEY        CLEAR                   MNOPR4
     C     OWNKEY        CHAIN(N)  MNOPF4
           if      M#SNDFILE = ' ' ;
                   M#SNDFILE = 'N' ;
           endif;
 5e  C                   ENDIF
     **
 4x  C     ovwtyp        wheneq    'NAME'
     C     JOB           READPE    MNOLFN                                 13    BEG OF FILE
 5b  C                   IF        *IN13 = *ON
     C     NMEKEY        CHAIN     MNOLFN                             13
     ***  GET HARRIS CO ACCT # / GROUP #
     c                   clear                   grupno
     c                   clear                   acctno
     c   64ownkey        chain(E)  mnopf3
     C     *NOKEY        CLEAR                   MNOPR4
     C     OWNKEY        CHAIN(N)  MNOPF4
           if      M#SNDFILE = ' ' ;
                   M#SNDFILE = 'N' ;
           endif;
 5e  C                   ENDIF
     **
 4x  C     ovwtyp        wheneq    'AGT#'
     C     JOB           READPE    MNOLFAN                                13    BEG OF FILE
 5b  C                   IF        *IN13 = *ON
     C     AGTKY2        CHAIN     MNOLFAN                            13
     ***  GET HARRIS CO ACCT # / GROUP #
     c                   clear                   grupno
     c                   clear                   acctno
     c   64ownkey        chain(E)  mnopf3
     C     *NOKEY        CLEAR                   MNOPR4
     C     OWNKEY        CHAIN(N)  MNOPF4
           if      M#SNDFILE = ' ' ;
                   M#SNDFILE = 'N' ;
           endif;
 5e  C                   ENDIF
     **
 4e  C                   ENDSL
     *
     C                   EXSR      CHKAUT
     *
 GO  C                   GOTO      OWNTAG
 3e  C                   ENDIF
     *
     *  ROLL up   - next RECORD
 3b  C                   IF        *IN10 = *ON
 4b  C                   IF        *IN15 = *ON
     C                   EXSR      SAVE1
     C                   UPDATE    MNOPR                                         MNOPR      Out
     C                   EXSR      chgcomm
     c                   exsr      updownxref
     c   64              update    mnopr3
     C                   EXSR      SAVE2
     C                   EXSR      LOWUP                                        <> LOWUP
 4x  C                   ELSE
 5b  C                   IF        LOCKO = 'Y'
     C                   EXCEPT    RELO                                          REOLRO     Out
 5e  C                   ENDIF
 4e  C                   ENDIF
     C                   MOVE      'N'           LOCKO
     *
 4b  c                   select
 4x  C     ovwtyp        wheneq    'OWN#'
     C     JOB           READE     MNOLFO                                 14    BEG OF FILE
 5b  C                   IF        *IN14 = *ON
     C     OWNKEY        CHAIN     MNOLFO                             14
 5e  C                   ENDIF
     C     *NOKEY        CLEAR                   MNOPR4
     C     OWNKEY        CHAIN(N)  MNOPF4
           if      M#SNDFILE = ' ' ;
                   M#SNDFILE = 'N' ;
           endif;
     **
 4x  C     ovwtyp        wheneq    'NAME'
     C     JOB           READE     MNOLFN                                 14    BEG OF FILE
 5b  C                   IF        *IN14 = *ON
     C     NMEKEY        CHAIN     MNOLFN                             14
 5e  C                   ENDIF
     **
 4x  C     ovwtyp        wheneq    'AGT#'
     C     JOB           READE     MNOLFAN                                14    BEG OF FILE
 5b  C                   IF        *IN14 = *ON
     C     AGTKY2        CHAIN     MNOLFAN                            14
 5e  C                   ENDIF
 4e  C                   ENDSL
     *
     C                   EXSR      CHKAUT
     *
 GO  C                   GOTO      OWNTAG
 3e  C                   ENDIF
     *
 3b  C                   IF        *IN01 = *ON
     ***                IF         OWNER > 0 and *in99 = *on
 4b  C                   IF         OWNER > 0
     C                   WRITE     MNOPR
     C                   EXSR      chgcomm
     c   64              eval      hcadac = acctno
     c   64              eval      hcadgr = grupno
     c   64              write     mnopr3
     *     UPDATE ARCHIVES
     c                   call      'MNARCV001'
     c                   parm                    job
     c                   parm                    owner
     *
     * lousianna special owner
            if job = 900700 or job = 901900
            or job = 900700 or job = 901900
            or job = 902100 or job = 902300
            or job = 904100 or job = 904500
            or job = 908300 or job = 908700
            or job = 909700 or job = 909900
            or job = 910100 or job = 907500;
     c                   write     mnoxpr
            endif;
     *Create internet password
     c                   call      'UPDMNOPF6C'
     c                   parm                    job
     c                   parm                    owner
     ** vb 09/14
     ***                if        arkvsw = 'Y'
 5b  c                   if        arkvsw = 'C'
     ** vb 09/14
     c                   call      'MNARCV001'
     c                   parm                    job
     c                   parm                    owner
 5e  c                   endif
 4e  C                   ENDIF
 3e  C                   ENDIF
     *
 3b  C                   IF        *IN01 = *ON
 4b  C                   IF         OWNER = 0
     C                   EVAL      *IN21 = *ON
 5b  C                   DOW       *IN21 = *ON
     C     JOB           CHAIN     MNNPF                              2121
 6b  C                   IF        *IN21 = *OFF
     C                   ADD       1             NOWN#
     C                   UPDATE    MNNPR
     C                   EVAL      OWNER = NOWN#
     C                   WRITE     MNOPR
     C                   EXSR      chgcomm
 6e  C                   ENDIF
 5e  C                   ENDDO
     *     UPDATE ARCHIVES
     c                   call      'MNARCV001'
     c                   parm                    job
     c                   parm                    owner
     *
     c   64              eval      hcadac = acctno
     c   64              eval      hcadgr = grupno
     c   64              write     mnopr3
     *Create internet password
     c                   call      'UPDMNOPF6C'
     c                   parm                    job
     c                   parm                    owner
     * lousianna special owner
            if job = 900700 or job = 901900
            or job = 900700 or job = 901900
            or job = 902100 or job = 902300
            or job = 904100 or job = 904500
            or job = 908300 or job = 908700
            or job = 909700 or job = 909900
            or job = 910100 or job = 907500;
            write     mnoxpr;
            endif;
     ** vb 09/14
     ***                if        arkvsw = 'Y'
 5b  c                   if        arkvsw = 'C'
     ** vb 09/14
     c                   call      'MNARCV001'
     c                   parm                    job
     c                   parm                    owner
 5e  c                   endif
     *                  ENDIF
 4e  C                   ENDIF
     C                   EXSR      LOWUP                                        <> LOWUP
     C                   MOVE      'N'           LOCKO
     *
     * GET BACK TO D/O
 4b  C                   IF        *IN05 = *OFF
     C     OWNKEY        CHAIN     MNOLFO                             22         MNOLFO      In
     C     *NOKEY        CLEAR                   MNOPR4
     C     OWNKEY        CHAIN(N)  MNOPF4
           if      M#SNDFILE = ' ' ;
                   M#SNDFILE = 'N' ;
           endif;
     C                   MOVE      'Y'           LOCKO
 GO  C                   GOTO      DONOTE
 4e  C                   ENDIF
     C                   EVAL      *IN50 = *ON
     *
     C                   MOVEL     REAS          SVREAS
     C                   EVAL      SVAGENT# = AGENT#
 GO  C                   GOTO      OWNAGN
     *  CHANGE MODE
 3x  C                   ELSE
 4b  C                   IF        *IN15 = *ON
     C                   EXSR      SAVE1
     c                   exsr      updownxref
     c                   move      entr          errmsg
     ***** NOW MAKE REMIND TO USER TO ARCHIVE THE OWNER CHANGE BACK
     C                   EVAL      ARKVSW = 'C'
     ***** NOW MAKE REMIND TO USER TO ARCHIVE THE OWNER CHANGE BACK

     C                   MOVE      ARKVSW        ARKVHL            1
     c                   exfmt     mndr02
 5b  C                   IF        ARKVSW = ' '
     C                   EVAL      ARKVSW = ARKVHL
 5e  C                   ENDIF
     C                   UPDATE    MNOPR                                         MNOPR      Out
     C                   EXSR      chgcomm
     c   64              update    mnopr3

     *upate louisiann owner xref
     c                   exsr      updownxref

     ** vb 09/14
     ***                if        arkvsw = 'Y'
 5b  c                   if        arkvsw = 'C'
     ** vb 09/14
     c                   call      'MNARCV001'
     c                   parm                    job
     c                   parm                    owner
 5e  c                   endif
     C                   EXSR      SAVE2
     C                   EXSR      LOWUP                                        <> LOWUP
 4x  C                   ELSE
     C                   EXCEPT    RELO                                          REOLRO     Out
 4e  C                   ENDIF
     C                   MOVE      'N'           LOCKO
 3e  C                   ENDIF
     *
     *  ROLL DOWN - PREVIOUS RECORD
 3b  c                   if        *in11 = *on
     c                   eval      *in15 = *off
     c                   eval      locko = 'N'
     c                   exsr      rolldn
 GO  c                   goto      owntag
 3e  c                   endif
     *
     *  ROLL up   - next RECORD
 3b  c                   if        *in10 = *on
     c                   eval      *in15 = *off
     c                   eval      locko = 'N'
     c                   exsr      rollup
 GO  c                   goto      owntag
 3e  c                   endif
     *
 3b  C                   IF        NOWN > 0
     C                   MOVEL     'OWN#'        OVWTYP
     C                   EVAL      OWNER = NOWN
 GO  C                   GOTO      OWNTAG
 3e  C                   ENDIF
 3b  C                   IF        NNAM <> *BLANK
     C                   MOVEL     'NAME'        OVWTYP
     C                   MOVEL     NNAM          NAME30
 GO  C                   GOTO      OWNVEW
 3e  C                   ENDIF
     *
 GO  C                   GOTO      KEYOWN
      /EJECT
     *
     *******************************************************************
     *                                                                 *
     * OWNER HOLDINGS / LEASES FOR ONE OWNER                           *
     *                                                                 *
     *       VIEW ALL LEASES FOR THAT OWNER                            *
     *                                                                 *
     *       ROLLUP OR ROLLDOWN                                        *
     *                                                                 *
     *       ADD THAT OWNER TO ANOTHER LEASE                           *
     *                                                                 *
     *       DELETE THAT OWNER FROM A LEASE                            *
     *                                                                 *
     *       CHANGE INTEREST AMOUNT OR EXEMPT CODE ON A LEASE          *
     *                                                                 *
     *       SPLIT OWNERSHIP TO SEVERAL DIFFERENT OWNERS               *
     *                                                                 *
     *******************************************************************
     *
     C     HLDTAG        TAG
     *
     *  IF COMMING FROM MNSF09, SET CMD 14 TO RETURN
     C                   EVAL      *IN36 = LSTOHL > *ZEROS
     *
     C                   EVAL      OWNSAV = OWNER
     C                   EVAL      LSEPRV = 0
     C                   EVAL      LSTPRV = 0
     C                   EVAL      SOPPRV = 0
     *
     * THIS FLAG IS FOR THE SPLIT ROUTINE "0" MEANS ZERO/CLEAR ARRAYS
     *
     C                   MOVE      '0'           SPLFLG
     *
     * INPUT/OUTPUT FIELDS ON SUBFILE CONTROL RECORD
     *
     C                   EVAL      NEWOWN = 0
     C                   EVAL      NEWNAM = *BLANK
     C                   EVAL      LSE# = 0
     C                   EVAL      S@LSE# = 0
     C                   EVAL      S@LSET = 0
     C                   EVAL      S@SOPR = 0
     *
     C     HLDAGN        TAG
     *
     * GET OWNER RECORD
     *
     C     OWNKEY        CHAIN     MNOLFO                             22
 3b  C                   IF        *IN22 = *ON
     C                   MOVEL     'OWN#'        OVWTYP
 GO  C                   GOTO      OWNVEW
 3e  C                   ENDIF
     C     *NOKEY        CLEAR                   MNOPR4
     C     OWNKEY        CHAIN(N)  MNOPF4
           if      M#SNDFILE = ' ' ;
                   M#SNDFILE = 'N' ;
           endif;
     C                   EXSR      CHKAUT
     C                   EXCEPT    RELO
     C                   MOVE      'N'           LOCKO
     *
     C                   EVAL      DSPCSZ = *BLANKS
 3b  C                   IF        CTST30 <> *BLANKS
 4b  C                   IF        PLUS4 <> *BLANKS
     C                             AND PLUS4 <> '0000'
     C                   MOVE      '-'           ZDASH
 4x  C                   ELSE
     C                   EVAL      ZDASH = *BLANKS
 4e  C                   ENDIF
     C                   MOVE      CTST30        DSPCSZ
 3x  C                   ELSE
     C                   MOVE      ALTCSZ        DSPCSZ
 3e  C                   ENDIF
     * sum up value for owner
     C                   EVAL      LSETTL = 0
     C     S@KEY         SETLL     MNDLFO
     C     OWNKEY        READE     MNDLFO                                 98     MNDLFO      In
 3b  C                   DOW       *IN98 = *OFF
     C                   EVAL      LSETTL = LSETTL + DJV1
     C     OWNKEY        READE     MNDLFO                                 98     MNDLFO      In
 3e  C                   ENDDO
     *
     * GET HOLDINGS OF THAT OWNER
     *
     *          HLDBGN    TAG
     C     S@KEY         SETLL     MNDLFO
     *
     C     ROLHLD        TAG
     *
     C                   EVAL      *IN45 = *ON
     C                   WRITE     MNSF03                               91      CLEAR SF
     C                   EVAL      *IN45 = *OFF
     C                   EVAL      NEWOWN = 0
     C                   EVAL      HLDRRN = 0
     C                   EVAL      SVSOPR = 0
     C                   EVAL      S@LSE# = 0
     C                   EVAL      S@LSET = 0
     C                   EVAL      S@SOPR = 0
     *
     C                   EVAL      *IN40 = *OFF
     C                   EVAL      *IN98 = *OFF
     C     *IN01         CABEQ     *ON           NOHRRN               4141
     *
     C                   EVAL      *IN41 = *ON
     C     OWNKEY        READE     MNDLFO                                 98     MNDLFO      In
     C     *IN98         CABEQ     *ON           NOHRRN
     C                   EVAL      LSESAV = LSE#
     *
 3b  C                   DOW       *IN98 = *OFF
 4b  c                   if        MNDDEL = *BLANKS
     C                   EVAL      SVSOPR = SOPR
     C     LSEKEY        CHAIN     MNHLFL                             23         MNHLFL      In
 5b  C                   IF        *IN23 = *OFF
     C                   EXCEPT    RELH                                          RELH       Out
 5e  C                   ENDIF
     *****              EVAL      LSEVAL = DJV1
 5b  C                   SELECT
 5x  C                   WHEN      DJV1 <> 0
     C                   EVAL      LSEVAL = DJV1
 5x  C                   WHEN      DJV2 <> 0
     C                   EVAL      LSEVAL = DJV2
 5x  C                   WHEN      DJV3 <> 0
     C                   EVAL      LSEVAL = DJV3
 5x  C                   WHEN      DJV4 <> 0
     C                   EVAL      LSEVAL = DJV4
 5x  C                   WHEN      DJV5 <> 0
     C                   EVAL      LSEVAL = DJV5
 5x  C                   WHEN      DJV6 <> 0
     C                   EVAL      LSEVAL = DJV6
 5x  C                   WHEN      DJV7 <> 0
     C                   EVAL      LSEVAL = DJV7
 5x  C                   WHEN      DJV8 <> 0
     C                   EVAL      LSEVAL = DJV8
 5x  C                   WHEN      DJV9 <> 0
     C                   EVAL      LSEVAL = DJV9
 5x  C                   OTHER
     C                   EVAL      LSEVAL = 0
 5e  C                   ENDSL
     C                   EVAL      NEWINT = DECINT
     C                   MOVE      EXCD          NEWEXC
     C                   EXSR      DTOA                                         <> DTOA
     C                   ADD       1             HLDRRN
 5b  c                   if        hajob# <> 0   or
     c                             halse# <> 0
     c                   eval      f1 = white
 5x  c                   else
     c                   clear                   f1
 5e  c                   endif
     ** vb 09/14
     c                   eval      arkl(hldrrn) = lse#
     c                   exsr      appsr
     ** vb 09/14
     C                   WRITE     MNSF04                                 95     MNSF04     Out
     C                   EXCEPT    RELDO                                         RELDO      Out
     *
     *  IF OWNER HAS MULTI-SCREEN HOLDINGS, THIS WILL RETURN TO SCREEN
     *   SPLIT WAS DONE FROM.
 5b  C                   IF        HLDRRN = 1
     C                   EVAL      S@LSE# = LSE#
     C                   EVAL      S@LSET = LSETYP
     C                   EVAL      S@SOPR = SOPR
 5e  C                   ENDIF
     *
 4e  C                   ENDIF
     ** vb 09/14
     C     HLDRRN        CABGE     5             NOHRRN
     ** vb 09/14
     C     OWNKEY        READE     MNDLFO                                 98     MNDLFO      In
 3e  C                   ENDDO
     *
     C     NOHRRN        TAG
     C                   EVAL      *IN06 = *OFF
     *
     C                   EVAL      RRN = 0
     C                   EVAL      *IN43 = *ON
 3b  C                   IF        *IN01 = *OFF
     C                   EVAL      *IN42 = HLDRRN <> *ZEROS
 3e  C                   ENDIF
 3b  C                   IF        *IN01 = *ON
     C                   EVAL      *IN42 = *ON
 3e  C                   ENDIF
     C                   EXFMT     MNSF03                                        MNSF03     I/O
     C                   EVAL      *IN01 = *OFF
     C                   EVAL      *IN42 = *OFF
     C                   EVAL      *IN43 = *OFF
     C                   MOVE      NULL          BITDSP
 3b  c                   if        arkvsw = 'C'
     c                   exsr      cpyonr
 3e  c                   endif

 3b  c                   if        rrn > 0
     c                   eval      arrc# = 0
     c     rrn           cabgt     0             selsfl
 3e  c                   endif

 3b  C                   IF        *INKM = *ON
     C                   CALL      'MNPRTSETLM'
     C                   PARM      02            TASK              2 0
     C                   PARM                    OWNER
     C                   PARM                    JOB
 3e  c                   endif

 3b  C                   IF        *INKv = *ON
     C                   EXSR      OWNJUR
     c                   goto      hldagn
 3e  c                   endif

     ** vb 09/14
     c                   eval      ark# = hldrrn
     **                 if        arkvsw = 'C'   and
     **                           enterkey = enterkee
 3b  c                   if        arkvsw = 'C'
     ** vb 09/14
 4b  c                   if        ark# > 0
     c                   exsr      cpyall
     c                   clear                   ark#
     ** vb 09/14        clear                   arkl
     c                   clear                   arkvall           1
     c                   clear                   arkvsw
     c                   clear                   arkv1             5 0
 4e  c                   endif
 3e  c                   endif
     C     *INKA         CABEQ     *ON           FMEND
     C     *INKB         CABEQ     *ON           KEYOWN
     C     *INKC         CABEQ     *ON           OWNTAG
 3b  C                   IF        *INKI = *ON
     C                   EVAL      *IN01 = *ON
 GO  C                   GOTO      HLDTAG
 3e  C                   ENDIF
     *
     *  IF RETURN TO D/O SUBFILE MNSF09
 3b  C                   IF        *INKN = *ON
     C                   EVAL      LSE# = LSTOHL
     C                   EVAL      LSTOHL = *ZEROS
     C                   EVAL      LSTSAV = *ZEROS
     C                   EVAL      NAMSAV = *BLANKS
 GO  C                   GOTO      DOWVEW
 3e  C                   ENDIF
     *
     * ROLL FORWARD
     *
     C     *IN10         CABEQ     *ON           ROLHLD
     *
     * ROLL BACKWARD
     *
 3b  C                   IF        *IN11 = *ON
     C     1             CHAIN     MNSF04                             93
     C     OWDKEY        SETLL     MNDLFO
     *
 4b  C                   DO        10
     C                   READP     MNDLFO                                 98
     *
 5b  C                   IF        *IN98 = *OFF
 6b  C                   IF        JOB <> JOBSAV
     C                             OR OWNER <> OWNSAV
     C                   EVAL      X = 11
     C                   EVAL      *IN98 = *ON
 6e  C                   ENDIF
 5e  C                   ENDIF
     *
 4e  C                   ENDDO
     *
 4b  C                   IF        *IN98 = *ON
     C                   MOVE      JOBSAV        JOB
     C                   MOVE      OWNSAV        OWNER
     C                   MOVE      *ZEROS        LSE#
     C                   MOVE      *ZEROS        LSETYP
     C                   MOVE      *ZEROS        SOPR
 4e  C                   ENDIF
     *
     C     OWDKEY        SETLL     MNDLFO
 GO  C                   GOTO      ROLHLD
 3e  C                   ENDIF
     *
     * PRINT HOLDINGS
     *
 3b  C                   IF        *INKL = *ON
     C                   Exfmt     WINDOW5
     C                   MOVE      JOBNO         PR4JB
     C                   MOVE      OWNER         PR4BG
     C                   MOVEL     EMAIL         PR4EMAIL
     C                   MOVEA     PR4           PARM7
     C                   CALL      'MNLT17EMCL'                         80
     C                   PARM                    JOBNO
     C                   PARM                    OWNER
     C                   PARM                    PR4EMAIL

     C*                  CALL      'QCAEXEC'                                    'QCAEXEC'  Call
     C*                  PARM                    PARM7
     C*                  PARM      81            PARM8
     C                   EVAL      LSE# = LSESAV
 GO  C                   GOTO      ROLHLD
 3e  C                   ENDIF
     *
     ********************************************************************
     *  IF NEW OWNER NUMBER KEYED THEN VALIDATE OWNER NUMBER AND
     *         CHANGE EVERY HOLDING TO THAT NEW OWNER NUMBER........
     ********************************************************************
     *
 3b  C                   IF        NEWOWN > 0
     C                   EVAL      OWNSAV = OWNER
     C                   EVAL      OWNER = NEWOWN
     C                   EVAL      NAME30 = *BLANK
     *
     * CHECK FOR NEW OWNER NUMBER
     C     OWNKEY        CHAIN     MNOLFO                             22        LOOK FOR NEW
     C                   MOVEL     NAME30        NEWNAM
     C                   EVAL      OWNER = OWNSAV
 4b  C                   IF        *IN22 = *OFF
     C                   EXCEPT    RELO                                          RELO       Out
     C                   EXSR      CHKAUT
 4e  C                   ENDIF
     C                   MOVE      'N'           LOCKO
     *
     * BACK TO ORIGINAL OWNER
     C     OWNKEY        CHAIN     MNOLFO                             25        ORIGINAL
     C                   EXSR      CHKAUT
     C     *NOKEY        CLEAR                   MNOPR4
     C     OWNKEY        CHAIN(N)  MNOPF4
           if      M#SNDFILE = ' ' ;
                   M#SNDFILE = 'N' ;
           endif;
     *
     * REDISPLAY IF NEW OWNER NOT FOUND
     C     *IN22         CABEQ     *ON           NOHRRN
 4b  C                   IF        *IN25 = *OFF
     C                   EXCEPT    RELO                                          RELO       Out
 4e  C                   ENDIF
     C                   MOVE      'N'           LOCKO
     *
     * REDISPLAY WITH MESSAGE TO CONTINUE IF NEW OWNER FOUND
     C                   EVAL      *IN16 = *ON
     C                   EVAL      *IN42 = *ON
     C                   EVAL      *IN43 = *ON
     C                   EXFMT     MNSF03                                        MNSF03     I/O
     C                   EVAL      *IN16 = *OFF
     C                   EVAL      *IN42 = *OFF
     C                   EVAL      *IN43 = *OFF
     C     *INKA         CABEQ     *ON           FMEND
     C     *INKB         CABEQ     *ON           KEYOWN
     C     *INKC         CABEQ     *ON           OWNTAG
     *
     * IF *INKH AGAIN THEN UPDATE FILES
     *
 4b  C                   IF        *INKH = *ON
     C                             AND NEWOWN <> 0
     *
     C                   EVAL      POWN = OWNSAV
     C                   EVAL      COWN = NEWOWN
     *  set up archive table
     c                   clear                   ark#
     c                   clear                   arkl
     *
     * (1)....SAVE ORIGINAL OWNER NUMBER
     *
     C                   EVAL      OWNER = OWNSAV
     *
     * (2)....BEGIN READING ORIGINAL OWNER'S HOLDINGS
     *
     C     OWNKEY        SETLL     MNDLFO
     C     OWNKEY        READE     MNDLFO                                 98     MNDLFO      In
     *
 5b  C                   DOW       *IN98 = *OFF
     *
     * (3)....SAVE INTEREST AND CHECK FOR EXISTING RECORD ALREADY ON LEASE
     *
     C                   EVAL      DECSAV = DECINT
     C                   EVAL      PSOPR = SOPR
     **  BLD ARCHIVE TABLE
     c                   add       1             ark#
     c                   z-add     lse#          arkl(ark#)
     ***
     *
     * (4)....REPLACE OWNER NUMBER WITH NEW OWNER NUMBER
     *
     C                   EVAL      OWNER = NEWOWN
     C     DOWKEY        CHAIN     MNDLFL                             24         MNDLFL      In
     *
     * (5)....IF RECORD EXISTS THEN JUST ADD INTEREST AND DELETE THIS
     *              CURRENT OWNER'S RECORD
     *
 6b  C                   IF        *IN24 = *OFF
     *
     C                   EVAL      CSOPR = SOPR
     C                   EVAL      SVPDEC = DECINT                              SV ORIG DECINT
     C                   ADD       DECSAV        DECINT
     C                   EVAL      DUSRDT = UDATE2
     C                   MOVE      USER          DUSRID
 7b  c                   if        agent# = 887   or
     c                             agent# = 889
     c                   eval      excd = 'E'
 7e  c                   endif
     *                      do for tarrant county only
 7b  c                   if        excd <> 'E'
 8b  c                   if        job = 122000
     c**********         move      'N'           mndxc1
 8e  c                   endif
 7e  c                   endif
     *                     end  do for tarrant county only
     C                   MOVE      'O'           DUSRCD
     C                   MOVE      *BLANKS       EXCD
     *
     * UPDATE RECORD W/NEWOWN
     C                   UPDATE    MNDPR
     *                  if        arkvsw = 'Y'
     *                  eval      flag = 'N' + SHOSEL
     *                  call      'MNARCV003'
     *                  parm                    job
     *                  parm                    lse#
     *                  parm                    sopr
     *                  parm                    lsetyp
     *                  parm                    owner
     *                  parm                    flag              2
     *                  parm                    codate
     *                  parm                    cotime
     *                  parm                    coyrap
     *                  parm                    cocsq#
     *                  parm                    decsav
     *                  eval      shosel = 'N'
     *                  endif
     C                   MOVE      'N'           LOCKDL
     *
     * DELETE ORIGINAL OWNER HOLDING
     C                   DELETE    MNDLRO
     *                  if        arkvsw = 'Y'
     *                  eval      flag = 'D' + shosel
     *                  call      'MNARCV003'
     *                  parm                    job
     *                  parm                    lse#
     *                  parm                    sopr
     *                  parm                    lsetyp
     *                  parm                    ownsav
     *                  parm                    flag
     *                  parm                    codate
     *                  parm                    cotime
     *                  parm                    coyrap
     *                  parm                    cocsq#
     *                  parm                    decsav
     *                  eval      shosel = 'N'
     *                  endif
     C                   MOVE      'N'           LOCKDO
     *
     * (6)....IF RECORD DOES NOT EXIST THEN UPDAT THE OWNER NUMBER
     *              INTO THIS RECORD
     *
 6x  C                   ELSE
     *
     C                   EVAL      SVPDEC = *ZEROS
     C                   EVAL      CSOPR = PSOPR
     C                   EVAL      PRVOWN = OWNSAV
     C                   EVAL      DUSRDT = UDATE2
     C                   MOVE      USER          DUSRID
     C                   MOVE      'O'           DUSRCD
     *                      do for tarrant county only
 7b  c                   if        excd <> 'E'
 8b  c                   if        job = 122000
     c                   move      'N'           mndxc1
 8e  c                   endif
 7e  c                   endif
     *                      end do for tarrant county only
     C                   UPDATE    MNDLRO                                        MNDLRO     Out
     *                  if        arkvsw = 'Y'
     *                  eval      flag = 'D'+ shosel
     *                  call      'MNARCV003'
     *                  parm                    job
     *                  parm                    lse#
     *                  parm                    sopr
     *                  parm                    lsetyp
     *                  parm                    ownsav
     *                  parm                    flag
     *                  parm                    codate
     *                  parm                    cotime
     *                  parm                    coyrap
     *                  parm                    cocsq#
     *                  parm                    svpdec
     *                  eval      shosel = 'N'
     *                  eval      flag = 'N'+ shosel
     *                  call      'MNARCV003'
     *                  parm                    job
     *                  parm                    lse#
     *                  parm                    sopr
     *                  parm                    lsetyp
     *                  parm                    owner
     *                  parm                    flag
     *                  parm                    codate
     *                  parm                    cotime
     *                  parm                    coyrap
     *                  parm                    cocsq#
     *                  parm                    svpdec
     *                  eval      shosel = 'N'
     *                  endif
     C                   MOVE      'N'           LOCKDO
 6e  C                   ENDIF
     *
     C                   EXSR      ldoup                                        <> LDOUP
     *
     *  WRITE OWNERSHIP CHANGE RECORD
     C                   EXSR      WOCCOW
     *
     * (7)....READ NEXT OWNER HOLDING RECORD
     *
     C                   EVAL      OWNER = OWNSAV
     C     OWNKEY        READE     MNDLFO                                 98     MNDLFO      In
 5e  C                   ENDDO
     *
     C                   EVAL      OWNER = NEWOWN
     *
     * DID NOT EXECUTE *INKH (C8) AGAIN ........
 4x  C                   ELSE
     C                   EVAL      OWNER = OWNSAV
 4e  C                   ENDIF
     ********************************************************************
     c                   eval      arkvall = 'Y'
     *
 GO  C                   GOTO      HLDTAG
 3e  C                   ENDIF
     *
     *
     * IF NEXT OWNER KEYED THEN DISPLAY THAT OWNER'S HOLDINGS
     * IF NEXT NAME KEYED THEN VIEW BY OWNER NAME
     *
     *
 3b  C                   IF        NNAM <> *BLANK
     C                   MOVE      NNAM          NAME20
     C                   MOVEL     'NAME'        OVWTYP
 GO  C                   GOTO      OWNVEW
 3e  C                   ENDIF
 3b  C                   IF        NOWN > 0
     C                   EVAL      OWNER = NOWN
 GO  C                   GOTO      HLDTAG
 3e  C                   ENDIF
 3b  C                   IF        NLSE > 0
     C                   EVAL      LSE# = NLSE
     C     OWLKEY        SETLL     MNDLFO
 GO  C                   GOTO      ROLHLD
 3e  C                   ENDIF
     *
     *
     *  READ SUBFILE FOR CHANGED RECORDS
     *
     *       ADD NEW RECORDS WHEN *IN41 = '0'
     *       CHANGE EXISTING RECORDS WHEN *IN41 = '1'
     *
     *
     C                   READC     MNSF04                                 97
     C     *IN97         CABEQ     *ON           NOUPO
     c                   z-add     hldrrn        arkv1
 3b  C                   DOW       *IN97 = *OFF
     C                   EVAL      *IN40 = *OFF
     C                   EXSR      ATOD
 4b  C                   IF        *IN70 = *ON
     C                   BITON     '4'           BITDSP
 4e  C                   ENDIF
     *
     * VALIDATE INFORMATION
     *
     C                   EVAL      *IN71 = NEWINT <= 0
 4b  C                   IF        *IN71 = *OFF
     ****               EVAL      *IN71 = NEWINT >= 1
     C                   EVAL      *IN71 = NEWINT >  1
 4e  C                   ENDIF
 4b  C                   IF        *IN71 = *ON
     C                   BITON     '3'           BITDSP
 4e  C                   ENDIF
     *
     * CHANGE MODE
     *
 4b  C                   IF        *IN41 = *ON
 5b  C                   IF        *IN70 = *ON
     C                             OR *IN71 = *ON
     C                   UPDATE    MNSF04
     C                   EVAL      *IN06 = *ON
 5x  C                   ELSE
     C     OWDKEY        CHAIN     MNDLFO                             24         MNDLFO      In
     C                   EVAL      DECINT = NEWINT
     C                   MOVE      NEWEXC        EXCD
     C                   EVAL      DUSRDT = UDATE2
     C                   MOVE      USER          DUSRID
     C                   MOVE      'I'           DUSRCD
     C                   UPDATE    MNDLRO                                        MNDLRO     Out
     C                   EXSR      LDOUP                                        <> LDOUP
     C                   MOVE      'N'           LOCKDO
 5e  C                   ENDIF
     *
     * ADD MODE
     *
 4x  C                   ELSE
     *
 5b  C                   IF        LSE# > 0
     C     LSEKEY        CHAIN     MNHLFL                             23         MNHLFL      In
 6b  C                   IF        *IN23 = *OFF
     C                   EXCEPT    RELH                                          RELH       Out
 6e  C                   ENDIF
     C                   MOVE      'N'           LOCKH
 6b  C                   IF        *IN23 = *ON
     C                   BITON     '1'           BITDSP
 6e  C                   ENDIF
 6b  C                   IF        *IN23 = *ON
     C                             OR *IN71 = *ON
     C                   UPDATE    MNSF04
     C                   EVAL      *IN06 = *ON
 6x  C                   ELSE
     C                   EVAL      DECINT = NEWINT
     C                   MOVE      NEWEXC        EXCD
     C                   EVAL      DJV = 0
     C                   EVAL      DUSRDT = UDATE2
     C                   MOVE      USER          DUSRID
     C                   MOVE      'A'           DUSRCD
     *                       do for tarrant county only
     c                   clear                   mndxc1
 7b  c                   if        job = 122000
     c                   move      'N'           mndxc1
 7e  c                   endif
     *                       end do for tarrant county only
     C                   WRITE     MNDPR                                12       MNDPR      Out
     *                  if        arkvsw = 'Y'
     *                  eval      flag = 'N' + shosel
     *                  call      'MNARCV003'
     *                  parm                    job
     *                  parm                    lse#
     *                  parm                    sopr
     *                  parm                    lsetyp
     *                  parm                    owner
     *                  parm                    flag
     *                  parm                    codate
     *                  parm                    cotime
     *                  parm                    coyrap
     *                  parm                    cocsq#
     *                  parm                    newint
     *                  eval      shosel = 'N'
     *                  endif
     C                   EXSR      LDOUP                                        <> LDOUP
     C                   MOVE      'N'           LOCKDL
 7b  C                   IF        *IN12 = *ON
     C                   BITON     '0'           BITDSP
     C                   UPDATE    MNSF04
     C                   EVAL      *IN06 = *ON
 7x  C                   ELSE
     C                   EVAL      *IN40 = *ON
     C                   UPDATE    MNSF04                                        MNSF04     Out
     *
     *  WRITE OWNERSHIP ADD RECORD
     C                   EXSR      WOCAOW
 7e  C                   ENDIF
     *
 6e  C                   ENDIF
 5e  C                   ENDIF
 4e  C                   ENDIF
     C                   READC     MNSF04                                 97     MNSF04      In
 3e  C                   ENDDO
     C                   EVAL      *IN97 = *OFF
     *
     * *IN06 = '1' MEANS ERROR OCCURRED (REDISPLAY)
     *
 3b  C                   IF        *IN06 = *ON
     C                   TESTB     '0'           BITDSP                   12
     C                   TESTB     '1'           BITDSP                   23
     C                   TESTB     '3'           BITDSP                   71
     C                   TESTB     '4'           BITDSP                   70
 GO  C                   GOTO      NOHRRN
 3e  C                   ENDIF
     C     NOUPO         TAG                                                                Tag
     C                   EVAL      LSE# = LSESAV
     C     *IN97         CABEQ     *OFF          ROLHLD
     *
     * SELECT LINE ENTERED ?
     *
     c     selsfl        tag
     C     RRN           CHAIN     MNSF04                             93                     In
     C     *IN93         CABEQ     *ON           NOHRRN
     C                   EXSR      ATOD
     *
     * DELETE FROM LEASE
     *
 3b  C                   IF        *INKK = *ON
     C     DOWKEY        CHAIN     MNDLFL                             24         MNDLFL      In
     C                   MOVE      'Y'           LOCKDL
     C                   EVAL      *IN09 = *ON
     * Flip Year Left to Right
     * Flip year from YYYYMMDD (8) to MMDDYYYY (8) for Output
     C                   MOVE      DCLCDT        Y2KYMD
     C                   EVAL      Y2KYYR = Y2KYYL
     C                   MOVE      Y2KMDY        Y2K006
     *
     * Flip Year Left to Right
     * Flip year from YYYYMMDD (8) to MMDDYYYY (8) for Output
     C                   MOVE      DUSRDT        Y2KYMD
     C                   EVAL      Y2KYYR = Y2KYYL
     C                   MOVE      Y2KMDY        Y2K007
     *
 4b  C     SpOprFlag     IfEq      *Blanks
     C     *IN09         OrEq      *On
     C                   Eval      *IN91 = *On                                  Protect Spcl Oper
 4e  C                   Endif
     *
     C                   EVAL      *IN59 = PRIVCD = 'Y'
     *
     C     DOWAGN2       TAG                                                    DOWAGN      Tag
     *
     *  SEE IF INVENTORIES EXIST FOR OWNER
     C     INVKEY        CHAIN     MNILFOS                            95
 4b  C                   IF        *IN95 = *ON
     C                   MOVE      'NO INVENTORY'invflg                          NO INV
 4x  C                   ELSE
     C                   clear                   invflg                          INV EXISTS
 4e  C                   ENDIF
     *
     c                   exsr      resoncd
     * vb 09/14
     c                   exsr      getnotc
     * vb 09/14
     c                   eval      USERPWD  = *blanks
     C     OWNKEY        CHAIN     MNOLF6
     C                   EXFMT     MNDR05                                                   I/O
     c   46              exsr      resonsl
     C                   EVAL      *IN91 = *OFF
     C                   EVAL      *IN09 = *OFF
     C     *INKA         CABEQ     *ON           FMEND
     C     *INKB         CABEQ     *ON           KEYLSE
 4b  C                   IF        *INKC = *ON
     C                   EXCEPT    RELDL
     C                   MOVE      'N'           LOCKDL
 GO  C                   GOTO      NOHRRN
 4e  C                   ENDIF
 4b  C                   IF        *INKK = *ON
     C                   DELETE    MNDPR
     *                  if        arkvsw = 'Y'
     *                  eval      flag = 'D' + shosel
     *                  call      'MNARCV003'
     *                  parm                    job
     *                  parm                    lse#
     *                  parm                    sopr
     *                  parm                    lsetyp
     *                  parm                    owner
     *                  parm                    flag
     *                  parm                    codate
     *                  parm                    cotime
     *                  parm                    coyrap
     *                  parm                    cocsq#
     *                  parm                    svpdec
     *                  eval      shosel = 'N'
     *                  endif
     C                   MOVE      'N'           LOCKDL
     C     DOWKEY        CHAIN     MNXPF                              25         MNXPF       In
 5b  C                   IF        *IN25 = *OFF
 6b  c                   if        job <> 122000
     C                   DELETE    MNXPR
 6e  c                   endif
 5e  C                   ENDIF
     *
     *  WRITE OWNERSHIP DELETE RECORD
     C                   MOVEL     'DLTLSEOW'    CODLTY
     C                   EXSR      WOCDLT
     C                   EVAL      CODLTY = *BLANKS
     *
 4e  C                   ENDIF
     C                   EVAL      LSE# = LSESAV
 GO  C                   GOTO      ROLHLD
 3e  C                   ENDIF
      /SPACE
     *
     *
     * SPLIT OWNERSHIP AND INTEREST
 3b  C                   IF        *INKH = *ON
     C                   EVAL      *IN70 = *OFF
     C                   EVAL      OWNHLD = OWNER
     C                   EVAL      jobHLD = job
     C                   EVAL      LSTHLD = LSETYP
     C                   EVAL      LSEHLD = LSE#
     *
     C                   EXSR      WOCSPL
     C                   EVAL      *IN06 = *OFF
     C                   EVAL      *IN70 = *OFF
     *
     C     *INKA         CABEQ     *ON           FMEND
     C     *INKB         CABEQ     *ON           KEYOWN
     *
     * BACK TO HOLDINGS
     C                   EVAL      OWNER = OWNHLD
     C                   EVAL      JOB   = JOBHLD
     C                   EVAL      LSETYP= LSETYP
     C                   EVAL      LSE#  = LSEHLD
     *
     *  IF OWNER HAS MULTI-SCREEN HOLDINGS, THIS WILL RETURN TO SCREEN
     *   SPLIT WAS DONE FROM.
     C     S@KEY         SETLL     MNDLFO
     *
 GO  C                   GOTO      HLDAGN
 3e  C                   ENDIF
     *
 3b  C                   IF        *INKN = *ON                                  C14 PRT OWN ADDRESS
     C                   EVAL      #NAME30 = NAME30
     C                   EVAL      #CARE   = CARE
     C                   EVAL      #STREET = STREET
 4b  C                   IF        ALTCSZ <> *BLANKS
     C                   EVAL      #CITYSTZP = ALTCSZ
 4x  C                   ELSE
     C                   EVAL      #CITYSTZP = %TRIM(CITY16)+', ' +%TRIM(STE2A)
     C                             + ' ' +%TRIM(ZIPA)
 5b  C                   IF        PLUS4 <> '0000' AND PLUS4 <> '    '
     C                   EVAL      #CITYSTZP = %TRIM(#CITYSTZP) + '-' + PLUS4
 5e  C                   ENDIF
 4e  C                   ENDIF
     C                   OPEN      QPRINT
     C                   EXCEPT    HDG
     C                   CLOSE     QPRINT
 GO  C                   GOTO      DOWAGN2
 3e  C                   ENDIF
     *
 3b  C                   IF        *INKP = *ON                                  C15 PRT AGT ADDRESS
     C                   CLEAR                   #NAME30
     C                   CLEAR                   #CARE
     C                   CLEAR                   #STREET
     C                   CLEAR                   #CITYSTZP
 4b  C                   IF        AGENT# > 0
     C     AGENT#        CHAIN     MNGLFA                                        MNGLFA      In
 5b  C                   IF        %FOUND(MNGLFA)
     C                   EVAL      #NAME30 = AGENTN
     C                   EVAL      #CARE   = AGFIRM
     C                   EVAL      #STREET = AGSTRT
     C                   EVAL      #CITYSTZP = %TRIM(AGCT16)+', ' +%TRIM(AGST2A)
     C                             + ' ' +%TRIM(AGZIPA)
 6b  C                   IF        AGPLUS <> '0000' AND AGPLUS <> '    '
     C                   EVAL      #CITYSTZP = %TRIM(#CITYSTZP) + '-' + AGPLUS
 6e  C                   ENDIF
 5e  C                   ENDIF
     C                   OPEN      QPRINT
     C                   EXCEPT    HDG
     C                   CLOSE     QPRINT
 4e  C                   ENDIF
 GO  C                   GOTO      DOWAGN2
 3e  C                   ENDIF
     *
     * RRN > 0 GOTO THAT LEASE
 GO  C                   GOTO      DOWVEW
      /EJECT
     *
     ************************************************************
     *                                                          *
     * LEASE RECORD SECTION OF PROGRAM                          *
     *                                                          *
     *       VIEW LEASES BY LEASE# OR LEASE NAME OR OPERATOR    *
     *                                                          *
     *       DISPLAY/ADD/CHANGE LEASE                           *
     *                                                          *
     *       DISPLAY/ADD/CHANGE/DELETE DIVISION ORDER RECORDS   *
     *                                                          *
     ************************************************************
     *
     *  VIEW LEASES BY LEASE NAME OR BY LEASE NUMBER IF NOT FOUND
     *
     C     LSEVEW        TAG                                                    LSEVEW      Tag
     *
     C                   EVAL      LSEPRV = 0
     C                   EVAL      SRTPRV = 0
     C                   EVAL      LSNPRV = *BLANK
     C                   EVAL      OPNPRV = *BLANK
     C                   EVAL      D20PRV = *BLANK
     *
 3b  C                   IF        *IN81 = *ON
     C     LSEKEY        SETLL     MNHLFL
 3e  C                   ENDIF
 3b  C                   IF        *IN82 = *ON
     C     LSNKEY        SETLL     MNHLFN
 3e  C                   ENDIF
 3b  C                   IF        *IN83 = *ON
     C     LSDKEY        SETLL     MNHLFD
 3e  C                   ENDIF
 3b  C                   IF        *IN84 = *ON
     C     LSOKEY        SETLL     MNHLFO
 3e  C                   ENDIF
     *
     C     ROLLSE        TAG                                                    ROLLSE      Tag
     C                   EVAL      *IN45 = *ON
     C                   WRITE     MNSF07                               91      CLEAR SF
     C                   EVAL      *IN45 = *OFF
     C                   EVAL      LSERRN = *ZEROS
     *
 3b  C                   IF        *IN81 = *ON
     C     JOB           READE     MNHLFL                                 98     MNHLFL      In
 3e  C                   ENDIF
 3b  C                   IF        *IN82 = *ON
     C     JOB           READE     MNHLFN                                 98     MNHLFN      In
 3e  C                   ENDIF
 3b  C                   IF        *IN83 = *ON
     C     JOB           READE     MNHLFD                                 98     MNHLFD      In
 3e  C                   ENDIF
 3b  C                   IF        *IN84 = *ON
     C     JOB           READE     MNHLFO                                 98     MNHLFO      In
 3e  C                   ENDIF
     C     *IN98         CABEQ     *ON           NOLRRN
     *
 3b  C                   DOW       *IN98 = *OFF
     *
     *  IF JUR RANGE 80 - 98 IN HEADER FILE, HIGHLIGHT LSE#
     C                   EVAL      *IN20 = *OFF
 4b  C                   DO        9             C
 5b  C                   IF        LJR(C) >= '80'
     C                             AND LJR(C) <= '98'
     C                   EVAL      *IN20 = *ON
     C                   EVAL      C = 9
 5e  C                   ENDIF
 4e  C                   ENDDO
     *
     C                   ADD       1             LSERRN
     C                   WRITE     MNSF08                                 95     MNSF08     Out
     C     LSERRN        CABGE     15            NOLRLS
 4b  C                   IF        *IN81 = *ON
     C     JOB           READE     MNHLFL                                 98     MNHLFL      In
 4e  C                   ENDIF
 4b  C                   IF        *IN82 = *ON
     C     JOB           READE     MNHLFN                                 98     MNHLFN      In
 4e  C                   ENDIF
 4b  C                   IF        *IN83 = *ON
     C     JOB           READE     MNHLFD                                 98     MNHLFD      In
 4e  C                   ENDIF
 4b  C                   IF        *IN84 = *ON
     C     JOB           READE     MNHLFO                                 98     MNHLFO      In
 4e  C                   ENDIF
 3e  C                   ENDDO
     C                   EVAL      *IN95 = *OFF
     C                   EVAL      *IN98 = *OFF
     *
 GO  C                   GOTO      NOLRRN
     C     NOLRLS        TAG                                                    NOLRLS      Tag
 3b  C                   IF        *IN81 = *ON
     C                   EXCEPT    RELH                                          RELH       Out
 3e  C                   ENDIF
     *
     C     NOLRRN        TAG                                                    NOLRRN      Tag
     *
     C                   EVAL      RRN = 0
     C                   EVAL      *IN43 = *ON
     C                   EVAL      *IN42 = LSERRN <> *ZEROS
     C                   EXFMT     MNSF07                                        MNSF07     I/O
     C                   EVAL      *IN42 = *OFF
     C                   EVAL      *IN43 = *OFF
     C     *INKA         CABEQ     *ON           FMEND
     C     *INKB         CABEQ     *ON           KEYLSE
     C     *INKI         CABEQ     *ON           LSETAG                   01
     * ROLL FORWARD
 3b  C                   IF        *IN10 = *ON
     C     1             CHAIN     MNSF08                             93
     C                   EVAL      LSEPRV = LSE#
     C                   EVAL      SRTPRV = LSRT
     C                   MOVE      LNAM20        LSNPRV
     C                   MOVE      OPRN          OPNPRV
     C                   MOVE      DSC120        D20PRV
 GO  C                   GOTO      ROLLSE
 3e  C                   ENDIF
     * ROLL BACKWARD
 3b  C                   IF        *IN11 = *ON
 4b  C                   IF        LSEPRV > 0
     C                   EVAL      LSE# = LSEPRV
     C                   EVAL      LSRT = SRTPRV
     C                   MOVE      LSNPRV        LNAM20
     C                   MOVE      OPNPRV        OPRN
     C                   MOVE      D20PRV        DSC120
     C                   EVAL      LSEPRV = 0
     C                   EVAL      SRTPRV = 0
     C                   EVAL      LSNPRV = *BLANK
     C                   EVAL      OPNPRV = *BLANK
     C                   EVAL      D20PRV = *BLANK
 4x  C                   ELSE
     C     1             CHAIN     MNSF08                             93
 5b  C                   IF        *IN81 = *ON
     C     LSEKEY        SETLL     MNHLFL
 5e  C                   ENDIF
 5b  C                   IF        *IN82 = *ON
     C     LSNKEY        SETLL     MNHLFN
 5e  C                   ENDIF
 5b  C                   IF        *IN83 = *ON
     C     LSDKEY        SETLL     MNHLFD
 5e  C                   ENDIF
 5b  C                   IF        *IN84 = *ON
     C     LSOKEY        SETLL     MNHLFO
 5e  C                   ENDIF
 5b  C                   DO        15            X
 6b  C                   IF        *IN81 = *ON
     C                   READP     MNHLFL                                 98     MNHLFL      In
 6e  C                   ENDIF
 6b  C                   IF        *IN82 = *ON
     C                   READP     MNHLFN                                 98     MNHLFN      In
 6e  C                   ENDIF
 6b  C                   IF        *IN83 = *ON
     C                   READP     MNHLFD                                 98     MNHLFD      In
 6e  C                   ENDIF
 6b  C                   IF        *IN84 = *ON
     C                   READP     MNHLFO                                 98     MNHLFO      In
 6e  C                   ENDIF
 6b  C  N98              IF        JOB <> JOBSAV
 7b  C                   IF        *IN81 = *ON
     C                   READ      MNHLFL                                 98     MNHLFL      In
 7e  C                   ENDIF
 7b  C                   IF        *IN82 = *ON
     C                   READ      MNHLFN                                 98     MNHLFN      In
 7e  C                   ENDIF
 7b  C                   IF        *IN83 = *ON
     C                   READ      MNHLFD                                 98     MNHLFD      In
 7e  C                   ENDIF
 7b  C                   IF        *IN84 = *ON
     C                   READ      MNHLFO                                 98     MNHLFO      In
 7e  C                   ENDIF
     C                   EVAL      *IN98 = *ON
 6e  C                   ENDIF
     C     *IN98         CABEQ     *ON           LBNO
 5e  C                   ENDDO
 4e  C                   ENDIF
     C     LBNO          TAG
 4b  C                   IF        *IN81 = *ON
     C     LSEKEY        SETLL     MNHLFL
 4e  C                   ENDIF
 4b  C                   IF        *IN82 = *ON
     C     LSNKEY        SETLL     MNHLFN
 4e  C                   ENDIF
 4b  C                   IF        *IN83 = *ON
     C     LSDKEY        SETLL     MNHLFD
 4e  C                   ENDIF
 4b  C                   IF        *IN84 = *ON
     C     LSOKEY        SETLL     MNHLFO
 4e  C                   ENDIF
 GO  C                   GOTO      ROLLSE
 3e  C                   ENDIF
     *
     * NEXT LEASE# THEN DISPLAY LEASE RECORD
     * NEXT LEASE NAME THEN VIEW BY LEASE NAME
     * NEXT OPERATOR NAME THEN VIEW BY OPERATOR NAME
     * NEXT DESCRIPTION THE VIEW BY DESCRIPTION
     *
     C                   EVAL      LSE# = 0
     C                   EVAL      LNAM20 = *BLANK
     C                   EVAL      DSC120 = *BLANK
     C                   EVAL      OPRN = *BLANK
     *
 3b  C                   IF        NLSE > 0
     C                   EVAL      LSE# = NLSE
     C                   EVAL      *IN82 = *OFF
     C                   EVAL      *IN83 = *OFF
     C                   EVAL      *IN84 = *OFF
     C                   EVAL      *IN81 = *ON
 GO  C                   GOTO      LSETAG
 3e  C                   ENDIF
 3b  C                   IF        NNAM <> *BLANK
     C                   EVAL      LSRT = NLSRT
     C                   MOVEL     NNAM          LNAM20
     C                   EVAL      *IN81 = *OFF
     C                   EVAL      *IN83 = *OFF
     C                   EVAL      *IN84 = *OFF
     C                   EVAL      *IN82 = *ON
 GO  C                   GOTO      LSEVEW
 3e  C                   ENDIF
 3b  C                   IF        NDSC1 <> *BLANK
     C                   EVAL      LSRT = NLSRT
     C                   MOVEL     NDSC1         DSC120
     C                   EVAL      *IN81 = *OFF
     C                   EVAL      *IN82 = *OFF
     C                   EVAL      *IN84 = *OFF
     C                   EVAL      *IN83 = *ON
 GO  C                   GOTO      LSEVEW
 3e  C                   ENDIF
 3b  C                   IF        NOPRN <> *BLANK
     C                   EVAL      LSRT = NLSRT
     C                   MOVEL     NOPRN         OPRN
     C                   EVAL      *IN81 = *OFF
     C                   EVAL      *IN82 = *OFF
     C                   EVAL      *IN83 = *OFF
     C                   EVAL      *IN84 = *ON
 GO  C                   GOTO      LSEVEW
 3e  C                   ENDIF
     *
     C     RRN           CABEQ     *ZEROS        NOLRRN
     C     RRN           CHAIN     MNSF08                             94         MNSF08      In
     C     *IN94         CABEQ     *ON           NOLRRN
     C                   EVAL      *IN01 = *OFF                                 NOT ADD MODE
     *
     C     LSEKEY        CHAIN     MNHLFL                             23         MNHLFL      In
     C                   EXCEPT    RELH                                         UNLOCK
     C                   MOVE      'N'           LOCKH
 3b  C                   IF        *IN82 = *ON
     C     LSNKEY        CHAIN     MNHLFN                             23         MNHLFN      In
 3e  C                   ENDIF
 3b  C                   IF        *IN83 = *ON
     C     LSDKEY        CHAIN     MNHLFD                             23         MNHLFD      In
 3e  C                   ENDIF
 3b  C                   IF        *IN84 = *ON
     C     LSOKEY        CHAIN     MNHLFO                             23         MNHLFO      In
 3e  C                   ENDIF
     *
      /EJECT
     *
     ************************************************************
     *                                                          *
     *  LEASE ADD/CHANGE                                        *
     *                                                          *
     ************************************************************
     *
     C     LSETAG        TAG                                                    LSETAG      Tag
     *
     C                   EVAL      *IN18 = *OFF
     C                   EVAL      *IN19 = *OFF
     C                   EVAL      *IN50 = *OFF
     C                   EVAL      *IN20 = *OFF
     *
 3b  C                   IF        *IN01 = *ON
     *
     C     *NOKEY        CLEAR                   MNHPR
     C                   EVAL      UC = 0
     C                   EVAL      RC = 0
     *
     *  GET NEW LSE#
     *
     *  IF COMMING FROM MNDR00 AND THE LSE# NOT SUPPLIED
 4b  C                   IF        *IN48 = *OFF and *in61 = *off
     C     JOB           CHAIN     MNNPF                              21         MNNPF       In
     C                   ADD       1             NLSE#
     C                   UPDATE    MNNPR                                         MNNPR      Out
     C                   EVAL      LSE# = NLSE#
 4e  C                   ENDIF
     *
 3x  C                   ELSE
     *  CHANGE MODE
     C     LSEBGN        TAG                                                    LSEBGN      Tag
     C     LSEKEY        CHAIN     MNHLFL                             23         MNHLFL      In
 4b  C                   IF        *IN23 = *ON
     C                   EVAL      *IN81 = *ON
     C                   EVAL      *IN82 = *OFF
     C                   EVAL      *IN83 = *OFF
     C                   EVAL      *IN84 = *OFF
 GO  C                   GOTO      LSEVEW
 4e  C                   ENDIF
     C                   MOVE      'Y'           LOCKH
     *
     *  IF JUR RANGE 80 - 98 IN HEADER FILE, HIGHLIGHT LSE#
     C                   EVAL      *IN20 = *OFF
 4b  C                   DO        9             C
 5b  C                   IF        LJR(C) >= '80'
     C                             AND LJR(C) <= '98'
     C                   EVAL      *IN20 = *ON
     C                   EVAL      C = 9
 5e  C                   ENDIF
 4e  C                   ENDDO
     *
     C                   EVAL      SEL2 = 2
     C                   EVAL      NBR1 = JOB
     C                   EVAL      NBR2 = LSE#
     C                   EVAL      NBR3 = 0
     C     UTNKEY        CHAIN     UTNPF                              26
     C                   EXSR      APPSR
 3e  C                   ENDIF
     *
     C     LSEAGN        TAG
     *
     * Flip Year Left to Right
     * Flip year from YYYYMMDD (8) to MMDDYYYY (8) for Output
     C                   MOVE      HUSRDT        Y2KYMD
     C                   EVAL      Y2KYYR = Y2KYYL
     C                   MOVE      Y2KMDY        Y2K003
     *
     **   job           comp      122000                                 88
     *SETON 88 TO GIVE TO EVERYONE FOR NOW
     **                 EVAL      *IN88 = '1'
     **                 If        *in88
     c                   eval      fctrwi = 0
     *                  If        HAJOB# <> 0 AND HALSE# <> 0
     *    altkey        chain(n)  mnulfl
     *                  else
     c     lsekey        chain(e)  mnulfl
     *                  Endif
     * SHOW TR% IF IT HAS A UNIT
     c                   xfoot     uc            @uc              10 0
 3b  c                   If        @uc = 0
     *                  eval      *in88 = *off
 3e  c                   Endif
     *                  Endif
     *
     *    chk for valid alt lease
     c                   move      'X'           ermsw             1
     c                   eval      *in89 = *off
     c                   clear                   sv15              1
     c                   movea     '000000000'   *in(31)
     c                   eval      *IN04 = *off
     c     SHOSCRN       tag
     c     lcod          comp      '   '                              9999
     C                   EXFMT     MNDR03

 3b  C                   If        LOCERR = 'Y' or rmvcode = 'REMOVE'
     c                   eval      *in15 = *on
     c                   eval      SV15  = *on
     c                   eval      locerr = ' '
 3e  c                   Endif
     c                   eval      jurMESSAGE = *BLANKS
 3b  c                   if        *in89 = *off  and
     c                             ermsw ='X'
     c                   eval      sv15 = *in15
 4b  c                   if        hajob# <> 0  or
     c                             halse# <> 0
     c                   eval      *in89 = *on
     c                   z-add     job           cajob             7 0
     c                   z-add     lse#          calse             7 0
     c     altkey        setll(E)  mnhlfl                                 80
     ***  altkey        chain(E)  mnhlfl
 5b  c                   if        *in80 = *on
     c                   eval      *in89 = *off
     c                   eval      ermsw = 'Y'
     c                   z-add     cajob         job
     c                   z-add     calse         lse#
     ***  LSEKEY        CHAIN     MNHLFL                             23         MNHLFL      In
 GO  c                   goto      gotit
 5e  c                   endif
     c     altkey        setll(E)  mnulfl                                 80
 5b  c                   if        *in80 = *on
     c                   z-add     cajob         job
     c                   z-add     calse         lse#
     ***  LSEKEY        CHAIN     MNHLFL                             23         MNHLFL      In
 GO  c                   goto      gotit
 5e  c                   endif
     c                   eval      *in89 = *on
     c                   eval      ermsw = 'Y'
 GO  c                   goto      shoscrn
 4e  c                   endif
 3e  c                   endif
     c     gotit         tag
     c                   eval      *in15 = sv15
     c                   clear                   ermsw
     c                   eval      *in89 = *off
     C                   EVAL      *IN19 = *OFF
     C                   EVAL      *IN48 = *OFF
     C                   EVAL      *IN57 = *OFF
     C     LSEKEY        chain(E)  MNHLFL        dummyrec             23         MNHLFL      In
     *
     C     *INKA         CABEQ     *ON           FMEND
     C     *INKB         CABEQ     *ON           KEYLSE
 3b  C                   IF        *IN01 = *OFF
     C     *INKC         CABEQ     *ON           LSETAG
 3e  C                   ENDIF
 3b  C                   IF        *IN01 = *ON
     C     *INKC         CABEQ     *ON           KEYLSE
 3e  C                   ENDIF
     *
 3b  C     *INKD         CASEQ     *ON           SUMSR
 3e  C                   ENDCS
     *
     * POP WINDOW UP FOR LOCATION CODE
     c                   move      *blanks       locerr            1
     c                   eval      @in04 = *in04
     c                   eval      @in31 = *in31
     c                   eval      @in32 = *in32
     c                   eval      @in33 = *in33
     c                   eval      @in34 = *in34
     c                   eval      @in35 = *in35
     c                   eval      @in36 = *in36
     c                   eval      @in37 = *in37
     c                   eval      @in38 = *in38
     c                   eval      @in39 = *in39
     c                   eval      lcodsv = lcod
 3b  C                   IF        *INKJ
     C                   EXSR      GETLOCCOD
 4b  c                   if        lcodsv <> lcod
     c                   eval      *in15 = *on
     c                   eval      sv15 = *on
 4e  C                   ENDIF
 GO  C                   GOTO      SHOSCRN
 3e  C                   ENDIF
     c                   eval      *in04 = @in04
     c                   eval      *in31 = @in31
     c                   eval      *in32 = @in32
     c                   eval      *in33 = @in33
     c                   eval      *in34 = @in34
     c                   eval      *in35 = @in35
     c                   eval      *in36 = @in36
     c                   eval      *in37 = @in37
     c                   eval      *in38 = @in38
     c                   eval      *in39 = @in39
     *
     *  GOTO NEW PRODUCTION MENU?
 3b  C                   IF        *INKW = *ON
     C                   CALL      'MPCL00'
 GO  C                   GOTO      LSEAGN
 3e  C                   ENDIF
     *
     *  DUPLICATE LEASE
 3b  C                   IF        *INKV = *ON
     *
     *  VERIFY DUP WANTED
     C                   EVAL      *IN18 = *ON
     C                   EVAL      *IN50 = *ON
     * Flip Year Left to Right
     * Flip year from YYYYMMDD (8) to MMDDYYYY (8) for Output
     C                   MOVE      HUSRDT        Y2KYMD
     C                   EVAL      Y2KYYR = Y2KYYL
     C                   MOVE      Y2KMDY        Y2K003
     *
     c     lcod          comp      '   '                              9999
     C                   EXFMT     MNDR03
     c                   eval      *in89 = *off
     C                   EVAL      *IN18 = *OFF
     C                   EVAL      *IN50 = *OFF
     C     *INKA         CABEQ     *ON           FMEND
     C     *INKB         CABEQ     *ON           KEYLSE
     C     *INKC         CABEQ     *ON           LSEAGN
     *
 4b  C                   IF        *INKV = *ON
     C                   EVAL      SVLSE# = LSE#
     C                   EXSR      DUPLSE
 4e  C                   ENDIF
     *
 GO  C                   GOTO      LSEBGN
 3e  C                   ENDIF
     *
 3b  C  N01              IF        *INKM = *ON
     C                   MOVEA     PR3           PARM5
     C                   CALL      'QCAEXEC'                                    'QCAEXEC'  Call
     C                   PARM                    PARM5
     C                   PARM      70            PARM6
     C     UTNKEY        CHAIN     UTNPF                              26         UTNPF       In
 GO  C                   GOTO      LSEAGN
 3e  C                   ENDIF
     *
     *  DELETE LEASE?
 3b  C                   IF        *INKK = *ON
     C     RC(1)         CABGT     0             LSEAGN               85
     C     UC(1)         CABGT     0             LSEAGN               85
     C                   EVAL      *IN09 = *ON
     C                   EVAL      *IN50 = *ON
     * Flip Year Left to Right
     * Flip year from YYYYMMDD (8) to MMDDYYYY (8) for Output
     C                   MOVE      HUSRDT        Y2KYMD
     C                   EVAL      Y2KYYR = Y2KYYL
     C                   MOVE      Y2KMDY        Y2K003
     *
     c     lcod          comp      '   '                              9999
     C                   EXFMT     MNDR03
     c                   eval      *in89 = *off
     C                   EVAL      *IN09 = *OFF
     C                   EVAL      *IN50 = *OFF
     C     *INKA         CABEQ     *ON           FMEND
     C     *INKB         CABEQ     *ON           KEYLSE
     C     *INKC         CABEQ     *ON           LSEAGN
     *
     *  DELETE CONFIRMED?
 4b  C                   IF        *INKK = *ON
     *
     *  DELETE ALL D/O'S FOR THIS LEASE#
     C                   EVAL      *IN98 = *OFF
     C     LSEKEY        SETLL     MNDLFL
 5b  C                   DOW       *IN98 = *OFF
     C     LSEKEY        READE     MNDLFL                                 98     MNDLFL      In
 6b  C                   IF        *IN98 = *OFF
     C                   DELETE    MNDPR
     *                  if        arkvsw = 'Y'
     *                  eval      flag = 'D' + shosel
     *                  call      'MNARCV003'
     *                  parm                    job
     *                  parm                    lse#
     *                  parm                    sopr
     *                  parm                    lsetyp
     *                  parm                    owner
     *                  parm                    flag
     *                  parm                    codate
     *                  parm                    cotime
     *                  parm                    coyrap
     *                  parm                    cocsq#
     *                  parm                    svpdec
     *                  eval      shosel = 'N'
     *                  endif
     C                   MOVE      'N'           LOCKDL
     *
     *  WRITE OWNERSHIP DELETE RECORD
     C                   EVAL      SVSOPR = SOPR
     C                   MOVEL     'DLTLSE  '    CODLTY
     C                   EXSR      WOCDLT
     C                   EVAL      CODLTY = *BLANKS
     *
 6e  C                   ENDIF
 5e  C                   ENDDO
     *
     *  MARK HEADER FOR DELETE
     C                   MOVE      'D'           MNHDEL
     ***                  Z-ADDUDATE     HUSRDT
     C     *DATE         MULT      10000.0001    HUSRDT
     C                   MOVE      USER          HUSRID
     C                   UPDATE    MNHPR                                         MNHPR      Out
     C                   EXSR      LLSUP                                        <> LLSUP
     C                   MOVE      'N'           LOCKH
 GO  C                   GOTO      KEYLSE
 4e  C                   ENDIF
     *
 GO  C                   GOTO      LSEAGN
 3e  C                   ENDIF
     *
     C     LNAME         CABEQ     *BLANK        LSEAGN                   62
     C     OPRN          CABEQ     *BLANK        LSEAGN                   63
 3b  C                   IF        JOB <> 410100
     C     YRLSE         CABEQ     0             LSEAGN                   65
 3e  C                   ENDIF
     *
     * JURSISDICTION - MINIMUM OF ONE
     C                   EVAL      *IN69 = LJRC = *BLANK
     C     *IN69         CABEQ     *ON           LSEAGN
     *
     *
     * JURSISDICTION - DOUBLE JUR
 3b  C                   DO        8             B
 4b  C                   IF        LJR(B) <> *BLANK
     C                   MOVE      LJR(B)        TESTJ
     C                   EVAL      Z = 1
     C     TESTJ         LOOKUP    LJR(Z)                                 70
     C                   ADD       1             Z
     C     TESTJ         LOOKUP    LJR(Z)                                 70
     C     *IN70         CABEQ     *ON           LSEAGN
 4e  C                   ENDIF
 3e  C                   ENDDO
     *
     *  CHECK FOR JURISDICTION PERCENT
     *  IF JUR IS NOT BLANK & PERCENT IS 0 SET TO 1
     *  IF JUR IS BLANK SET PERCENT TO 0
     *
 3b  C                   IF        LJR1 <> *BLANKS
 4b  C                   IF        LJP1 <= *ZEROS
     C                   EVAL      LJP1 = 1
 4e  C                   ENDIF
 3x  C                   ELSE
     C                   EVAL      LJP1 = *ZEROS
 3e  C                   ENDIF
     *
 3b  C                   IF        LJR2 <> *BLANKS
 4b  C                   IF        LJP2 <= *ZEROS
     C                   EVAL      LJP2 = 1
 4e  C                   ENDIF
 3x  C                   ELSE
     C                   EVAL      LJP2 = *ZEROS
 3e  C                   ENDIF
     *
 3b  C                   IF        LJR3 <> *BLANKS
 4b  C                   IF        LJP3 <= *ZEROS
     C                   EVAL      LJP3 = 1
 4e  C                   ENDIF
 3x  C                   ELSE
     C                   EVAL      LJP3 = *ZEROS
 3e  C                   ENDIF
     *
 3b  C                   IF        LJR4 <> *BLANKS
 4b  C                   IF        LJP4 <= *ZEROS
     C                   EVAL      LJP4 = 1
 4e  C                   ENDIF
 3x  C                   ELSE
     C                   EVAL      LJP4 = *ZEROS
 3e  C                   ENDIF
     *
 3b  C                   IF        LJR5 <> *BLANKS
 4b  C                   IF        LJP5 <= *ZEROS
     C                   EVAL      LJP5 = 1
 4e  C                   ENDIF
 3x  C                   ELSE
     C                   EVAL      LJP5 = *ZEROS
 3e  C                   ENDIF
     *
 3b  C                   IF        LJR6 <> *BLANKS
 4b  C                   IF        LJP6 <= *ZEROS
     C                   EVAL      LJP6 = 1
 4e  C                   ENDIF
 3x  C                   ELSE
     C                   EVAL      LJP6 = *ZEROS
 3e  C                   ENDIF
     *
 3b  C                   IF        LJR7 <> *BLANKS
 4b  C                   IF        LJP7 <= *ZEROS
     C                   EVAL      LJP7 = 1
 4e  C                   ENDIF
 3x  C                   ELSE
     C                   EVAL      LJP7 = *ZEROS
 3e  C                   ENDIF
     *
 3b  C                   IF        LJR8 <> *BLANKS
 4b  C                   IF        LJP8 <= *ZEROS
     C                   EVAL      LJP8 = 1
 4e  C                   ENDIF
 3x  C                   ELSE
     C                   EVAL      LJP8 = *ZEROS
 3e  C                   ENDIF
     *
 3b  C                   IF        LJR9 <> *BLANKS
 4b  C                   IF        LJP9 <= *ZEROS
     C                   EVAL      LJP9 = 1
 4e  C                   ENDIF
 3x  C                   ELSE
     C                   EVAL      LJP9 = *ZEROS
 3e  C                   ENDIF
     *
     *  VERIFY JURISDICTIONS
     C                   EVAL      *IN71 = LJR1 = *BLANK
 3b  C                   IF        *IN71 = *OFF
     C     LJR1          LOOKUP    JJR                                    71
 3e  C                   ENDIF
     C                   EVAL      *IN72 = LJR2 = *BLANK
 3b  C                   IF        *IN72 = *OFF
     C     LJR2          LOOKUP    JJR                                    72
 3e  C                   ENDIF
     C                   EVAL      *IN73 = LJR3 = *BLANK
 3b  C                   IF        *IN73 = *OFF
     C     LJR3          LOOKUP    JJR                                    73
 3e  C                   ENDIF
     C                   EVAL      *IN74 = LJR4 = *BLANK
 3b  C                   IF        *IN74 = *OFF
     C     LJR4          LOOKUP    JJR                                    74
 3e  C                   ENDIF
     C                   EVAL      *IN75 = LJR5 = *BLANK
 3b  C                   IF        *IN75 = *OFF
     C     LJR5          LOOKUP    JJR                                    75
 3e  C                   ENDIF
     C                   EVAL      *IN76 = LJR6 = *BLANK
 3b  C                   IF        *IN76 = *OFF
     C     LJR6          LOOKUP    JJR                                    76
 3e  C                   ENDIF
     C                   EVAL      *IN77 = LJR7 = *BLANK
 3b  C                   IF        *IN77 = *OFF
     C     LJR7          LOOKUP    JJR                                    77
 3e  C                   ENDIF
     C                   EVAL      *IN78 = LJR8 = *BLANK
 3b  C                   IF        *IN78 = *OFF
     C     LJR8          LOOKUP    JJR                                    78
 3e  C                   ENDIF
     C                   EVAL      *IN79 = LJR9 = *BLANK
 3b  C                   IF        *IN79 = *OFF
     C     LJR9          LOOKUP    JJR                                    79
 3e  C                   ENDIF
     C                   EVAL      *IN71 = *IN71 = *OFF
     C                   EVAL      *IN72 = *IN72 = *OFF
     C                   EVAL      *IN73 = *IN73 = *OFF
     C                   EVAL      *IN74 = *IN74 = *OFF
     C                   EVAL      *IN75 = *IN75 = *OFF
     C                   EVAL      *IN76 = *IN76 = *OFF
     C                   EVAL      *IN77 = *IN77 = *OFF
     C                   EVAL      *IN78 = *IN78 = *OFF
     C                   EVAL      *IN79 = *IN79 = *OFF
     *
 3b  C                   IF        *IN71 = *ON
     C                             OR *IN72 = *ON
     C                             OR *IN73 = *ON
     C                             OR *IN74 = *ON
     C                             OR *IN75 = *ON
     C                             OR *IN76 = *ON
     C                             OR *IN77 = *ON
     C                             OR *IN78 = *ON
     C                             OR *IN79 = *ON
 GO  C                   GOTO      LSEAGN
 3e  C                   ENDIF
     *
     *  IF JUR RANGE 80 - 98 IN HEADER FILE, HIGHLIGHT LSE#
     C                   EVAL      *IN20 = *OFF
 3b  C                   DO        9             C
 4b  C                   IF        LJR(C) >= '80'
     C                             AND LJR(C) <= '98'
     C                   EVAL      *IN20 = *ON
     C                   EVAL      C = 9
 4e  C                   ENDIF
 3e  C                   ENDDO
     *
     C                   EVAL      HUSRDT = UDATE2
     C                   MOVE      USER          HUSRID
     *
     *  ROLL DOWN - PREVIOUS RECORD
 3b  C                   IF        *IN11 = *ON
 4b  C                   IF        *IN15 = *ON
     C                   UPDATE    MNHPR                                         MNHPR      Out
     C                   EXSR      LLSUP                                        <> LLSUP
 4x  C                   ELSE
     C                   EXCEPT    RELH
 4e  C                   ENDIF
     C                   MOVE      'N'           LOCKH
 4b  C                   IF        *IN81 = *ON
     C                   READP     MNHLFL                                 13    BEG OF FILE
 4e  C                   ENDIF
 4b  C                   IF        *IN82 = *ON
     C                   READP     MNHLFN                                 13    BEG OF FILE
 4e  C                   ENDIF
 4b  C                   IF        *IN83 = *ON
     C                   READP     MNHLFD                                 13    BEG OF FILE
 4e  C                   ENDIF
 4b  C                   IF        *IN84 = *ON
     C                   READP     MNHLFO                                 13    BEG OF FILE
 4e  C                   ENDIF
 4b  C  N13              IF        JOB <> JOBSAV
     C                   EVAL      *IN13 = *ON
 5b  C                   IF        *IN81 = *ON
     C                   READ      MNHLFL                                 12     MNHLFL      In
 5e  C                   ENDIF
 5b  C                   IF        *IN82 = *ON
     C                   READ      MNHLFN                                 12     MNHLFN      In
 5e  C                   ENDIF
 5b  C                   IF        *IN83 = *ON
     C                   READ      MNHLFD                                 12     MNHLFD      In
 5e  C                   ENDIF
 5b  C                   IF        *IN84 = *ON
     C                   READ      MNHLFO                                 12     MNHLFO      In
 5e  C                   ENDIF
 4e  C                   ENDIF
 GO  C                   GOTO      LSETAG
 3e  C                   ENDIF
     *
     *  ROLL UP - NEXT RECORD
 3b  C                   IF        *IN10 = *ON
 4b  C                   IF        *IN15 = *ON
     C                   UPDATE    MNHPR                                         MNHPR      Out
     C                   EXSR      LLSUP                                        <> LLSUP
 4x  C                   ELSE
     C                   EXCEPT    RELH
 4e  C                   ENDIF
     C                   MOVE      'N'           LOCKH
 4b  C                   IF        *IN81 = *ON
     C                   READ      MNHLFL                                 14    END OF FILE
 4e  C                   ENDIF
 4b  C                   IF        *IN82 = *ON
     C                   READ      MNHLFN                                 14    END OF FILE
 4e  C                   ENDIF
 4b  C                   IF        *IN83 = *ON
     C                   READ      MNHLFD                                 14    END OF FILE
 4e  C                   ENDIF
 4b  C                   IF        *IN84 = *ON
     C                   READ      MNHLFO                                 14    END OF FILE
 4e  C                   ENDIF
 4b  C  N14              IF        JOB <> JOBSAV
     C                   EVAL      *IN14 = *ON
 5b  C                   IF        *IN81 = *ON
     C                   READP     MNHLFL                                 12     MNHLFL      In
 5e  C                   ENDIF
 5b  C                   IF        *IN82 = *ON
     C                   READP     MNHLFN                                 12     MNHLFN      In
 5e  C                   ENDIF
 5b  C                   IF        *IN83 = *ON
     C                   READP     MNHLFD                                 12     MNHLFD      In
 5e  C                   ENDIF
 5b  C                   IF        *IN84 = *ON
     C                   READP     MNHLFO                                 12     MNHLFO      In
 5e  C                   ENDIF
 4e  C                   ENDIF
 GO  C                   GOTO      LSETAG
 3e  C                   ENDIF
     *  ADD
 3b  C                   IF        *IN01 = *ON
     C                   WRITE     MNHPR                                12       MNHPR      Out
     C                   EXSR      LLSUP                                        <> LLSUP
     C                   MOVE      'N'           LOCKH
     C     *IN12         CABEQ     *ON           LSEAGN
 3x  C                   ELSE
     *  CHANGE
 4b  C                   IF        *IN15 = *ON
     C                   UPDATE    MNHPR                                         MNHPR      Out
     C                   EXSR      LLSUP                                        <> LLSUP
 4x  C                   ELSE
     C                   EXCEPT    RELH
 4e  C                   ENDIF
     C                   MOVE      'N'           LOCKH
 3e  C                   ENDIF
     *
     * COPY HEADER TO ARCVIVE
     c                   if        arkvsw = 'Y'
 1b  C                   IF        LOCKH = 'Y'
     C                   EXCEPT    RELH
     C                   MOVE      'N'           LOCKH
 1e  C                   ENDIF
     c                   call      'MNARCV005'
     c                   parm                    job
     c                   parm                    lse#
     c                   endif
     *
 3b  C                   IF        *IN01 = *OFF
 4b  C                   IF        NLSE > 0
     C                   EVAL      LSE# = NLSE
 GO  C                   GOTO      LSETAG
 4e  C                   ENDIF
 3e  C                   ENDIF
     C                   EVAL      TOTINT = 0
     C     *IN01         CABEQ     *ON           DOWTAG                         ADD D/O OWNERS
     *
      /EJECT
     *
     ************************************************************
     *                                                          *
     *  DIVISION ORDER   ADD/CHANGE/DELETE RECORDS              *
     *                                                          *
     ************************************************************
     *
     C     DOWVEW        TAG                                                    DOWVEW      Tag
     C                   EVAL      *IN05 = *OFF
     C                   EVAL      *IN08 = *OFF
     *
 3b  c                   if        arrc#in > 0
     c     rrckey2       klist
     c                   kfld                    job
     c                   kfld                    arrc#in
     c     rrckey2       chain     mnalfrl
 3e  c                   endif
     *
     C     LSEKEY        CHAIN     MNHLFL                             23         MNHLFL      In
 3b  C                   IF        *IN23 = *ON
     C                   EVAL      *IN81 = *ON
     C                   EVAL      *IN82 = *OFF
     C                   EVAL      *IN83 = *OFF
     C                   EVAL      *IN84 = *OFF
 GO  C                   GOTO      LSEVEW
 3e  C                   ENDIF
     C                   EXCEPT    RELH                                         UNLOCK
     C                   MOVE      'N'           LOCKH
     *
     *  IF JUR RANGE 80 - 98 IN HEADER FILE, HIGHLIGHT LSE#
     C                   EVAL      *IN20 = *OFF
 3b  C                   DO        9             C
 4b  C                   IF        LJR(C) >= '80'
     C                             AND LJR(C) <= '98'
     C                   EVAL      *IN20 = *ON
     C                   EVAL      C = 9
 4e  C                   ENDIF
 3e  C                   ENDDO
     *
     C     DOWBGN        TAG                                                    DOWBGN      Tag
     C                   EVAL      SOPSAV = 0
     C                   EVAL      LSTSAV = 0
     C                   EVAL      NAMSAV = *BLANK
     C                   EVAL      OWNSAV = 0
     *
     C     DOWVUB        TAG
     C                   EVAL      SOPPRV = 0
     C                   EVAL      LSTPRV = 0
     C                   EVAL      DNMPRV = *BLANK
     C                   EVAL      OWNPRV = 0
     *
     C                   EVAL      *IN01 = *OFF
     C                   EVAL      *IN09 = *OFF
     C                   EVAL      *IN50 = *OFF
     *
     *  CLEAR PHYSICAL FILE MEMBER - MNDPF1
     *
     C                   CLOSE     MNDPF1                               90
     C                   CALL      'QCAEXEC'                                    'QCAEXEC'  Call
     C                   PARM                    PARM1
     C                   PARM      14            PARM2
     C                   OPEN      MNDPF1                               90
      /SPACE
     *
     *  SETUP TEMPORARY FILE
     *
     *      THIS MUST BE DONE BECAUSE IN THE DISK FILE THE OWNERS
     *      ON A LEASE ARE KEYED BY OWNER# AND THE USER NEEDS TO
     *      VIEW THEM IN OWNER NAME ORDER......BECAUSE OF DATABASE
     *      CONSIDERATIONS THE OWNER NAME IS NOT KEPT IN THE D/O RECORD.
     *
      /SPACE
     C                   EVAL      TOTOWN = 0
     C                   EVAL      TOTINT = 0
     C                   EVAL      TOTRI = 0
     C                   EVAL      TOTOP = 0
     C                   EVAL      TOTOR = 0
     C                   EVAL      TOTWI = 0
     C                   EVAL      TOTRA = 0
     C                   EVAL      TOTRIT = 0
     C                   EVAL      TOTWIT = 0
     *
     C     LSEKEY        SETLL     MNDLFL
     C     LSEKEY        READE     MNDLFL                                 98     MNDLFL      In
     *
 3b  C                   DOW       *IN98 = *OFF
     C     OWNKEY        CHAIN     MNOLFO                             22         MNOLFO      In
 4b  C                   IF        *IN22 = *OFF
     C                   EXCEPT    RELO
     C                   EXSR      CHKAUT
     *                  ENDIF
     C     *NOKEY        CLEAR                   MNOPR4
     C     OWNKEY        CHAIN(N)  MNOPF4
           if      M#SNDFILE = ' ' ;
                   M#SNDFILE = 'N' ;
           endif;
 5b  c                   if        agent# = 887   or
     c                             agent# = 889
     c                   eval      excd = 'E'
 5e  c                   endif
     *
     C                   EVAL      NEWINT = DECINT
     C                   MOVE      EXCD          NEWEXC
     *
 5b  C                   IF        CITY16 <> *BLANKS
     C                             OR STE2A <> *BLANKS
     C                   MOVEL     CITY16        AD3
 5x  C                   ELSE
     C                   MOVEL     ALTCSZ        AD3
 5e  C                   ENDIF
     *
     C                   ADD       1             TOTOWN
     C                   ADD       DECINT        TOTINT
 5b  c                   select
 5x  C     lsetyp        wheneq    1
     C                   ADD       DECINT        TOTRI
     C                   ADD       DECINT        TOTRIT
     **
 5x  C     lsetyp        wheneq    2
     C                   ADD       DECINT        TOTOR
     C                   ADD       DECINT        TOTRIT
     **
 5x  C     lsetyp        wheneq    3
     C                   ADD       DECINT        TOTOP
     C                   ADD       DECINT        TOTRIT
     **
 5x  C     lsetyp        wheneq    4
     C                   ADD       DECINT        TOTWI
     C                   ADD       DECINT        TOTWIT
     **
 5x  C     lsetyp        wheneq    10
     C                   ADD       DECINT        TOTRA
     C                   ADD       DECINT        TOTRIT
     **
 5e  C                   endsl
     C                   WRITE     MNDPR1                                                   Out
 4e  C                   ENDIF
     C     LSEKEY        READE     MNDLFL                                 98     MNDLFL      In
 3e  C                   ENDDO
     *
     C                   EVAL      ELCSUP = 'N'
     C                   EVAL      *in66 = *off
     C     *DATE         MULT      10000.0001    CODATE
     C                   Z-ADD     *YEAR         COYRAP
     C                   MOVEL     USER          COUSER
     C                   EVAL      ALTINFO = *BLANKS
 3b  C                   IF        HALSE# <> 0 AND HAJOB# <> 0
     C                   EVAL      ALTINFO = 'ALT JOB: ' + %CHAR(HAJOB#) +
     C                             '  ' + 'ALT LSE#: ' + %CHAR(HALSE#)
 3e  C                   ENDIF
     *
     *
     *  READ RECORDS ALPHABETICALLY FROM WORK FILE
     *
     C     ROLDOW        TAG                                                    ROLDOW      Tag
     C                   EVAL      *IN45 = *ON
     C                   WRITE     MNSF09                               91      CLEAR SF
     C                   EVAL      *IN45 = *OFF
     *
     *  IF D/O HAS BEEN VIEWED - THIS WILL RETURN USER TO SAME PLACE
     *
 3b  C                   IF        LSTSAV > 0
     C                             OR NAMSAV <> *BLANK
     C                   EVAL      SOPR = SOPSAV
     C                   EVAL      LSETYP = LSTSAV
     C                   MOVE      NAMSAV        NAME30
     C                   EVAL      OWNER = OWNSAV
     C     DNMKEY        SETLL     MNDPF1
 3e  C                   ENDIF
     *
 3b  C                   If        SpOprFlag <> *Blanks
     C                   Eval      *IN91 = *Off                                  Allow   Spcl Oper
 3x  C                   Else
     C                   Eval      *IN91 = *On                                   Protect Spcl Oper
 3e  C                   Endif
     C                   EVAL      OWNRRN = 1
     C                   READ      MNDPF1                                 98     MNDPF1      In
     C     *IN98         CABEQ     *ON           NOORRN
     *
 3b  C                   DOW       *IN98 = *OFF
     *
     * This check was removed becasue it si incorrect.  The key should be Job/Owner, but this key
     * also doesn't use the Privacy Code.  Checked with Sue before removing this.  SDM
     ***  OWNER         SETLL     MNOLFO                                 86     SEE IF NOT PRIVATE.
     ***                IF        *IN86 = *OFF
     C                   EVAL      SOPSAV = SOPR
     C                   EVAL      SVSOPR = SOPR
     C                   EVAL      LSTSAV = LSETYP
     C                   MOVE      NAME30        NAMSAV
     C                   EVAL      OWNSAV = OWNER
     C                   EXSR      DTOA                                         <> DTOA
     C                   EVAL      NOWN = 0
     C                   EVAL      DELCOD = *BLANK
     *
     C                   WRITE     MNSF10                                 95     MNSF10     Out
     C                   ADD       1             OWNRRN
     C     OWNRRN        CABGT     15            NOORRN
     ***                ENDIF
     C                   READ      MNDPF1                                 98     MNDPF1      In
 3e  C                   ENDDO
     C                   EVAL      *IN95 = *OFF
     C                   EVAL      *IN98 = *OFF
     *
     C     NOORRN        TAG                                                    NOORRN      Tag
     C                   EVAL      *IN06 = *OFF
     *
     C                   EVAL      RRN = 0
     C                   EVAL      *IN43 = *ON
     C                   EVAL      *IN42 = *IN98 = *OFF
     c                   clear                   arkvsw
     C                   clear                   shosel            1
     C                   EXFMT     MNSF09                                        MNSF09     I/O
     C                   EVAL      *IN42 = *OFF
     C                   EVAL      *IN43 = *OFF
     C                   MOVE      NULL          BITDSP
 3b  c                   if        enterkee = enterkey  and
     c                             arkvsw = 'C'
     c                   eval      flag = 'C' + shosel
     c                   move      codate        dteprm            8 0
     c                   call      'MNARCV003'
     c                   parm                    job
     c                   parm                    lse#
     c                   parm                    sopr
     c                   parm                    lsetyp
     c                   parm                    owner
     c                   parm                    flag
     c                   parm                    dteprm
     c                   parm                    cotime
     c                   parm                    coyrap
     c                   parm                    cocsq#
     c                   parm                    svpdec
     c                   clear                   flag
     c                   clear                   lstsav
     c                   clear                   namsav
     c                   eval      ownrrn = 1
 GO  c                   goto      dowvew
     ****               goto      noorrn
 3e  c                   endif
     c                   clear                   arkvsw
     c                   clear                   flag
     C     *INKA         CABEQ     *ON           FMEND
     C     *INKB         CABEQ     *ON           KEYLSE
     C     *INKC         CABEQ     *ON           LSETAG
     C     *INKI         CABEQ     *ON           DOWTAG                   01
     *
 3b  C     *INKX         CASEQ     *ON           PGILSE                         CALC LEASE
 3e  C                   ENDCS
     *
     * PRINT DIVISION ORDER    - IF COMBINED APP DIST THEN ALLOW
     *                           INPUT OF JURISDICTION....OR IF SPECIAL
     *                           OPERATOR JOB ALLOW SPEC OPERATOR (Y,N)...
     *
 3b  C                   IF        *INKL = *ON
     C                   MOVE      JOBNO         JSCINP
     C                   MOVE      'N'           SPPINP
     C                   EVAL      *IN21 = *OFF
     C     JOB           CHAIN     MNTPF18                            21
 4b  C                   If        *IN21 = *Off                                 Record Found
     C                   Eval      SpOprFlag = 'X'
 4x  C                   Else

     C                   Eval      SpOprFlag = *Blanks
     C                   MOVE      jobno         ljrsel
     C     LSEKEY        CHAIN     MNHLFL                             55
 5b  C                   If        *in55 = *off
 6b  C                   if        (LJR1 <> ljrsel) and (LJR2 <> ljrsel)
     C                             and (LJR3 <> ljrsel) and (LJR4 <> ljrsel)
     C                             and (LJR5 <> ljrsel) and (LJR6 <> ljrsel)
     C                             and (LJR7 <> ljrsel) and (LJR8 <> ljrsel)
     C                             and (LJR9 <> ljrsel)
 7b  C                   Dou       (*inkc and *in55 = *off)
     C                              or (ljrsel<>*blanks and *in55=*off)
     C                   Exfmt     WINDOW2
 8b  C                   If        ljrsel <> *blanks
 9b  C                   if        (LJR1 = ljrsel) or (LJR2 = ljrsel)
     C                              or (LJR3 = ljrsel) or (LJR4 = ljrsel)
     C                              or (LJR5 = ljrsel) or (LJR6 = ljrsel)
     C                              or (LJR7 = ljrsel) or (LJR8 = ljrsel)
     C                              or (LJR9 = ljrsel)
     C                   Move      ljrsel        jscinp
     C                   Eval      *in55 = *off
 7v  C                   Leave
 9x  C                   Else
     C                   eval      ljrsel = *blanks
 9e  C                   Endif                                                  *In21 = *Off
 8e  C                   Endif                                                  *In21 = *Off
 7e  C                   Enddo
 6e  C                   Endif                                                  *In21 = *Off
 5e  C                   Endif                                                  *In21 = *Off
     C     *INKC         CABEQ     *ON           NOORRN

 4e  C                   Endif                                                  *In21 = *Off
 4b  C                   IF        *IN21 = *OFF
     C                   EXFMT     MNDR09
     C     *INKA         CABEQ     *ON           FMEND
     C     *INKB         CABEQ     *ON           KEYLSE
     C     *INKC         CABEQ     *ON           NOORRN
 4e  C                   ENDIF
     C                   MOVE      JOBNO         PR2JB
     C                   MOVE      JSCINP        PR2JSC
     C                   MOVE      SPPINP        PR2OPT
     C                   MOVE      LSE#          PR2BG
     C                   MOVEA     PR2           PARM3
     C                   CALL      'QCAEXEC'                                    'QCAEXEC'  Call
     C                   PARM                    PARM3
     C                   PARM      50            PARM4
 GO  C                   GOTO      NOORRN
 3e  C                   ENDIF
     * download do
 3b  C                   IF        *INKM = *ON
     c                   call      'MNCL117CL'
 3e  C                   ENDIF
     *
     * ROLL FORWARD
     *
 3b  C                   IF        *IN10 = *ON
     C     1             CHAIN     MNSF10                             93
     C                   EVAL      OWNPRV = OWNER
     C                   MOVE      NAME30        DNMPRV
     C                   EVAL      LSTPRV = LSETYP
     C                   EVAL      SOPPRV = SOPR
     C                   EVAL      SOPSAV = 0
     C                   EVAL      LSTSAV = 0
     C                   EVAL      NAMSAV = *BLANK
     C                   EVAL      OWNSAV = 0
 GO  C                   GOTO      ROLDOW
 3e  C                   ENDIF
     *
     * ROLL BACKWARD
     *
 3b  C                   IF        *IN11 = *ON
 4b  C                   IF        OWNPRV > 0
     C                   EVAL      OWNER = OWNPRV
     C                   MOVE      DNMPRV        NAME30
     C                   EVAL      LSETYP = LSTPRV
     C                   EVAL      SOPR = SOPPRV
     C                   EVAL      OWNPRV = 0
     C                   EVAL      DNMPRV = *BLANK
     C                   EVAL      LSTPRV = 0
     C                   EVAL      SOPPRV = 0
 4x  C                   ELSE
     C     1             CHAIN     MNSF10                             93
     C     DNMKEY        SETLL     MNDPF1
 5b  C                   DO        15            X
     C                   READP     MNDPF1                                 98
     C     *IN98         CABEQ     *ON           DBNO
 5e  C                   ENDDO
 4e  C                   ENDIF
     C     DBNO          TAG
     C                   EVAL      SOPSAV = 0
     C                   EVAL      LSTSAV = 0
     C                   EVAL      NAMSAV = *BLANK
     C                   EVAL      OWNSAV = 0
     C     DNMKEY        SETLL     MNDPF1
 GO  C                   GOTO      ROLDOW
 3e  C                   ENDIF
     *
     *  DIVISION ORDER INTEREST SUMMARY
 3b  C                   IF        *INKG = *ON
     C                   EXFMT     MNDR07                                        MNDR07     I/O
     C     *INKA         CABEQ     *ON           FMEND
     C     *INKB         CABEQ     *ON           KEYLSE
     C     *INKC         CABEQ     *ON           LSETAG
 GO  C                   GOTO      NOORRN
 3e  C                   ENDIF
     *
     *  USER ENTERS NEW SPECIAL OPERATOR OR INTEREST TYPE OF NAME
     *       TO VIEW.....
     *
 3b  C                   IF        VSOPR > 0
     C                   EVAL      SOPR = VSOPR
     C                   MOVE      VINT          INTA
     C                   EXSR      ATOD
     C                   EVAL      LSETYP = LSETYP
     C                   EVAL      NAME30 = *BLANK
     C                   MOVEL     VNAM          NAME30
     C                   EVAL      SOPSAV = 0
     C                   EVAL      LSTSAV = 0
     C                   EVAL      NAMSAV = *BLANK
     C                   EVAL      OWNSAV = 0
     C     DNMKEY        SETLL     MNDPF1
 GO  C                   GOTO      ROLDOW
 3e  C                   ENDIF
     *
 3b  C                   IF        VINT <> *BLANK
     C                   EVAL      SOPR = 0
     C                   MOVE      VINT          INTA
     C                   EXSR      ATOD
     C                   EVAL      LSETYP = LSETYP
     C                   EVAL      NAME30 = *BLANK
     C                   MOVEL     VNAM          NAME30
     C                   EVAL      SOPSAV = 0
     C                   EVAL      LSTSAV = 0
     C                   EVAL      NAMSAV = *BLANK
     C                   EVAL      OWNSAV = 0
     C     DNMKEY        SETLL     MNDPF1
 GO  C                   GOTO      ROLDOW
 3e  C                   ENDIF
     *
     *  USER ENTERS NEW LEASE# TO VIEW D/O
     *
 3b  C                   IF        NLSE > 0
     C                   EVAL      LSE# = NLSE
 GO  C                   GOTO      DOWVEW
 3e  C                   ENDIF
     *
     * CMD10-> PROTEST THE WHOLE LEASE
 3b  C                   IF        *INKJ = *ON
     C                   EVAL      NEWPROCD = *BLANKS
     C                   Exfmt     WINDOW4
     C     *INKC         CABEQ     *ON           OWNTAG
 4b  C     *INKH         ifeq      *ON
     C                   CALL      'MNUP043CL'
     C                   PARM                    JOB
     C                   PARM                    LSE#
     C                   PARM                    NEWPROCD
 4e  C                   ENDIF
 3e  C                   ENDIF
     *
     * READ SUBFILE FOR CHANGED RECORDS ...... TO CHANGE OR DELETE
     *
     C                   READC     MNSF10                                 97     MNSF10      In
     C     *IN97         CABEQ     *ON           NOUP
 3b  C                   DOW       *IN97 = *OFF
     *
     *  IF CHANGING OWNER
     *
 4b  C                   IF        NOWN > 0
     C                   EVAL      OWNHLD = OWNER
     C                   EVAL      OWNER = NOWN
     C     OWNKEY        CHAIN     MNOLFO                             22         MNOLFO      In
 5b  C                   IF        *IN22 = *ON
     C                   BITON     '1'           BITDSP
     C                   EVAL      OWNER = OWNHLD
     C                   EVAL      *IN06 = *ON
     C                   UPDATE    MNSF10                                        MNSF10     Out
 GO  C                   GOTO      NCOWN
 5e  C                   ENDIF
     *
     C                   EXSR      CHKAUT
     *
     C                   EXCEPT    RELO                                          RELO       Out
     C                   MOVE      'N'           LOCKO
     C                   EVAL      OWNER = OWNHLD
     C     DOWKEY        CHAIN     MNDLFL                             24         MNDLFL      In
     *
 5b  C                   IF        *IN24 = *OFF
     C                   EVAL      OWNER = NOWN
     C                   EVAL      PRVOWN = OWNHLD
     C                   EVAL      DUSRDT = UDATE2
     C                   MOVE      USER          DUSRID
     C                   MOVE      'O'           DUSRCD
 6b  c                   if        agent# = 887   or
     c                             agent# = 889
     c                   eval      excd = 'E'
     c                   eval      newexc = 'E'
 6e  c                   endif
 6b  c                   if        excd = 'E'
     *                       do for tarrant county only
 7b  c                   if        job = 122000
     c                   move      'C'           mndxc1
 7x  c                   else
     c                   move      'N'           mndxc1
 7e  c                   endif
 6e  c                   endif
     *                       end do for tarrant county only
     C                   UPDATE    MNDPR                                12       MNDPR      Out
     *                  if        arkvsw = 'Y'
     *                  eval      flag = 'D' + shosel
     *                  call      'MNARCV003'
     *                  parm                    job
     *                  parm                    lse#
     *                  parm                    sopr
     *                  parm                    lsetyp
     *                  parm                    ownhld
     *                  parm                    flag
     *                  parm                    codate
     *                  parm                    cotime
     *                  parm                    coyrap
     *                  parm                    cocsq#
     *                  parm                    svpdec
     *                  eval      shosel = 'N'
     *                  eval      flag = ' ' + shosel
     *                  call      'MNARCV003'
     *                  parm                    job
     *                  parm                    lse#
     *                  parm                    sopr
     *                  parm                    lsetyp
     *                  parm                    owner
     *                  parm                    flag
     *                  parm                    codate
     *                  parm                    cotime
     *                  parm                    coyrap
     *                  parm                    cocsq#
     *                  parm                    svpdec
     *                  eval      shosel = 'N'
     *                  endif
     C                   EXSR      LDOUP                                        <> LDOUP
     C                   MOVE      'N'           LOCKDL
     *
 6b  C                   IF        *IN12 = *ON                                  UPDATE ERROR
     C                   BITON     '0'           BITDSP
     C                   EVAL      OWNER = OWNHLD
     C                   EVAL      *IN06 = *ON
     C                   UPDATE    MNSF10                                        MNSF10     Out
 GO  C                   GOTO      NCOWN
     *
 6x  C                   ELSE
     *
     *  WRITE OWNERSHIP CHANGE RECORD
     C                   EVAL      POWN = OWNHLD
     C                   EVAL      COWN = NOWN
     C                   EVAL      CSOPR = SOPR
     C                   EVAL      PSOPR = SOPR
     C                   EVAL      DECSAV = DECINT
     C                   EVAL      SVPDEC = *ZEROS
     C                   EXSR      WOCCOW
 6e  C                   ENDIF                                                   END 12=1
 5e  C                   ENDIF                                                   END 24=0
     *
 4e  C                   ENDIF                                                   NOWN <> 0
     *
     *  CHANGE EXCD
     C     DOWKEY        CHAIN     MNDLFL                             23         MNDLFL      In
 4b  c                   if        *in23 = *off
 5b  c                   if        agent# = 887   or
     c                             agent# = 889
     c                   eval      excd = 'E'
     c                   eval      newexc = 'E'
 5e  c                   endif
 5b  c                   if        newexc <> excd
     *                       for tarrant county only
 6b  c                   if        job = 122000
 7b  c                   select
 7x  c     newexc        wheneq    'E'
     c                   move      'C'           mndxc1
 7x  c     newexc        whenne    'E'
     c                   move      'N'           mndxc1
 7e  c                   endsl
 6e  c                   endif
 5e  c                   endif
     *                       end do for tarrant county only
 4e  c                   endif
     C                   MOVE      NEWEXC        EXCD
     C                   EVAL      DUSRDT = UDATE2
     C                   MOVE      USER          DUSRID
     C                   UPDATE    MNDPR                                         MNDPR      Out
     *                  if        arkvsw = 'Y'
     *                  eval      flag = ' ' + shosel
     *                  call      'MNARCV003'
     *                  parm                    job
     *                  parm                    lse#
     *                  parm                    sopr
     *                  parm                    lsetyp
     *                  parm                    owner
     *                  parm                    flag
     *                  parm                    codate
     *                  parm                    cotime
     *                  parm                    coyrap
     *                  parm                    cocsq#
     *                  parm                    svpdec
     *                  eval      shosel = 'N'
     *                  endif
     C                   EXSR      LDOUP                                        <> LDOUP
     C                   MOVE      'N'           LOCKDL
     *
     *  IF DELETING RECORD
     *
 4b  C                   IF        DELCOD <> *BLANK
     C                   EVAL      *IN06 = *ON
     C                   EVAL      *IN09 = *ON
     C                   BITON     '4'           BITDSP
     C                   UPDATE    MNSF10                                        MNSF10     Out
 4e  C                   ENDIF
     *
     *  NEXT CHANGED RECORD
     *
     C     NCOWN         TAG                                                    NCOWN       Tag
     C                   READC     MNSF10                                 97     MNSF10      In
 3e  C                   ENDDO                                                  END DOW 97=0
     *
 3b  C                   IF        *IN06 = *ON
     C                   TESTB     '0'           BITDSP                   12
     C                   TESTB     '1'           BITDSP                   22
     C                   TESTB     '4'           BITDSP                   09
     C     *IN09         CABEQ     *ON           DDOTAG
 GO  C                   GOTO      NOORRN
 3e  C                   ENDIF
     C                   EVAL      *IN97 = *OFF
     C     NOUP          TAG                                                    NOUP        Tag
     C     *IN97         CABEQ     *OFF          DOWVUB
     *
     * DELETE D/O RECORDS (PLACED "D" IN DELCOD)
     *
     C     DDOTAG        TAG
 3b  C                   IF        *IN09 = *ON
     C                   EVAL      *IN42 = *ON
     C                   EVAL      *IN43 = *ON
     C                   WRITE     MNSF09                                        MNSF09     I/O
     C                   EVAL      *IN42 = *OFF
     C                   EVAL      *IN43 = *OFF
     C                   MOVE      NULL          BITDSP
     C                   EVAL      *IN09 = *OFF
     C                   EXFMT     MNDR10
     C     *INKA         CABEQ     *ON           FMEND
     C     *INKB         CABEQ     *ON           KEYLSE
     C     *INKC         CABEQ     *ON           DOWVUB
 4b  C                   DO        15            DL#
     C     DL#           CHAIN     MNSF10                             94         MNSF10      In
 5b  C                   IF        *IN94 = *OFF
 6b  C                   IF        DELCOD <> *BLANK
     C     DOWKEY        CHAIN     MNDLFL                             24         MNDLFL      In
 7b  C                   IF        *IN24 = *OFF
     C                   DELETE    MNDPR
     *                  if        arkvsw = 'Y'
     *                  eval      flag = 'D' + shosel
     *                  call      'MNARCV003'
     *                  parm                    job
     *                  parm                    lse#
     *                  parm                    sopr
     *                  parm                    lsetyp
     *                  parm                    owner
     *                  parm                    flag
     *                  parm                    codate
     *                  parm                    cotime
     *                  parm                    coyrap
     *                  parm                    cocsq#
     *                  parm                    svpdec
     *                  eval      shosel = 'N'
     *                  endif
     C                   MOVE      'N'           LOCKDL
     C     DOWKEY        CHAIN     MNXPF                              25         MNXPF       In
 8b  C                   IF        *IN25 = *OFF
 9b  c                   if        job <> 122000
     C                   DELETE    MNXPR
 9e  c                   endif
 8e  C                   ENDIF
     *
     *  WRITE OWNERSHIP DELETE RECORD
     C                   MOVEL     'DLTLSEOW'    CODLTY
     C                   EXSR      WOCDLT
     C                   EVAL      CODLTY = *BLANKS
 7e  C                   ENDIF
     *
 6e  C                   ENDIF
 5e  C                   ENDIF
 4e  C                   ENDDO
 GO  C                   GOTO      DOWVUB
 3e  C                   ENDIF
     *
     * SELECT A LINE?
     C     RRN           CABLE     *ZEROS        NOORRN                                      In
     C     RRN           CHAIN     MNSF10                             94                     In
     C     *IN94         CABEQ     *ON           NOORRN
     *
     *  GO TO OWNER HOLDINGS
     *  SAVE LEASE NUMBER FOR HOLDINGS RETURN
 3b  C                   IF        *INKF = *ON
     C                   EVAL      LSTOHL = LSE#
 GO  C                   GOTO      HLDTAG
 3e  C                   ENDIF
     *
     * SPLIT OWNERSHIP AND INTEREST
 3b  C                   IF        *INKH = *ON
     C                   EVAL      *IN70 = *OFF
     C                   EVAL      OWNHLD = OWNER
     C                   EVAL      jobHLD = job
     C                   EVAL      LSEHLD = LSE#
     C                   EVAL      LSTHLD = LSETYP
     C                   MOVE      '0'           SPLFLG
     *
     C                   EXSR      WOCSPL
     C                   EVAL      *IN06 = *OFF
     C                   EVAL      *IN70 = *OFF
     *
     C     *INKA         CABEQ     *ON           FMEND
     C     *INKB         CABEQ     *ON           KEYLSE
     *
 GO  C                   GOTO      DOWBGN
 3e  C                   ENDIF
      /EJECT
     *
     ************************************************************
     *                                                          *
     *  DIVISION ORDER DISPLAY/ADD/CHANGE A SINGLE D/O RECORD   *
     *                                                          *
     ************************************************************
     *
     C     DOWTAG        TAG                                                    DOWTAG      Tag
     * ADD MODE
 3b  C                   IF        *IN01 = *ON
     C                   EVAL      OWNER = 0
     C                   EVAL      LSETYP = 0
     C                   EVAL      SVDLTY = 0
     C                   EVAL      SVALTY = *BLANK                                          TY
     C                   EVAL      INTA = *BLANK                                            TY
     * FROM OWNER RECORD
     C                   EVAL      NAME30 = *BLANK
     C                   EVAL      CARE = *BLANK
     C                   EVAL      STREET = *BLANK
     C                   EVAL      CTST30 = *BLANK
     C                   EVAL      ALTCSZ = *BLANK
     C                   EVAL      PRIVCD = 'N'
     C                   MOVE      '-'           ZDASH
     * FROM DECIMAL INTEREST RECORD
     C     JOB           CHAIN     MNNPF                              21         MNNPF       In
     C                   ADD       1             NPAR#
     C                   UPDATE    MNNPR                                         MNNPR      Out
     C                   EVAL      PARID = NPAR#
     C                   EVAL      MNDDEL = *BLANK
     C                   EVAL      SOPR = 0
     C                   EVAL      DECINT = 0
     C                   EVAL      EXCD = *BLANK
     C                   EVAL      PROCD = *BLANK
     C                   EVAL      AGEO = *BLANK
     C                   MOVEA     LJR           DJR
     C                   EVAL      DJV = 0
     *                      tarrant county only
 4b  c                   if        job = 122000
     C                   EVAL      MNDXC1 = 'N'
 4x  c                   else
     c                   eval      mndxc1 = ' '
 4e  c                   endif
     *                      end tarrant county only
     C                   EVAL      MNDXC2 = *BLANK
     C                   EVAL      DCLCCD = *BLANK
     C                   EVAL      DCLCDT = 0
     C                   EVAL      DCLCID = *BLANK
     C                   EVAL      DUSRCD = *BLANK
     C                   EVAL      DUSRDT = 0
     C                   EVAL      DUSRID = *BLANK
     C                   EVAL      DCISAV = 0
     * CHANGE MODE
 3x  C                   ELSE
     *
     C     DOWKEY        CHAIN     MNDLFL                             24         MNDLFL      In
     c                   move      excd          svexmp            1
     C                   MOVE      'Y'           LOCKDL
     *
     C     OWNKEY        CHAIN     MNOLFO                             22         MNOLFO      In
     C                   MOVE      'Y'           LOCKO
     C                   EXSR      CHKAUT
     C     *NOKEY        CLEAR                   MNOPR4
     C     OWNKEY        CHAIN(N)  MNOPF4
           if      M#SNDFILE = ' ' ;
                   M#SNDFILE = 'N' ;
           endif;
     *
     *
     C     DOWKEY        CHAIN     MNXPF                              25         MNXPF       In
 4b  C                   IF        *IN25 = *ON
     C                   EVAL      AGEO = *BLANK
 4e  C                   ENDIF
     *
     C                   EVAL      DCISAV = DECINT
     *
     C                   EXSR      DTOA                                         <> DTOA
     C                   EVAL      SVDLTY = LSETYP
     C                   MOVEL     INTA          SVALTY                                     TY
     C                   EVAL      SVOWN = OWNER
     C                   EVAL      SVSOPR = SOPR
     * CHECK FOR NOTES
     C     DONOTE        TAG
     C                   EVAL      SEL2 = 1
     C                   EVAL      NBR1 = JOB
     C                   EVAL      NBR2 = OWNER
     C                   EVAL      NBR3 = 0
     C     UTNKEY        CHAIN     UTNPF                              26         UTNPF       In
     *
     C     *IN08         CABEQ     *ON           VALTAG
     *
 3e  C                   ENDIF
     *
     *  DISPLAY / ADD / CHANGE INTEREST RECORD
     *
     C                   EVAL      *IN71 = *OFF
     C                   EVAL      *IN27 = *OFF
     *
     C     DOWAGN        TAG                                                    DOWAGN      Tag
     C                   EVAL      *IN04 = NAME30 <> *BLANK
     C                   MOVEL     NAME30        NMC2
     * Flip Year Left to Right
     * Flip year from YYYYMMDD (8) to MMDDYYYY (8) for Output
     C                   MOVE      DCLCDT        Y2KYMD
     C                   EVAL      Y2KYYR = Y2KYYL
     C                   MOVE      Y2KMDY        Y2K006
     *
     * Flip Year Left to Right
     * Flip year from YYYYMMDD (8) to MMDDYYYY (8) for Output
     C                   MOVE      DUSRDT        Y2KYMD
     C                   EVAL      Y2KYYR = Y2KYYL
     C                   MOVE      Y2KMDY        Y2K007
     *
 3b  C     SpOprFlag     IfEq      *Blanks
     C     *IN09         OrEq      *On
     C                   Eval      *IN91 = *On                                  Protect Spcl Oper
 3e  C                   Endif
     *
     C                   EVAL      *IN59 = PRIVCD = 'Y'
     *
 3b  c                   if        hajob# <> 0  and
     c                             halse# <> 0
     c                   eval      altjob = hajob#
     c                   eval      altlse = halse#
     c                   z-add     sopr          ssopr             3 0
     c                   z-add     lsetyp        stypp             1 0
     c                   eval      altchg = 'Y'
     c                   if        job = 416600
     c                   eval      altchg = 'N'
     c                   endif
 3x  c                   else
     c                   clear                   hajob#
     c                   clear                   halse#
     C                   CLEAR                   ALTJOB
     C                   CLEAR                   ALTLSE
     c                   clear                   altchg
 3e  c                   endif
     ***
     *  SEE IF INVENTORIES EXIST FOR OWNER
     C     INVKEY        CHAIN     MNILFOS                            95
 3b  C                   IF        *IN95 = *ON
     C                   MOVE      'NO INVENTORY'invflg                          NO INV
 3x  C                   ELSE
     C                   clear                   invflg                          INV EXISTS
 3e  C                   ENDIF
     *
     c                   exsr      resoncd
     * vb 09/14
     c                   exsr      getnotc
            *IN88 = *off;
            lowner = 0;
            if job = 900700 or job = 901900
            or job = 900700 or job = 901900
            or job = 902100 or job = 902300
            or job = 904100 or job = 904500
            or job = 908300 or job = 908700
            or job = 909700 or job = 909900
            or job = 910100;
            *IN88 = *on;
            if owner <> 0;
            chain(E) (job:owner) mnoxolf;
            if not %found(mnoxolf);
               lowner = 0;
             endif;
             endif;
             endif;
     * vb 09/14
     c                   eval      USERPWD  = *blanks
     C     OWNKEY        CHAIN     MNOLF6
     C                   EXFMT     MNDR05                                       UPDATE SCREE
     c   46              exsr      resonsl

     C                   Eval      *IN91 = *Off                                 Protect Spcl Oper
     C                   EVAL      *IN08 = *OFF
     C                   EVAL      *IN27 = *OFF
     *
     C     *INKA         CABEQ     *ON           FMEND
     C     *INKB         CABEQ     *ON           KEYLSE
     * NO CHANGE
 3b  C                   IF        *INKC = *ON
 4b  C                   IF        LOCKO = 'Y'
     C                   EXCEPT    RELO
     C                   MOVE      'N'           LOCKO
 4e  C                   ENDIF
 4b  C                   IF        LOCKDL = 'Y'
     C                   EXCEPT    RELDL
     C                   MOVE      'N'           LOCKDL
 4e  C                   ENDIF
     c                   clear                   lstsav
     c                   clear                   namsav
 GO  C                   GOTO      DOWVUB
 3e  C                   ENDIF
     *
     *  CHANGE OWNERS INTEREST
 3b  C                   IF        *INKJ = *ON
     *
     * Flip Year Left to Right
     * Flip year from YYYYMMDD (8) to MMDDYYYY (8) for Output
     C                   MOVE      DCLCDT        Y2KYMD
     C                   EVAL      Y2KYYR = Y2KYYL
     C                   MOVE      Y2KMDY        Y2K008
     *
     * Flip Year Left to Right
     * Flip year from YYYYMMDD (8) to MMDDYYYY (8) for Output
     C                   MOVE      DUSRDT        Y2KYMD
     C                   EVAL      Y2KYYR = Y2KYYL
     C                   MOVE      Y2KMDY        Y2K009
     *
     * vb 09/14
     c                   exsr      getnotc
     *vb 09/14
     C                   EXFMT     MNDR05A
     C     *INKA         CABEQ     *ON           FMEND
     C     *INKB         CABEQ     *ON           KEYLSE
     C     *INKC         CABEQ     *ON           DOWTAG
     *
     *  INTEREST CHANGED?
 4b  C                   IF        *IN15 = *ON
     *
     C     DECINT        CABLE     *ZEROS        DOWTAG
     C     DECINT        SUB       DCISAV        DCINEW
     C                   ADD       DCINEW        TOTINT
     *
     C                   EVAL      DUSRDT = UDATE2
     C                   MOVE      USER          DUSRID
     c     dcinew        mult      djv1          ckint            11 0
 5b  c                   if        ckint > 0
 6b  c                   if        excd <> 'E'
     *                      tarrant county only
 7b  c                   if        job = 122000
     c                   move      'N'           mndxc1
 7e  c                   endif
     *                      end tarrant county only
 6e  c                   endif
 5e  c                   endif
     C                   UPDATE    MNDPR
     *                  if        arkvsw = 'Y'
     *                  eval      flag = ' ' + shosel
     *                  call      'MNARCV003'
     *                  parm                    job
     *                  parm                    lse#
     *                  parm                    sopr
     *                  parm                    lsetyp
     *                  parm                    owner
     *                  parm                    flag
     *                  parm                    codate
     *                  parm                    cotime
     *                  parm                    coyrap
     *                  parm                    cocsq#
     *                  parm                    dcinew
     *                  eval      shosel = 'N'
     *                  endif
     C                   MOVE      'N'           LOCKDL
     *
     *  WRITE OWNERSHIP INTEREST CHANGE
     C                   EXSR      WOCINT
 4e  C                   ENDIF
     *
     **   maintain the alternate order
 4b  c                   if        altchg = 'Y'
     c                   exsr      chgaldo
 4e  c                   endif
     **
 GO  C                   GOTO      DOWTAG
     *
 3e  C                   ENDIF
     *
     *  NOTES
 3b  C                   IF        *INKM = *ON
     C                   MOVEA     PR3           PARM5
     C                   CALL      'QCAEXEC'                                    'QCAEXEC'  Call
     C                   PARM                    PARM5
     C                   PARM      70            PARM6
     C     UTNKEY        CHAIN     UTNPF                              26         UTNPF       In
 GO  C                   GOTO      DOWAGN
 3e  C                   ENDIF
     *
 3b  C                   IF        *INKN = *ON                                  C14 PRT OWN ADDRESS
     C                   EVAL      #NAME30 = NAME30
     C                   EVAL      #CARE   = CARE
     C                   EVAL      #STREET = STREET
 4b  C                   IF        ALTCSZ <> *BLANKS
     C                   EVAL      #CITYSTZP = ALTCSZ
 4x  C                   ELSE
     C                   EVAL      #CITYSTZP = %TRIM(CITY16)+', ' +%TRIM(STE2A)
     C                             + ' ' +%TRIM(ZIPA)
 5b  C                   IF        PLUS4 <> '0000' AND PLUS4 <> '    '
     C                   EVAL      #CITYSTZP = %TRIM(#CITYSTZP) + '-' + PLUS4
 5e  C                   ENDIF
 4e  C                   ENDIF
     C                   OPEN      QPRINT
     C                   EXCEPT    HDG
     C                   CLOSE     QPRINT
 GO  C                   GOTO      DOWAGN
 3e  C                   ENDIF
     *
 3b  C                   IF        *INKP = *ON                                  C15 PRT AGT ADDRESS
     C                   CLEAR                   #NAME30
     C                   CLEAR                   #CARE
     C                   CLEAR                   #STREET
     C                   CLEAR                   #CITYSTZP
 4b  C                   IF        AGENT# > 0
     C     AGENT#        CHAIN     MNGLFA                                        MNGLFA      In
 5b  C                   IF        %FOUND(MNGLFA)
     C                   EVAL      #NAME30 = AGENTN
     C                   EVAL      #CARE   = AGFIRM
     C                   EVAL      #STREET = AGSTRT
     C                   EVAL      #CITYSTZP = %TRIM(AGCT16)+', ' +%TRIM(AGST2A)
     C                             + ' ' +%TRIM(AGZIPA)
 6b  C                   IF        AGPLUS <> '0000' AND AGPLUS <> '    '
     C                   EVAL      #CITYSTZP = %TRIM(#CITYSTZP) + '-' + AGPLUS
 6e  C                   ENDIF
 5e  C                   ENDIF
     C                   OPEN      QPRINT
     C                   EXCEPT    HDG
     C                   CLOSE     QPRINT
 4e  C                   ENDIF
 GO  C                   GOTO      DOWAGN
 3e  C                   ENDIF
     *
 3b  C                   IF        *IN01 = *ON
 4b  C                   IF        NNAM <> *BLANK
     C                   MOVE      NNAM          NAME20
     C                   MOVEL     'NAME'        OVWTYP
 GO  C                   GOTO      OWNVEW
 4e  C                   ENDIF
 4b  C                   IF        *IN03 = *ON                                  CHANGE(03)
 5b  C                   IF        OWNER > 0                                    ONLY WHEN 01='1'
     C     OWNKEY        CHAIN     MNOLFO                             22         MNOLFO      In
 6b  C                   IF        *IN22 = *OFF
     C                   MOVE      'Y'           LOCKO
     C                   EXSR      CHKAUT
 6e  C                   ENDIF
 GO  C                   GOTO      DOWAGN
 5e  C                   ENDIF
 4e  C                   ENDIF
 3e  C                   ENDIF
     C     *NOKEY        CLEAR                   MNOPR4
     C     OWNKEY        CHAIN(N)  MNOPF4
           if      M#SNDFILE = ' ' ;
                   M#SNDFILE = 'N' ;
           endif;
     *
     C     DECINT        CABLE     0             DOWAGN                 7171
     **   DECINT        CABGE     1             DOWAGN               71  71
     C     DECINT        CABGT     1             DOWAGN               71
     *
     C                   EXSR      ATOD
     C     *IN70         CABEQ     *ON           DOWAGN
 3b  C                   IF        AGENT# > 0
     C     AGENT#        CHAIN     MNGLFA                             28         MNGLFA      In
     C     *IN28         CABEQ     *ON           DOWAGN
 3e  C                   ENDIF
     *
     *  NAME/ADDRESS CHANGED?
 3b  C                   IF        *IN17 = *ON
     C     NAME30        CABEQ     *BLANKS       DOWAGN                   67

 4b  C                   IF        *IN01 = *OFF
     C                   MOVEL     NAME30        NMC2NW
     C     NMC2NW        CABNE     NMC2          DOWAGN               6767
 4e  C                   ENDIF

     C     '.'           LOOKUP    NM                                     68
     C     *IN68         CABEQ     *ON           DOWAGN
     C     ','           LOOKUP    NM                                     69
     C     *IN69         CABEQ     *ON           DOWAGN
     *
     *  EITHER CITY/STATE/ZIP OR ALTERNATE, NOT BOTH
 4b  C                   IF        (CITY16 <> *BLANKS
     C                              OR STE2A <> *BLANKS
     C                              OR ZIPA <> *BLANKS
     C                              OR PLUS4 <> *BLANKS)
     C                             AND ALTCSZ <> *BLANKS
     C                   EVAL      *IN27 = *ON
 GO  C                   GOTO      DOWAGN
 4e  C                   ENDIF
 3e  C                   ENDIF
     *
 3b  C                   IF        CITY16 <> *BLANKS
     C                             OR STE2A <> *BLANKS
 4b  C                   IF        PLUS4 <> *BLANKS
     C                             AND PLUS4 <> '0000'
     C                   MOVE      '-'           ZDASH
 4x  C                   ELSE
     C                   EVAL      ZDASH = *BLANKS
 4e  C                   ENDIF
 3e  C                   ENDIF
     *
     C                   EVAL      OUSRDT = UDATE2
     C                   MOVE      USER          OUSRID
     C                   EVAL      DUSRDT = UDATE2
     C                   MOVE      USER          DUSRID
     *
     * ADD NEW RECORD
     *
 3b  C                   IF        *IN01 = *ON
     C                   MOVE      'A'           DUSRCD
     *                       tarrant county only
 4b  c                   if        job = 122000
     c                   move      'N'           mndxc1
 4x  c                   else
     c                   clear                   mndxc1
 4e  c                   endif
     *                       end tarrant county
     C                   EVAL      DUSRDT = UDATE2
     C                   MOVE      USER          DUSRID
 4b  c                   if        agent# = 887   or
     c                             agent# = 889
     c                   eval      excd = 'E'
 4e  c                   endif
     c                   if        owner > 0
     C                   WRITE     MNDPR                                12       MNDPR      Out
     c                   endif
     *                  if        arkvsw <> ' '
     *                  eval      flag = arkvsw + shosel
     *                  call      'MNARCV003'
     *                  parm                    job
     *                  parm                    lse#
     *                  parm                    sopr
     *                  parm                    lsetyp
     *                  parm                    owner
     *                  parm                    flag
     *                  parm                    codate
     *                  parm                    cotime
     *                  parm                    coyrap
     *                  parm                    cocsq#
     *                  parm                    svpdec
     *                  eval      shosel = 'N'
     *                  endif
     C                   EXSR      LDOUP                                        <> LDOUP
     C                   MOVE      'N'           LOCKDL
     C     *IN12         CABEQ     *ON           DOWAGN
 4b  C                   IF        *IN17 = *ON
     C                   EXSR      SAVE3
     C                   UPDATE    MNOPR                                         MNOPR      Out
     C                   EXSR      chgcomm
     c   64              update    mnopr3
     C                   EXSR      SAVE4
     C                   EXSR      LOWUP                                        <> LOWUP
 4x  C                   ELSE
     C                   EXCEPT    RELO                                          RELO       Out
 4e  C                   ENDIF
     C                   MOVE      'N'           LOCKO
 4b  C                   IF        AGEO <> *BLANK                               CUSTOMER GEO FILE
     C                   WRITE     MNXPR                                         MNXPR      Out
 4e  C                   ENDIF
     *
     *  WRITE OWNERSHIP ADD RECORD
     C                   EXSR      WOCAOW
     *
     C     DECINT        SUB       DCISAV        DCINEW
     C                   ADD       DCINEW        TOTINT
 GO  C                   GOTO      DOWTAG
     *
     * CHANGE EXISTING RECORD
     *
 3x  C                   ELSE
 4b  C                   IF        *IN15 = *ON
     C                   MOVE      'C'           DUSRCD
     ****               move      ' '           mndxc1
 5b  c                   if        svexmp <> excd
     *                      tarrant county
 6b  c                   if        job = 122000
 7b  c                   select
 7x  c     excd          wheneq    'E'
     c                   move      'C'           mndxc1
 7x  c     excd          whenne    'E'
     c                   move      'N'           mndxc1
 7e  c                   endsl
 6e  c                   endif
     *                       end tarrant county
 5e  c                   endif
 4e  C                   ENDIF
 4b  C                   IF        *IN17 = *ON
     C                   MOVE      'N'           DUSRCD
 4e  C                   ENDIF
     *
     *  DIVISION ORDER INFORMATION CHANGED ?
     *
 4b  C                   IF        *IN15 = *ON
     C                   EVAL      DUSRDT = UDATE2
     C                   MOVE      USER          DUSRID
     C                   UPDATE    MNDPR                                31                  Out
     **   chg alt do if requested
 5b  c                   if        altchg = 'Y'
     c                   exsr      chgaldo
 5e  c                   endif
     *                  if        arkvsw = 'Y'
     *                  eval      flag = ' ' + shosel
     *                  call      'MNARCV003'
     *                  parm                    job
     *                  parm                    lse#
     *                  parm                    sopr
     *                  parm                    lsetyp
     *                  parm                    owner
     *                  parm                    flag
     *                  parm                    codate
     *                  parm                    cotime
     *                  parm                    coyrap
     *                  parm                    cocsq#
     *                  parm                    svpdec
     *                  eval      shosel = 'N'
     *                  endif
 5b  C                   IF        *IN31 = *ON
     C                   EVAL      OWNER = SVOWN
     C                   EVAL      SOPR = SVSOPR
     C                   EVAL      LSETYP = SVDLTY
     C     DOWKEY        CHAIN     MNDLFL                             24
     C                   MOVE      'Y'           LOCKDL
     C     OWNKEY        CHAIN     MNOLFO                             24
     C                   MOVE      'Y'           LOCKO
     C                   EXSR      CHKAUT
     C     *NOKEY        CLEAR                   MNOPR4
     C     OWNKEY        CHAIN(N)  MNOPF4
           if      M#SNDFILE = ' ' ;
                   M#SNDFILE = 'N' ;
           endif;
     c                   exsr      resoncd
     C                   READ      MNDR05                                 24
     C                   EVAL      *IN24 = *OFF
     C                   EVAL      *IN31 = *ON
 GO  C                   GOTO      DOWAGN
 5x  C                   ELSE
     C                   EXSR      LDOUP
     C                   MOVE      'N'           LOCKDL
 5e  C                   ENDIF
     *
     *  WRITE OWNERSHIP TYPE INTEREST CHANGE
 5b  C                   IF        SVALTY <> INTA
     C                             OR SVSOPR <> SOPR
     C                   EXSR      WOCCTY
     C                   MOVEL     INTA          SVALTY
     C                   EVAL      SVSOPR = SOPR
 5e  C                   ENDIF
     *
 4x  C                   ELSE
     *
     C                   EXCEPT    RELDL                                         RELDL      Out
 4e  C                   ENDIF
     C                   MOVE      'N'           LOCKDL
     *
     *  OWNER NAME AND ADDRESS INFORMATION CHANGED ?
     *
 4b  C                   IF        *IN17 = *ON   or
     c                             *in46 = *on
     c                   eval      svreas = reas
     C                   EXSR      SAVE3
     c                   eval      reas = svreas
     C                   UPDATE    MNOPR                                         MNOPR      Out
     C                   EXSR      chgcomm
     c   64              update    mnopr3
     * FORCE USER TO DECIDE TO UPDATE ARCHIVES
     c                   call      'MNARCV001'
     c                   parm                    job
     c                   parm                    owner
     *
     **       chg alt do if requested
 5b  c                   if        altchg = 'Y'
     c                   exsr      chgalnm
 5e  c                   endif
     C                   EXSR      SAVE4
     C                   EXSR      LOWUP                                        <> LOWUP
 4x  C                   ELSE
     C                   EXCEPT    RELO                                          RELO       Out
 4e  C                   ENDIF
     C                   MOVE      'N'           LOCKO
     *
     * CHECK CUSTOMER GEO#
 4b  C                   IF        *IN07 = *ON                                  CHANGE CUST GEO#
 5b  C                   IF        AGEO <> *BLANK
 6b  C                   IF        *IN25 = *ON
     C                   WRITE     MNXPR                                12      NEW GEO#
 6e  C                   ENDIF
 6b  C                   IF        *IN25 = *OFF
     C                   UPDATE    MNXPR                                        UPDATE CURRENT
 6e  C                   ENDIF
 5x  C                   ELSE
 6b  C                   IF        *IN25 = *OFF
 7b  c                   if        job <> 122000
     C                   DELETE    MNXPR                                        BLANKED OUT
 7e  c                   endif
 6e  C                   ENDIF
 5e  C                   ENDIF
 4e  C                   ENDIF
     *
 3e  C                   ENDIF
     *
     * COMMAND 7 PROCESSES THE VALUES SCREEN
     *
 3b  C                   IF        *INKG = *ON
     C     VALTAG        TAG                                                    VALTAG      Tag
     *
     C                   EVAL      *IN08 = *ON
     C     DOWKEY        CHAIN     MNDLFL                             24         MNDLFL      In
     C                   MOVE      'Y'           LOCKDL
     *
     c     decint        mult      djv1          bgntx            11 0
     C                   EVAL      DSPCSZ = *BLANKS
 4b  C                   IF        CTST30 <> *BLANKS
 5b  C                   IF        PLUS4 <> *BLANKS
     C                             AND PLUS4 <> '0000'
     C                   MOVE      '-'           ZDASH
 5x  C                   ELSE
     C                   EVAL      ZDASH = *BLANKS
 5e  C                   ENDIF
     C                   MOVE      CTST30        DSPCSZ
 4x  C                   ELSE
     C                   MOVE      ALTCSZ        DSPCSZ
 4e  C                   ENDIF
     *
     C     VALAGN        TAG                                                    VALAGN      Tag
     * Flip Year Left to Right
     * Flip year from YYYYMMDD (8) to MMDDYYYY (8) for Output
     C                   MOVE      DCLCDT        Y2KYMD
     C                   EVAL      Y2KYYR = Y2KYYL
     C                   MOVE      Y2KMDY        Y2K010
     *
     * Flip Year Left to Right
     * Flip year from YYYYMMDD (8) to MMDDYYYY (8) for Output
     C                   MOVE      DUSRDT        Y2KYMD
     C                   EVAL      Y2KYYR = Y2KYYL
     C                   MOVE      Y2KMDY        Y2K011
     *
     c*                  eval      @year = matxyr - 1
     c                   eval      @year = matxyr
     c                   clear                   LYV
     c                   clear                   cpl
     C                   CALL      'MNCACPD'
     C                   PARM                    JOB
     C                   PARM                    @YEAR             4 0
     C                   PARM                    LSE#
     C                   PARM                    SOPR
     C                   PARM                    LSETYP
     C                   PARM                    OWNER
     C     LYV(1)        PARM                    LYV1             11 0
     C     LYV(2)        PARM                    LYV2             11 0
     C     LYV(3)        PARM                    LYV3             11 0
     C     LYV(4)        PARM                    LYV4             11 0
     C     LYV(5)        PARM                    LYV5             11 0
     C     LYV(6)        PARM                    LYV6             11 0
     C     LYV(7)        PARM                    LYV7             11 0
     C     LYV(8)        PARM                    LYV8             11 0
     C     LYV(9)        PARM                    LYV9             11 0
     C                   PARM                    CCV1X            11 0
     C                   PARM                    CCV2X            11 0
     C                   PARM                    CCV3X            11 0
     C                   PARM                    CCV4X            11 0
     C                   PARM                    CCV5X            11 0
     C                   PARM                    CCV6X            11 0
     C                   PARM                    CCV7X            11 0
     C                   PARM                    CCV8X            11 0
     C                   PARM                    CCV9X            11 0
     C     CPL(1)        PARM                    CPL1              9 0
     C     CPL(2)        PARM                    CPL2              9 0
     C     CPL(3)        PARM                    CPL3              9 0
     C     CPL(4)        PARM                    CPL4              9 0
     C     CPL(5)        PARM                    CPL5              9 0
     C     CPL(6)        PARM                    CPL6              9 0
     C     CPL(7)        PARM                    CPL7              9 0
     C     CPL(8)        PARM                    CPL8              9 0
     C     CPL(9)        PARM                    CPL9              9 0
     C                   PARM                    djr1
     C                   PARM                    djr2
     C                   PARM                    djr3
     C                   PARM                    djr4
     C                   PARM                    djr5
     C                   PARM                    djr6
     C                   PARM                    djr7
     C                   PARM                    djr8
     C                   PARM                    djr9
     C                   PARM                    ttldecint         7 6
     C*                  EVAL      DECINT = TTLDECINT
     *
     c                   eval      ccv1 = ccv1x
     c                   eval      ccv2 = ccv2x
     c                   eval      ccv3 = ccv3x
     c                   eval      ccv4 = ccv4x
     c                   eval      ccv5 = ccv5x
     c                   eval      ccv6 = ccv6x
     c                   eval      ccv7 = ccv7x
     c                   eval      ccv8 = ccv8x
     c                   eval      ccv9 = ccv9x
     *
     c                   eval      clv1 = cpl1
     c                   eval      clv2 = cpl2
     c                   eval      clv3 = cpl3
     c                   eval      clv4 = cpl4
     c                   eval      clv5 = cpl5
     c                   eval      clv6 = cpl6
     c                   eval      clv7 = cpl7
     c                   eval      clv8 = cpl8
     c                   eval      clv9 = cpl9
     *
     *
     c                   eval(h)   dtv1 = djv1 - clv1
     c                   eval(h)   dtv2 = djv2 - clv2
     c                   eval(h)   dtv3 = djv3 - clv3
     c                   eval(h)   dtv4 = djv4 - clv4
     c                   eval(h)   dtv5 = djv5 - clv5
     c                   eval(h)   dtv6 = djv6 - clv6
     c                   eval(h)   dtv7 = djv7 - clv7
     c                   eval(h)   dtv8 = djv8 - clv8
     c                   eval(h)   dtv9 = djv9 - clv9
     c*    djv1          SUB       clv1          dtv1
     c*                  SUB       clv2          dtv2
     c*                  SUB       clv3          dtv3
     c*                  SUB       clv4          dtv4
     c*                  SUB       clv5          dtv5
     c*                  SUB       clv6          dtv6
     c*                  SUB       clv7          dtv7
     c*                  SUB       clv8          dtv8
     c*                  SUB       clv9          dtv9
     c*                  eval(h)   dtv1 = dtv1 - clv1
     c*                  eval(h)   dtv2 = dtv2 - clv2
     c*                  eval(h)   dtv3 = dtv3 - clv3
     c*                  eval(h)   dtv4 = dtv4 - clv4
     c*                  eval(h)   dtv5 = dtv5 - clv5
     c*                  eval(h)   dtv6 = dtv6 - clv6
     c*                  eval(h)   dtv7 = dtv7 - clv7
     c*                  eval(h)   dtv8 = dtv8 - clv8
     c*                  eval(h)   dtv9 = dtv9 - clv9
     *
     c                   eval      *IN66 = sopr > 0
     *
     *
     C                   EXFMT     MNDR06                                                   I/O
     C     *INKA         CABEQ     *ON           FMEND
     C     *INKB         CABEQ     *ON           KEYLSE
     c                   eval      *IN66 = *off
     * NO CHANGE
 4b  C                   IF        *INKC = *ON
 5b  C                   IF        LOCKO = 'Y'
     C                   EXCEPT    RELO
     C                   MOVE      'N'           LOCKO
 5e  C                   ENDIF
 5b  C                   IF        LOCKDL = 'Y'
     C                   EXCEPT    RELDL
     C                   MOVE      'N'           LOCKDL
 5e  C                   ENDIF
 GO  C                   GOTO      DOWVUB
 4e  C                   ENDIF
     *
     * NOTES ROUTINE
     *
 4b  C  N01              IF        *INKM = *ON
     C                   MOVEA     PR3           PARM5
     C                   CALL      'QCAEXEC'                                    'QCAEXEC'  Call
     C                   PARM                    PARM5
     C                   PARM      70            PARM6
     C     UTNKEY        CHAIN     UTNPF                              26         UTNPF       In
 GO  C                   GOTO      VALAGN
 4e  C                   ENDIF
     *
     * JURSISDICTION - MINIMUM OF ONE
     C                   EVAL      *IN69 = DJRC = *BLANK
     C     *IN69         CABEQ     *ON           VALAGN
     *
     * JURSISDICTION - DOUBLE JUR
 4b  C                   DO        8             B
 5b  C                   IF        DJR(B) <> *BLANK
     C                   MOVE      DJR(B)        TESTJ
     C                   EVAL      Z = 1
     C     TESTJ         LOOKUP    DJR(Z)                                 70
     C                   ADD       1             Z
     C     TESTJ         LOOKUP    DJR(Z)                                 70
     C     *IN70         CABEQ     *ON           VALAGN
 5e  C                   ENDIF
 4e  C                   ENDDO
     * VERIFY JURISDICTIONS
     C                   EVAL      *IN71 = DJR1 = *BLANK
 4b  C                   IF        *IN71 = *OFF
     C     DJR1          LOOKUP    LJR                                    71
 4e  C                   ENDIF
     C                   EVAL      *IN72 = DJR2 = *BLANK
 4b  C                   IF        *IN72 = *OFF
     C     DJR2          LOOKUP    LJR                                    72
 4e  C                   ENDIF
     C                   EVAL      *IN73 = DJR3 = *BLANK
 4b  C                   IF        *IN73 = *OFF
     C     DJR3          LOOKUP    LJR                                    73
 4e  C                   ENDIF
     C                   EVAL      *IN74 = DJR4 = *BLANK
 4b  C                   IF        *IN74 = *OFF
     C     DJR4          LOOKUP    LJR                                    74
 4e  C                   ENDIF
     C                   EVAL      *IN75 = DJR5 = *BLANK
 4b  C                   IF        *IN75 = *OFF
     C     DJR5          LOOKUP    LJR                                    75
 4e  C                   ENDIF
     C                   EVAL      *IN76 = DJR6 = *BLANK
 4b  C                   IF        *IN76 = *OFF
     C     DJR6          LOOKUP    LJR                                    76
 4e  C                   ENDIF
     C                   EVAL      *IN77 = DJR7 = *BLANK
 4b  C                   IF        *IN77 = *OFF
     C     DJR7          LOOKUP    LJR                                    77
 4e  C                   ENDIF
     C                   EVAL      *IN78 = DJR8 = *BLANK
 4b  C                   IF        *IN78 = *OFF
     C     DJR8          LOOKUP    LJR                                    78
 4e  C                   ENDIF
     C                   EVAL      *IN79 = DJR9 = *BLANK
 4b  C                   IF        *IN79 = *OFF
     C     DJR9          LOOKUP    LJR                                    79
 4e  C                   ENDIF
     C                   EVAL      *IN71 = *IN71 = *OFF
     C                   EVAL      *IN72 = *IN72 = *OFF
     C                   EVAL      *IN73 = *IN73 = *OFF
     C                   EVAL      *IN74 = *IN74 = *OFF
     C                   EVAL      *IN75 = *IN75 = *OFF
     C                   EVAL      *IN76 = *IN76 = *OFF
     C                   EVAL      *IN77 = *IN77 = *OFF
     C                   EVAL      *IN78 = *IN78 = *OFF
     C                   EVAL      *IN79 = *IN79 = *OFF
 4b  C                   IF        *IN71 = *OFF
     C                             AND *IN72 = *OFF
     C                             AND *IN73 = *OFF
     C                             AND *IN74 = *OFF
     C                             AND *IN75 = *OFF
     C                             AND *IN76 = *OFF
     C                             AND *IN77 = *OFF
     C                             AND *IN78 = *OFF
     C                             AND *IN79 = *OFF
 GO  C                   GOTO      JURCH2
 4e  C                   ENDIF
 GO  C                   GOTO      VALAGN
     *
     C     JURCH2        TAG                                                    JURCH2      Tag
     C                   EVAL      DCLCDT = UDATE2
     C                   MOVE      USER          DCLCID
     ****  *in15 is on if any juris or juris value changes
 4b  C                   IF        *IN15 = *ON
     C                   MOVE      'V'           DCLCCD
     c     decint        mult      djv1          nutx             11 0
     c     nutx          sub       bgntx         dftx             11 0
 5b  c                   if        dftx > 0
 6b  c                   if        excd <> 'E'
     *                       tarrant county only
 7b  c                   if        job = 122000
     c                   move      'N'           mndxc1
 7e  c                   endif
     *                       end tarrant couinty
 6e  c                   endif
 5e  c                   endif
     C                   EVAL      DUSRDT = UDATE2
     C                   MOVE      USER          DUSRID
     C                   UPDATE    MNDPR                                         MNDPR      Out
     *                  if        arkvsw = 'Y'
     *                  eval      flag = ' ' + shosel
     *                  call      'MNARCV003'
     *                  parm                    job
     *                  parm                    lse#
     *                  parm                    sopr
     *                  parm                    lsetyp
     *                  parm                    owner
     *                  parm                    flag
     *                  parm                    codate
     *                  parm                    cotime
     *                  parm                    coyrap
     *                  parm                    cocsq#
     *                  parm                    svpdec
     *                  eval      shosel = 'N'
     *                  endif
     C                   EXSR      LDOUP                                        <> LDOUP
 4x  C                   ELSE
     C                   EXCEPT    RELDL
 4e  C                   ENDIF
     C                   MOVE      'N'           LOCKDL
 4b  C                   IF        *IN10 = *OFF
 5b  C                   IF        *IN11 = *OFF
     C                   EVAL      *IN08 = *OFF
 GO  C                   GOTO      DOWTAG
 5e  C                   ENDIF
 4e  C                   ENDIF
 3e  C                   ENDIF
     *
     * PREVIOUS
     *
 3b  C                   IF        *IN11 = *ON
     C     DNMKEY        CHAIN     MNDPF1                             24         MNDPF1      In
     C                   READP     MNDPF1                                 13    BEG OF FILE
 GO  C                   GOTO      DOWTAG
 3e  C                   ENDIF
     *
     * NEXT
     *
 3b  C                   IF        *IN10 = *ON
     C     DNMKEY        CHAIN     MNDPF1                             24         MNDPF1      In
     C                   READ      MNDPF1                                 14    END OF FILE
 GO  C                   GOTO      DOWTAG
 3e  C                   ENDIF
     *
 GO  C                   GOTO      DOWVUB
     *
     *
     *  END OF PROGRAM
     *
     *
     C     FMEND         TAG                                                    FMEND       Tag
     c                   close     mnolf3a
     c                   close     mnolf3g
     C                   EVAL      *INLR = *ON
     *
      /EJECT
     *
     *=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-*
     * POP UP WINDOW FOR LOCATION CODES
     *=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-*
     C     GETLOCCOD     BEGSR
     C                   CALL      'MNW01LC'
     C                   PARM                    JOB
     C                   PARM                    @lcod             3
     C                   PARM                    @LDESC           30
     C                   PARM                    @ljur1            2
     C                   PARM                    @ljur2            2
     C                   PARM                    @ljur3            2
     C                   PARM                    @ljur4            2
     C                   PARM                    @ljur5            2
     C                   PARM                    @ljur6            2
     C                   PARM                    @ljur7            2
     C                   PARM                    @ljur8            2
     C                   PARM                    @ljur9            2
     C                   PARM                    @ljur10           2
     C                   PARM                    @ljur11           2
     C                   PARM                    @ljur12           2
     C                   PARM                    LDES             40
     C                   PARM                    RMVCODE           6
 3b  C                   IF         @LJUR1+@LJUR2+@LJUR3 <> ' '
 4b  C                   IF         @LJUR1 <> LJR1
     C                   EVAL       *IN31 = *ON
     C                   MOVE      'Y'           LOCERR
 4e  C                   ENDIF
 4b  C                   IF         @LJUR2 <> LJR2
     C                   EVAL       *IN32 = *ON
     C                   MOVE      'Y'           LOCERR
 4e  C                   ENDIF
 4b  C                   IF         @LJUR3 <> LJR3
     C                   EVAL       *IN33 = *ON
     C                   MOVE      'Y'           LOCERR
 4e  C                   ENDIF
 4b  C                   IF         @LJUR4 <> LJR4
     C                   EVAL       *IN34 = *ON
     C                   MOVE      'Y'           LOCERR
 4e  C                   ENDIF
 4b  C                   IF         @LJUR5 <> LJR5
     C                   EVAL       *IN35 = *ON
     C                   MOVE      'Y'           LOCERR
 4e  C                   ENDIF
 4b  C                   IF         @LJUR6 <> LJR6
     C                   EVAL       *IN36 = *ON
     C                   MOVE      'Y'           LOCERR
 4e  C                   ENDIF
 4b  C                   IF         @LJUR7 <> LJR7
     C                   EVAL       *IN37 = *ON
     C                   MOVE      'Y'           LOCERR
 4e  C                   ENDIF
 4b  C                   IF         @LJUR8 <> LJR8
     C                   EVAL       *IN38 = *ON
     C                   MOVE      'Y'           LOCERR
 4e  C                   ENDIF
 4b  C                   IF         @LJUR9 <> LJR9
     C                   EVAL       *IN39 = *ON
     C                   MOVE      'Y'           LOCERR
 4e  C                   ENDIF
     c                   movea     @LJUR         LJR
     c                   move      @LCOD         LCOD
 3e  C                   ENDIF
 3b  C                   IF        LOCERR = 'Y'
       JURMESSAGE ='JURISDICTIONS HAVE CHANGED, CHECK PERCENTAGES AND RECALC';
 3e  C                   ENDIF
 3b  C                   If        RMVCODE = 'REMOVE'
     C                   EVAL      LCOD  = *BLANKS
         JURMESSAGE ='LOCATION CODE REMOVED';
     c                   eval      *in15 = *on
 3e  C                   Endif
     C                   ENDSR
     *
      /EJECT
     *
     *=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-*
     * get OWNER XREF FOR LOUSIANNA
     *=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-*
     C     getlouisown   BEGSR
     * lousianna special owner

            *IN88 = *off;
            if job = 900700 or job = 901900
            or job = 900700 or job = 901900
            or job = 902100 or job = 902300
            or job = 904100 or job = 904500
            or job = 908300 or job = 908700
            or job = 909700 or job = 909900
            or job = 910100 or job = 907500;
            lowner = 0;
            *IN88 = *on;
            if owner <> 0;
            chain(E) (job:owner) mnoxolf;
            if not %found(mnoxolf);
            lowner = 0;
             endif;
             endif;
       endif;
     C                   ENDSR
      /EJECT
     *
     *=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-*
     * UPDATE OWNER XREF FOR LOUSIANNA
     *=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-*
     C     UPDOWNXREF    BEGSR
     * lousianna special owner
            *IN88 = *off;
            @lowner = lowner;
            if job = 900700 or job = 901900
            or job = 900700 or job = 901900
            or job = 902100 or job = 902300
            or job = 904100 or job = 904500
            or job = 908300 or job = 908700
            or job = 909700 or job = 909900
            or job = 910100 or job = 907500;
            *IN88 = *on;
            if owner <> 0;
            chain(E) (job:owner) mnoxolf;
            if not %found(mnoxolf);
            lowner = @lowner;
            write mnoxpr;
            else;
            lowner = @lowner;
            update mnoxpr;
             endif;
             endif;
             endif;
     C                   ENDSR
     *=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-*
     *
      /EJECT
     *
     C     ATOD          BEGSR
     *=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-*
     * CONVERT ALPHA TO DECIMAL
     *=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-*
     *
     C                   EVAL      *IN70 = *OFF
     c                   eval      lsetyp = 0
 3b  c                   select
 3x  c     inta          wheneq    'RI'
     c                   eval      lsetyp = 1
 3x  c     inta          wheneq    'OR'
     c                   eval      lsetyp = 2
 3x  c     inta          wheneq    'OP'
     c                   eval      lsetyp = 3
 3x  c     inta          wheneq    'WI'
     c                   eval      lsetyp = 4
 3x  c     inta          wheneq    'RA'
     c                   eval      lsetyp = 5
 3x  c                   other
     C                   EVAL      *IN70 = *On
 3e  c                   endsl
     C                   ENDSR                                                             >><<
     *
     ************************************************************
     C     SETLIB        BEGSR
     C                   MOVE      JOB           COMNUM            7
     C                   CLEAR                   LOOKON            7
     C                   CLEAR                   CURLIB           10
     *                  call      'FINDLIB'
     *                  parm                    comnum            7
     *                  parm                    lookon            7
     *    curlib        parm      *blanks       curlib           10
     *                  PARM      'N'           DSPIT             1
     *                  MOVE      CURLIB        LIB
     C                   ENDSR
     ******************************************************************
      /EJECT
     c     rolldn        begsr
 3b  C                   IF        *IN11 = *ON
 4b  C                   IF        *IN15 = *ON
     C                   EXSR      SAVE1
     C                   UPDATE    MNOPR                                         MNOPR      Out
     C                   EXSR      chgcomm
     c   64              update    mnopr3
     C                   EXSR      SAVE2
     C                   EXSR      LOWUP                                        <> LOWUP
 4x  C                   ELSE
 5b  C                   IF        LOCKO = 'Y'
     C                   EXCEPT    RELO                                          REOLRO     Out
 5e  C                   ENDIF
 4e  C                   ENDIF
     C                   MOVE      'N'           LOCKO
     *
 4b  c                   select
 4x  C     ovwtyp        wheneq    'OWN#'
     C     job           readpe    mnolfo                                 13    BEG OF FILE
 5b  C                   if        *in13 = *on
     C     ownkey        chain     mnolfo                             13
 5e  C                   endif
     **
 4x  C     ovwtyp        wheneq    'NAME'
     C     job           readpe    mnolfn                                 13    BEG OF FILE
 5b  C                   if        *in13 = *on
     C     nmekey        chain     mnolfn                             13
 5e  C                   endif
     **
 4x  C     ovwtyp        wheneq    'AGT#'
     C     job           readpe    mnolfan                                13    BEG OF FILE
 5b  C                   if        *in13 = *on
     C     agtky2        chain     mnolfan                            13
 5e  C                   endif
     **
 4e  C                   endsl
     *
     C                   EXSR      CHKAUT
     *
 3e  C                   ENDIF
     c                   endsr
     ****************************************************
     c     rollup        begsr
     *  ROLL UP - NEXT RECORD
 3b  C                   IF        *IN10 = *ON
 4b  C                   IF        *IN15 = *ON
     C                   EXSR      SAVE1
     C                   UPDATE    MNOPR                                         MNOPR      Out
     C                   EXSR      chgcomm
     c   64              update    mnopr3
     C                   EXSR      SAVE2
     C                   EXSR      LOWUP                                        <> LOWUP
 4x  C                   ELSE
 5b  C                   IF        LOCKO = 'Y'
     C                   EXCEPT    RELO                                          REOLRO     Out
 5e  C                   ENDIF
 4e  C                   ENDIF
     C                   MOVE      'N'           LOCKO
     *
 4b  c                   select
 4x  C     ovwtyp        wheneq    'OWN#'
     C     JOB           READE     MNOLFO                                 14    BEG OF FILE
 5b  C                   IF        *IN14 = *ON
     C     OWNKEY        CHAIN     MNOLFO                             14
 5e  c                   endif
     *
 4x  C     ovwtyp        wheneq    'NAME'
     C     JOB           READE     MNOLFN                                 14    BEG OF FILE
 5b  C                   IF        *IN14 = *ON
     C     NMEKEY        CHAIN     MNOLFN                             14
 5e  c                   endif
     *
 4x  C     ovwtyp        wheneq    'AGT#'
     C     JOB           READE     MNOLFAN                                14    BEG OF FILE
 5b  C                   IF        *IN14 = *ON
     C     AGTKY2        CHAIN     MNOLFAN                            14
 5e  C                   ENDIF
 4e  C                   ENDSL
     *
     C                   EXSR      CHKAUT
     *
 3e  C                   ENDIF
     c                   endsr
     *******************************************************
     *
     C     DTOA          BEGSR                                                  DTOA       <<>>
     *
     *=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-*
     * CONVERT DECIMAL TO ALPHA
     *=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-*
 3b  c                   select
 3x  C     lsetyp        wheneq    1
     C                   MOVE      'RI'          INTA
     **
 3x  C     lsetyp        wheneq    2
     C                   MOVE      'OR'          INTA
     **
 3x  C     lsetyp        wheneq    3
     C                   MOVE      'OP'          INTA
     **
 3x  C     lsetyp        wheneq    4
     C                   MOVE      'WI'          INTA
     **
 3x  C     lsetyp        wheneq    5
     C                   MOVE      'RA'          INTA
 3e  C                   ENDSL
     C                   ENDSR

      /EJECT

     C     APPSR         BEGSR

     *=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-*
     * GET APPRAISAL INFORMATION
     *=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-*

     *  GET RRC NUMBERS FROM APPRAISAL FILE
     C                   EVAL      RC = 0
     C                   EVAL      R# = 0

     C                   EVAL      *IN98 = *OFF
     C     LSEKEY        SETLL     MNALFLR
 3b  C                   DOW       *IN98 = *OFF
     C     LSEKEY        READE     MNALFLR                                98
 4b  C                   IF        *IN98 = *OFF
     C                             AND R# < 18
     C                   ADD       1             R#
     C                   EVAL      RC(R#) = ARRC
 4x  C                   ELSE
     C                   EVAL      *IN98 = *ON
 4e  C                   ENDIF
 3e  C                   ENDDO

     *  GET ANY UNIT'S THIS LEASE IS A PART OF
     C                   EVAL      UC = 0
     c                   z-add     0             urc#              3 0
     c                   clear                   urc

     C                   EVAL      *IN98 = *OFF
     C     LSEKEY        SETLL     MNULFL
 3b  C                   DOW       *IN98 = *OFF
     C     LSEKEY        READE     MNULFL                                 98
 4b  C                   IF        *IN98 = *OFF

     C                   EVAL      @B = 1
     C     LSE#          LOOKUP    UC(@B)                                 21
 5b  C                   IF        *IN21 = *OFF
     C                   EVAL      @B = 1
     C     *ZEROS        LOOKUP    UC(@B)                                 21
 5e  C                   ENDIF
 5b  C                   IF        *IN21 = *ON
     C                   EVAL      UC(@B) = UNIT
     ** COMMENTED GETUNRRC OUT BECAUSE IT CAUSES MNDR03 TO LOOSE THE ADDITIONAL
     ** UNIT NUMBERS
     ** IT APPEARS THAT IN 2015 VERL TRIED TO GET ALL UNITS FOR AN OWNER TO SHOW
     ** UP ON MNSF03 BUT IT DOESNT APPEAR TO WORK.

     *************      exsr      getunrrc
 5e  C                   ENDIF

 4x  C                   ELSE
     C                   EVAL      *IN98 = *ON

 4e  C                   ENDIF
 3e  C                   ENDDO

     ** vb 09/14
     c     dowkey        chain(E)  mnxpf
 3b  c                   if        not %found(mnxpf)
     c                   clear                   ageo
 3e  c                   endif
     c                   eval      rrclin = %trim(%editc(rc(1):'Z')) + ' ' +
     c                                 %trim(%editc(rc(2):'Z')) + ' ' +
     c                                 %trim(%editc(rc(3):'Z')) + ' ' +
     c                                 %trim(%editc(rc(4):'Z')) + ' ' +
     c                                 ' UN-' +
     c                                 %trim(%editc(uc(1):'Z')) + ' ' +
     c                                 %trim(%editc(urc(1):'Z')) + ' ' +
     c                                 %trim(%editc(urc(2):'Z')) + ' ' +
     c                                 %trim(%editc(urc(3):'Z')) +
     c                                 ' ACCT#: ' + %trim(ageo)
     ** vb 09/14
     C                   ENDSR
     *
      /EJECT
     ***********************************************
     c     getunrrc      begsr
     c     unrcke        klist
     c                   kfld                    job
     c                   kfld                    uc(@B)
 3b  c                   if        uc(@b) = 0
 LV  c                   leavesr
 3e  c                   endif
     C     unrcke        SETLL     MNALFLR
 3b  C                   DOW       *IN98 = *OFF
     C     unrcke        READE     MNALFLR       dtli                     98
 4b  C                   IF        *IN98 = *OFF
     C                             AND uRc# < 5
     C                   ADD       1             urc#
     C                   EVAL      uRC(uRc#) = dtli.arrc
 4x  C                   ELSE
     C                   EVAL      *IN98 = *ON
 4e  C                   ENDIF
 3e  C                   ENDDO
     c                   endsr
     *
     C     DUPLSE        BEGSR
     *
     *=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-*
     * DUPLICATE A LEASE
     *=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-*
     *
     C                   EVAL      DUPFLS = SVLSE#
     C                   EVAL      DUPTLS = DUPLS#
     C                   EVAL      JOBSAVE = JOB
     C                   EVAL      LSE#SAVE  = LSE#
     *
     C     DUPSTR        TAG
     *
     *  CLEAR WORK FILE MNDWPF1
     C                   CLOSE     MNDWPF1                              90
     C                   CALL      'QCAEXEC'
     C                   PARM                    PARM9
     C                   PARM      14            PARM2
     C                   OPEN      MNDWPF1                              90
     *
     *  LOAD WORK FILE MNDWPF1 WITH LEASE TO DUP
     C                   EVAL      LSE# = SVLSE#
     C                   EVAL      *IN98 = *OFF
     C     LSEKEY        SETLL     MNDLFL
 3b  C                   DOW       *IN98 = *OFF
     C     LSEKEY        READE     MNDLFL                                 98
 4b  C                   IF        *IN98 = *OFF
     C                   EVAL      LSE# = DUPLS#
 5b  C                   IF        DUP2ALT = 'Y'
     C                   EVAL      LSE#  = ALSE#
 5e  C                   ENDIF
     C                   EVAL      SVSOPR = SOPR
     C                   WRITE     MNDWPR1
     C                   EVAL      LSE# = SVLSE#
 4e  C                   ENDIF
 3e  C                   ENDDO
     *
     C                   EVAL      SOPSAV = *ZEROS
     C                   EVAL      LSTSAV = *ZEROS
     C                   EVAL      OWNSAV = *ZEROS
     C                   EVAL      NAMSAV = *BLANKS
     *
     *  START DUP PROCESS
     C     DOWVU2        TAG
     *
     C                   EVAL      SOPPRV = 0
     C                   EVAL      LSTPRV = 0
     C                   EVAL      DNMPRV = *BLANK
     C                   EVAL      OWNPRV = 0
     *
     *  CLEAR WORK FILE MNDPF1
     C                   CLOSE     MNDPF1                               90
     C                   CALL      'QCAEXEC'
     C                   PARM                    PARM1
     C                   PARM      14            PARM2
     C                   OPEN      MNDPF1                               90
     *
     *  SETUP TEMPORARY FILE
     *
     *      THIS MUST BE DONE BECAUSE IN THE DISK FILE THE OWNERS
     *      ON A LEASE ARE KEYED BY OWNER# AND THE USER NEEDS TO
     *      VIEW THEM IN OWNER NAME ORDER......BECAUSE OF DATABASE
     *      CONSIDERATIONS THE OWNER NAME IS NOT KEPT IN THE D/O RECORD.
     *
     C                   EVAL      TOTOWN = *ZEROS
     C                   EVAL      TOTINT = *ZEROS
     C                   EVAL      DUPITM = *ZEROS
     C                   EVAL      DUPINT = *ZEROS
     C                   EVAL      LSE# = DUPLS#
     C                   EVAL      *IN98 = *OFF
     C     LSEKEY        SETLL     MNDWPF1
 3b  C                   DOW       *IN98 = *OFF
     C     LSEKEY        READE     MNDWPF1                                98
 4b  C                   IF        *IN98 = *OFF
     C                             AND MNDDEL = *BLANKS
     *
     C                   EVAL      *IN22 = *OFF
     C     OWNKEY        CHAIN     MNOLFO                             22
 5b  C                   IF        *IN22 = *OFF
     C                   EXSR      CHKAUT
     *
 6b  C                   IF        CITY16 <> *BLANKS
     C                             OR STE2A <> *BLANKS
     C                   MOVEL     CITY16        AD3
 6x  C                   ELSE
     C                   MOVEL     ALTCSZ        AD3
 6e  C                   ENDIF
     *
     C                   ADD       1             TOTOWN
     C                   ADD       DECINT        TOTINT
     C                   ADD       1             DUPITM
     C                   ADD       DECINT        DUPINT
     C                   EVAL      NEWINT = DECINT
     *
     C                   WRITE     MNDPR1
 5e  C                   ENDIF
 4e  C                   ENDIF
 3e  C                   ENDDO
     *
     C                   eval      dup2alt = 'N'
     *
     *  READ RECORDS ALPHABETICALLY FROM WORK FILE & LOAD SUBFILE
     C     ROLDO2        TAG
     *
     C                   EVAL      *IN42 = *OFF
     C                   EVAL      *IN43 = *OFF
     C                   EVAL      *IN45 = *OFF
     C                   EVAL      *IN45 = *ON
     C                   WRITE     MNSF09A                              91
     C                   EVAL      *IN45 = *OFF
     C                   Z-ADD     *ZEROS        OWNRRN               4242
     *
     C                   EVAL      *IN98 = *OFF
 3b  C                   DO        14            A
     C                   READ      MNDPF1                                 98
 4b  C                   IF        *IN98 = *ON
     C                   EVAL      A = 14
 4x  C                   ELSE
     *
     C                   EXSR      DTOA
     C                   EVAL      DELCOD = *BLANKS
     C                   EVAL      SCRINT = NEWINT
     *
     C                   Z-ADD     A             OWNRRN               4242
     C                   WRITE     MNSF10A                                95
     *
 4e  C                   ENDIF
 3e  C                   ENDDO
     *
     *  SEE IF 'MORE' SHOULD BE DISPLAYED
 3b  C                   IF        *IN42 = *ON
     C                   READ      MNDPF1                                 38
 3e  C                   ENDIF
     *
     C     NOORR2        TAG
     *
     C                   EVAL      *IN43 = *ON
     C                   EXFMT     MNSF09A
     C                   EVAL      *IN06 = *OFF
     C                   EVAL      *IN09 = *OFF
     C                   EVAL      *IN71 = *OFF
     C     *INKA         CABEQ     *ON           FMEND
     C     *INKB         CABEQ     *ON           KEYLSE
     *
     *  INKC = NO DUP - RETURN TO HEADER SCREEN
 3b  C                   IF        *INKC = *ON
     *
     *  CLEAR WORK FILE MNDWPF1
     C                   CLOSE     MNDWPF1                              90
     C                   CALL      'QCAEXEC'
     C                   PARM                    PARM9
     C                   PARM      14            PARM2
     C                   OPEN      MNDWPF1                              90
     *
     C                   EVAL      LSE# = SVLSE#
 GO  C                   GOTO      LSEAGN
 3e  C                   ENDIF
     *
     *  INKE = RESTART - START OVER
     C     *INKE         CABEQ     *ON           DUPSTR
     *
     *  IF NEW LEASE NUMBER IS NOT TO BE COMPUTER GENERATED
 3b  C                   IF        DUPTLS <> DUPLS#
     C                   EVAL      *IN23 = *OFF
     C                   EVAL      *IN39 = *OFF
     C                   EVAL      *IN47 = *OFF
     *
     *  VALIDATE LEASE NUMBER EXISTS
 4b  C                   IF        DUPTLS > *ZEROS
     C                   EVAL      *IN39 = *OFF
     C     DPLKEY        CHAIN     MNHLFL                             39
 5b  C                   IF        *IN39 = *OFF
 6b  C                   IF        *IN39 = *OFF
     C                   EXCEPT    RELH
 6e  C                   ENDIF
     *
     *  LEASE EXISTS, VALIDATE NO D/O'S EXIST
     C                   EVAL      *IN23 = *OFF
     C                   EVAL      *IN47 = *OFF
     C     DPLKEY        CHAIN     MNDLFL                             23
 6b  C                   IF        *IN23 = *OFF
     C                   EXCEPT    RELDL
 6e  C                   ENDIF
 6b  C                   IF        *IN23 = *OFF
     C                   EVAL      *IN47 = *ON
 6e  C                   ENDIF
 5e  C                   ENDIF
     *
 4x  C                   ELSE
     C                   EVAL      *IN39 = *ON
 4e  C                   ENDIF
     *
     C     *IN39         CABEQ     *ON           NOORR2
     C     *IN47         CABEQ     *ON           NOORR2
 3e  C                   ENDIF
     *
     *  READ ANY CHANGED RECORDS
     C                   EVAL      *IN97 = *OFF
 3b  C                   DOW       *IN97 = *OFF
     C                   READC     MNSF10A                                97
 4b  C                   IF        *IN97 = *OFF
 5b  C                   IF        *IN06 = *OFF
     C                   EVAL      *IN06 = *ON
 5e  C                   ENDIF
     C                   EVAL      *IN09 = *OFF
     C                   EVAL      *IN71 = *OFF
     C                   EVAL      LSE# = DUPLS#
     *
 5b  C                   SELECT
     *
     *  IF CHANGING INTEREST
 5x  C                   WHEN      SCRINT <> NEWINT
     C                   EVAL      DELCOD = *BLANKS
     *
 6b  C                   IF        NEWINT <= 0
     C                             OR NEWINT > 1
     C                   EVAL      *IN71 = *ON
     C                   UPDATE    MNSF10A
     *
 6x  C                   ELSE
     *
     C                   EVAL      *IN23 = *OFF
     C     DOWKEY        CHAIN     MNDWPF1                            23
     C                   EVAL      DECINT = NEWINT
     C                   UPDATE    MNDWPR1
     *
     *  NEWINT IS IN MNDPF1 SO WE'LL USE DECINT FROM ABOVE
     C                   EVAL      *IN23 = *OFF
     C     DNMKEY        CHAIN     MNDPF1                             23
     C                   EVAL      NEWINT = DECINT
     C                   UPDATE    MNDPR1
     *
     C                   SUB       SCRINT        DUPINT
     C                   EVAL      SCRINT = NEWINT
     C                   ADD       NEWINT        DUPINT
     C                   UPDATE    MNSF10A
 6e  C                   ENDIF
     *
     *  IF DELETING RECORD
 5x  C                   WHEN      DELCOD <> *BLANK
     *
     C                   EVAL      *IN23 = *OFF
     C     DOWKEY        CHAIN     MNDWPF1                            23
 6b  C                   IF        *IN23 = *OFF
     C                   DELETE    MNDWPR1
     C                   SUB       1             DUPITM
     C                   SUB       SCRINT        DUPINT
     C                   EVAL      *IN09 = *ON
     C                   EVAL      *IN23 = *OFF
     C     DNMKEY        CHAIN     MNDPF1                             23
     C                   DELETE    MNDPR1
 6x  C                   ELSE
     C                   EVAL      *IN09 = *OFF
 6e  C                   ENDIF
     C                   UPDATE    MNSF10A
     *
     *  OTHERWISE,
 5x  C                   OTHER
     *
     C                   EVAL      *IN09 = *OFF
     C                   EVAL      *IN71 = *OFF
     C                   UPDATE    MNSF10A
     *
 5e  C                   ENDSL
     *
     *  NEXT CHANGED RECORD
 4e  C                   ENDIF
 3e  C                   ENDDO
     *
     *  WERE RECORDS CHANGED?
     C     *IN06         CABEQ     *ON           NOORR2
     *
     *  ROLL FORWARD
 3b  C                   IF        *IN10 = *ON
     *
     C                   EVAL      *IN93 = *OFF
     C     14            CHAIN     MNSF10A                            93
 4b  C                   IF        *IN93 = *OFF
     C                   EVAL      LSE# = DUPLS#
     C     DNMKEY        SETGT     MNDPF1
 GO  C                   GOTO      ROLDO2
 4x  C                   ELSE
     C                   EVAL      *IN93 = *OFF
     C     1             CHAIN     MNSF10A                            93
 5b  C                   IF        *IN93 = *OFF
     C                   EVAL      LSE# = DUPLS#
     C     DNMKEY        SETLL     MNDPF1
 GO  C                   GOTO      ROLDO2
 5x  C                   ELSE
     C     *LOVAL        SETLL     MNDPF1
 GO  C                   GOTO      ROLDO2
 5e  C                   ENDIF
 4e  C                   ENDIF
     *
 3e  C                   ENDIF
     *
     *  ROLL BACKWARD
 3b  C                   IF        *IN11 = *ON
     *
     C                   EVAL      *IN93 = *OFF
     C     1             CHAIN     MNSF10A                            93
 4b  C                   IF        *IN93 = *OFF
     C                   EVAL      LSE# = DUPLS#
     C     DNMKEY        SETLL     MNDPF1
 5b  C                   DO        14            X
     C                   READP     MNDPF1                                 98
 6b  C                   IF        *IN98 = *ON
     C                   EVAL      X = 14
 6e  C                   ENDIF
 5e  C                   ENDDO
 5b  C                   IF        *IN98 = *OFF
     C     DNMKEY        SETLL     MNDPF1
 5e  C                   ENDIF
 5b  C                   IF        *IN98 = *ON
     C     *LOVAL        SETLL     MNDPF1
 5e  C                   ENDIF
 GO  C                   GOTO      ROLDO2
 4x  C                   ELSE
     C     *LOVAL        SETLL     MNDPF1
 GO  C                   GOTO      ROLDO2
 4e  C                   ENDIF
     *
 3e  C                   ENDIF
     *
     *  INKV = CREATE DUP LEASE
 3b  C                   IF        *INKV = *ON
     *
 4b  C                   IF        DUP2ALT = 'Y'
     C                   EVAL      NEWLSE = HALSE#
     C                   EVAL      DUPLS# = HALSE#
 4e  c                   endif
     *
     *  IF NOT COMPUTER GENERATED LSE#
 4b  C                   IF        DUPTLS = DUPLS#
     *
     C                   EVAL      *IN21 = *OFF
     C                   EVAL      LSE# = SVLSE#
     C     LSEKEY        CHAIN     MNHLFL                             21
     C     JOB           CHAIN     MNNPF                              21
     *
     C                   ADD       1             NLSE#
     C                   UPDATE    MNNPR
     C                   EVAL      NEWLSE = NLSE#
     C                   EVAL      LSE# = NEWLSE
     C                   WRITE     MNHPR
     *
 4x  C                   ELSE
     *
     C                   EVAL      NEWLSE = DUPTLS
     *
 4e  C                   ENDIF
     *
 4b  C                   IF        DUP2ALT = 'Y'
     C                   EVAL      NEWLSE = HALSE#
 4e  c                   endif
     *
     *  READ THRU WORK RECORDS TO DUPLICATE
     C                   EVAL      LSE# = DUPLS#
 4b  C                   IF        DUP2ALT = 'Y'
     C     *LOVAL        SETLL     MNDPF1
 4x  C                   ELSE
     C     LSEKEY        SETLL     MNDWPF1
 4e  c                   endif
     C                   EVAL      *IN98 = *OFF
 4b  C                   DOW       *IN98 = *OFF
 5b  C                   IF        DUP2ALT = 'Y'
     C                   READ      MNDPF1                                 98
     C     DOWKEY        CHAIN     MNDWPF1                            98
 5x  C                   ELSE
     C                   EVAL      LSE# = DUPLS#
     C     LSEKEY        READE     MNDWPF1                                98
 5e  c                   endif
 5b  C                   IF        *IN98 = *OFF
     c                   eval      *in87 = *off
     * ========================================================
 6b  C                   IF        DUP2ALT = 'Y'
     *    LSEKEY        CHAIN(N)  MNHLFL
     C     OWNKEY        CHAIN     MNOLFO                             87
 7b  C                   IF        HAJOB# <> 0 AND HALSE# <> 0
     C     LSEKEY        CHAIN(N)  MNHLFL
     C                   CALL      'MNOWFMW2'
     C                   PARM                    HAJOB#
     C                   PARM                    JOB
     C     OWNER         PARM      *ZEROS        OWNIN
     C                   PARM                    name30
     C                   PARM      'Y'           SELOWN
     C                   PARM      9             STRROW
     C                   PARM      3             STRCOL
     C                   PARM                    CARE
     C                   PARM                    STREET
     C                   PARM                    ALTCSZ
     C                   PARM                    CITY16
     C                   PARM                    STE2A
     C                   PARM                    ZIPA
     C                   PARM                    PLUS4
     C                   PARM                    AGENT#
     C                   PARM                    REND
     C                   PARM                    SORT
     C                   PARM                    DVAMT
     C                   PARM                    MNOXC1
     C                   PARM                    MNOXC2
 7e  C                   ENDIF
     C                   CLEAR                   M#SNDFILE
     C                   CLEAR                   M#EMLADR
     C                   eval      duptls = halse#
     C                   eval      job    = hajob#
 6e  C                   ENDIF
     * ========================================================
     C                   EVAL      LSE# = NEWLSE
     C                   EVAL      SVSOPR = SOPR
 6b  C                   IF        DUP2ALT = 'Y'
     C     HAJOB#        CHAIN     MNNPF                              21
 6x  C                   ELSE
     C     JOB           CHAIN     MNNPF                              21
 6e  C                   ENDIF
     C                   ADD       1             NPAR#
     C                   UPDATE    MNNPR
     C                   EVAL      PARID = NPAR#
     *                      tarrant county
 6b  c                   if        job = 122000
     c                   move      'N'           mndxc1
 6e  c                   endif
     *                      end tarrant county
     C                   EVAL      DUSRDT = UDATE2
     C                   MOVE      USER          DUSRID
     C  n87              WRITE     MNDPR
     C                   WRITE     MNOPR                                87
     C                   EXSR      chgcomm
     *Create internet password
     c                   call      'UPDMNOPF6C'
     c                   parm                    job
     c                   parm                    owner
     c   64              write     mnopr3
     *                  if        arkvsw = 'Y'
     *                  eval      flag = ' ' + shosel
     *                  call      'MNARCV003'
     *                  parm                    job
     *                  parm                    lse#
     *                  parm                    sopr
     *                  parm                    lsetyp
     *                  parm                    owner
     *                  parm                    flag
     *                  parm                    codate
     *                  parm                    cotime
     *                  parm                    coyrap
     *                  parm                    cocsq#
     *                  parm                    svpdec
     *                  eval      shosel = 'N'
     *                  endif
     *
     *  WRITE OWNERSHIP ADD RECORD
     C                   EXSR      WOCAOW
     *
     *  NEXT WORK RECORD
     *                  EVAL      LSE# = DUPLS#
     C                   EVAL      JOB = JOBSAVE
     C                   EVAL      JOBNO = JOBSAVE
     C                   EVAL      LSE# = LSE#SAVE
 5e  C                   ENDIF
 4e  C                   ENDDO
     *
     *
     *  CLEAR WORK FILE MNDWPF1
     *
     C                   CLOSE     MNDWPF1                              90
     C                   CALL      'QCAEXEC'
     C                   PARM                    PARM9
     C                   PARM      14            PARM2
     C                   OPEN      MNDWPF1                              90
     *
     C                   EVAL      *IN19 = *ON
     *                  EVAL      LSE# = DUPLS#
     *                  EVAL      JOB  = JOBSAVE
     C                   EVAL      LSE# = LSE#SAVE
 GO  C                   GOTO      LSEBGN
 3e  C                   ENDIF                                                  END KV=1
     *
     *  CATCH-ALL - RELOAD CHANGED RECORDS
     C                   EVAL      JOB = JOBSAVE
     C                   EVAL      JOBNO = JOBSAVE
     C                   EVAL      LSE# = LSE#SAVE
 GO  C                   GOTO      NOORR2
     *
     C                   ENDSR
     *
      /EJECT
     *
     C     SUMSR         BEGSR                                                  SUMSR      <<>>
     *
     *=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-*
     * LEASE VALUE SUMARY
     *=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-*
     *
     C                   EVAL      LJRI = 0
     C                   EVAL      LJWI = 0
     C                   EVAL      TOTWV = 0
     C                   EVAL      TOTRV = 0
     *
     C     LSEKEY        SETLL     MNALFLR
     C     LSEKEY        READE     MNALFLR                                98     MNALFLR     In
 3b  C                   DOW       *IN98 = *OFF
     C                   ADD       TWIVL         TOTWV
     C                   ADD       TRIVL         TOTRV
     C     LSEKEY        READE     MNALFLR                                98     MNALFLR     In
 3e  C                   ENDDO
     *
     C                   EVAL      LSESAV = LSE#
     C     LSEKEY        SETLL     MNULFL
     C     LSEKEY        READE     MNULFL                                 97     MNULFL      In
     *
     * UNIT APPRAISAL RECORD
 3b  C                   DOW       *IN97 = *OFF
     C                   EVAL      TUWV = 0
     C                   EVAL      TURV = 0
     C     UNTKEY        SETLL     MNALFLR
     C     UNTKEY        READE     MNALFLR                                96     MNALFLR     In
     *
     * ADD VALUES UP
 4b  C                   DOW       *IN96 = *OFF
     *
     C                   ADD       TWIVL         TUWV
     C                   ADD       TRIVL         TURV
     *
     C     UNTKEY        READE     MNALFLR                                96     MNALFLR     In
 4e  C                   ENDDO
     *
     C                   MULT(H)   PWIVAL        TUWV
     C                   MULT(H)   PRIVAL        TURV
     *
     * ADD FACTORED VALUES TO TOTALS
     C                   ADD       TUWV          TOTWV
     C                   ADD       TURV          TOTRV
     *
     C                   EVAL      LSE# = LSESAV
     C     LSEKEY        READE     MNULFL                                 97     MNULFL      In
 3e  C                   ENDDO
     *
 3b  C                   DO        9             X
 4b  C                   IF        LJR(X) <> *BLANK
     C     TOTWV         MULT(H)   LJP(X)        LJWI(X)
     C                   ADD       5             LJWI(X)
     C                   MOVE      '0'           LJWI(X)
     C     TOTRV         MULT(H)   LJP(X)        LJRI(X)
     C                   ADD       5             LJRI(X)
     C                   MOVE      '0'           LJRI(X)
 4e  C                   ENDIF
 3e  C                   ENDDO
     *
     * Flip Year Left to Right
     * Flip year from YYYYMMDD (8) to MMDDYYYY (8) for Output
     C                   MOVE      HUSRDT        Y2KYMD
     C                   EVAL      Y2KYYR = Y2KYYL
     C                   MOVE      Y2KMDY        Y2K005
     *
     C                   EXFMT     MNDR04                                        MNDR04     I/O
     C     *INKA         CABEQ     *ON           FMEND
     C     *INKB         CABEQ     *ON           KEYLSE
 GO  C                   GOTO      LSEAGN
     *
     C                   ENDSR                                                             >><<
     *
      /EJECT
     *
     C     LOWUP         BEGSR                                                  LOWUP      <<>>
     *
     *=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-*
     *  RECORD LAST OWNER CHANGE
     *=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-*
     *
     C                   EVAL      *IN52 = *ON
     C                   EVAL      LASTOW = OWNER
     C                   MOVE      NAME30        LASTNA
     C                   ENDSR                                                             >><<
     *
      /EJECT
     *
     C     LLSUP         BEGSR                                                  LLSUP      <<>>
     *
     *=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-*
     *  RECORD LAST LEASE CHANGE
     *=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-*
     *
     C                   EVAL      *IN53 = *ON
     C                   EVAL      *IN54 = *OFF
     C                   EVAL      LASTLS = LSE#
     C                   ENDSR                                                             >><<
     *
      /EJECT
     *
     C     LDOUP         BEGSR                                                  LDOUP      <<>>
     *
     *=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-*
     *  RECORD LAST DO CHANGE
     *=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-*
     *
     C                   EVAL      *IN52 = *ON
     C                   EVAL      *IN53 = *ON
     C                   EVAL      *IN54 = *ON
     C                   EVAL      LASTLS = LSE#
     C                   MOVE      INTA          LASTIN
     C                   EVAL      LASTOW = OWNER
 3b  C                   IF        NEWNAM = *BLANKS
     C                   MOVEL     NAME30        LASTNA
 3x  C                   ELSE
     C                   MOVE      NEWNAM        LASTNA
 3e  C                   ENDIF
     *
     C                   ENDSR                                                             >><<
     *
      /EJECT
     *
     C     PROTME        BEGSR
     *
     *=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-*
     *  ENSURE TIME IS DIFFERENT
     *=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-*
     *
     C                   TIME                    COTIME
 3b  C                   DOW       COTIME = STRTME
     C                   TIME                    COTIME
     C                   ADD       1             COTIME
 3e  C                   ENDDO
     C                   EVAL      STRTME = COTIME
     *
     C                   ENDSR                                                             >><<
      /EJECT
     *
     *=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-*
     *  WRITE ORIGINAL OWNER RECORD TO CHANGE FILE
     *=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-*
     *
     C     SAVE1         BEGSR
     *
     *  GET ORIGINAL RECORD
     C                   EVAL      *IN22 = *OFF
     C     OWNKEY        CHAIN     MNOLFO                             22
     C                   EXSR      CHKAUT
     *
     *  ENSURE TIME IS DIFFERENT
     C                   TIME                    MPF3TM
 3b  C                   DOW       MPF3TM = @PF3TM
     C                   TIME                    MPF3TM
 3e  C                   ENDDO
     C                   EVAL      @PF3TM = MPF3TM
     *
     C                   EVAL      MNASEQ = 1
     ***        UDATE     MULT 10000.01  MPF3DT
     C     *DATE         MULT      10000.0001    MPF3DT
     C                   MOVEL     USER          MPF3US
     C                   WRITE     MNOPR2
     *
     *  READ SCREEN AGAIN
     C                   READ      MNDR02                                 22
     *
     C                   EVAL      AGENT# = SVAGENT#
     C                   MOVEL     SVREAS        REAS
     C                   EVAL      OUSRDT = UDATE2
     C                   MOVE      USER          OUSRID
     *   move cass mail data here
     c                   movel     svstrt        street
     c                   movel     svcity        city16
     c                   movel     svst          ste2a
     c                   movel     svzip         zipa
     c                   move      svzip         plus4
     c                   move      svcarr        musrc1
     c                   movel     svcarr        musrc2
     c                   move      svrte         musrc3
     c                   move      svacno        acctno
     c                   move      svgrup        grupno
     c                   move      svacno        hcadac
     c                   move      svgrup        hcadgr
     C     ENDSV1        ENDSR
      /EJECT
     *
     *=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-*
     *  WRITE CHANGED OWNER RECORD TO CHANGE FILE
     *=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-*
     *
     C     SAVE2         BEGSR
     *
     C                   EVAL      MNASEQ = 2
     C                   WRITE     MNOPR2
     *
     C     ENDSV2        ENDSR
      /EJECT
     *
     *=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-*
     *  WRITE ORIGINAL OWNER RECORD TO CHANGE FILE
     *=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-*
     *
     C     SAVE3         BEGSR
     *
     *  GET ORIGINAL RECORD
     C                   EVAL      *IN22 = *OFF
     C     OWNKEY        CHAIN     MNOLFO                             22
     C                   EXSR      CHKAUT
     *
     *  ENSURE TIME IS DIFFERENT
     C                   TIME                    MPF3TM
 3b  C                   DOW       MPF3TM = @PF3TM
     C                   TIME                    MPF3TM
 3e  C                   ENDDO
     C                   EVAL      @PF3TM = MPF3TM
     *
     C                   EVAL      MNASEQ = 1
     ***        UDATE     MULT 10000.01  MPF3DT
     C     *DATE         MULT      10000.0001    MPF3DT
     C                   MOVEL     USER          MPF3US
     C                   WRITE     MNOPR2
     *
     *  READ SCREEN AGAIN
     C                   READ      MNDR05                                 22
     *
     C                   EVAL      OUSRDT = UDATE2
     C                   MOVE      USER          OUSRID
     *
     C     ENDSV3        ENDSR
      /EJECT
     *
     *=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-*
     *  WRITE CHANGED OWNER RECORD TO CHANGE FILE
     *=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-*
     *
     C     SAVE4         BEGSR
     *
     C                   EVAL      MNASEQ = 2
     C                   WRITE     MNOPR2
     *
     C     ENDSV4        ENDSR
     *
      /EJECT
     *
     C     WOCSPL        BEGSR
     *
     *=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-*
     *  OWNERSHIP SPLITS
     *=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-*
     *
     *  ZERO/CLEAR/SETUP ARRAYS WHEN FIRST TIME ACCESS
 3b  C                   IF        SPLFLG = '0'
     C                   EVAL      SO = 0
     C                   EVAL      SI = 0
     C                   MOVEA     *ALL' '       ST
     C                   EVAL      SP = 0
     C                   EVAL      SVSO = 0
     C                   EVAL      SVSP = 0
 3e  C                   ENDIF
     C                   MOVE      '1'           SPLFLG
     *
     C                   EVAL      *IN06 = *OFF
     C                   EVAL      *IN70 = *OFF
     C                   EVAL      *IN12 = *OFF
     C                   EVAL      *IN72 = *OFF
     C                   EVAL      *IN73 = *OFF
     C                   EVAL      *IN38 = *OFF
     *
     *  SETUP ORIGINAL OWNER DISPLAY FIELDS
     C                   EVAL      OWNER = OWNHLD
     C     OWNKEY        CHAIN     MNOLFO                             21
 3b  C                   IF        *IN21 = *OFF
     C                   EXCEPT    RELO
     C                   MOVE      'N'           LOCKO
     C                   EXSR      CHKAUT
 3e  C                   ENDIF
     *
     C                   EVAL      DSPOWN = OWNER
     C                   MOVEL     NAME30        DSPN30
     C                   MOVEL     CARE          DSPCAR
     C                   MOVEL     STREET        DSPSTR
     C                   EVAL      DSPCSZ = *BLANKS
 3b  C                   IF        CTST30 <> *BLANKS
 4b  C                   IF        PLUS4 <> *BLANKS
     C                             AND PLUS4 <> '0000'
     C                   MOVE      '-'           ZDASH
 4x  C                   ELSE
     C                   EVAL      ZDASH = *BLANKS
 4e  C                   ENDIF
     C                   MOVE      CTST30        DSPCSZ
 3x  C                   ELSE
     C                   MOVE      ALTCSZ        DSPCSZ
 3e  C                   ENDIF
     *
     C                   EVAL      LSETYP = LSTHLD
     C     DOWKEY        CHAIN     MNDLFL                             21
 3b  C                   IF        *IN21 = *OFF
     C                   EXCEPT    RELDL
 3e  C                   ENDIF
     C                   EVAL      SVDECI = DECINT
     C                   EVAL      SVSOPR = SOPR
     *
     C                   EVAL      TSSOBF = *ZEROS
     C                   EVAL      TSSIBF = *ZEROS
     C                   EVAL      TSSPBF = *ZEROS
     C                   EVAL      TSSOAF = *ZEROS
     C                   EVAL      TSSIAF = *ZEROS
     C                   EVAL      TSSPAF = *ZEROS
     *
     *  IF PREVIOUS PERCENTAGE SPLITS WERE ENTERED, ADD THEM IN NOW
     C                   XFOOT     SVSP          SVSHRE
 3b  C                   IF        SVSHRE <> *ZEROS
     *
 4b  C                   DO        400           A
 5b  C                   IF        SVSO(A) <> *ZEROS
     C                             AND SVSP(A) <> *ZEROS
     *
     *  SEE IF SAVED OWNER EXISTS IN ARRAYS
     C                   EVAL      B = 1
     C     SVSO(A)       LOOKUP    SO(B)                                  21
 6b  C                   IF        *IN21 = *ON
     C                   EVAL      SP(B) = SVSP(A)
     C                   EVAL      SI(B) = *ZEROS
 6x  C                   ELSE
     C                   EVAL      B = 1
     C     *ZEROS        LOOKUP    SO(B)                                  21
 7b  C                   IF        *IN21 = *ON
     C                   EVAL      SO(B) = SVSO(A)
     C                   EVAL      ASO(B) = ASVSO(A)
     C                   EVAL      ST(B) = *BLANKS
     C                   EVAL      AST(B) = *BLANKS
     C                   EVAL      SP(B) = SVSP(A)
     C                   EVAL      SI(B) = *ZEROS
     C                   EVAL      OWNER = SVSO(A)
     C                   EVAL      AOWNER = ASVSO(A)
     C     OWNKEY        CHAIN     MNOLFO                             21
 8b  C                   IF        *IN21 = *OFF
     C                   EXSR      CHKAUT
     C                   MOVE      NAME30        ST(B)
 8e  C                   ENDIF
 8b  C                   IF        ASO(B) <> 0
     C                   Eval      *IN21 = *OFF
     C     #altown       chain     MNOLFO                             21
 9b  C                   If        *IN21 = *Off
     C                   Eval      ast(b) = name30
 9e  C                   Endif
 8e  C                   Endif
     * ADD ALT OWN HERE
     *
 7e  C                   ENDIF
 6e  C                   ENDIF
     *
 5e  C                   ENDIF
 4e  C                   ENDDO
 3e  C                   ENDIF
     *
     C     RELOAD        TAG
     *
     *  CLEAR SUBFILE
     C                   EVAL      *IN45 = *ON
     C                   WRITE     MNSF05                               91
     C                   EVAL      *IN45 = *OFF
     C                   EVAL      *IN06 = *OFF
     C                   EVAL      *IN70 = *OFF
     C                   EVAL      *IN12 = *OFF
     C                   EVAL      *IN72 = *OFF
     C                   EVAL      *IN73 = *OFF
     C                   EVAL      SFREC = 1
     *
     *  SEE IF ANY ARRAY OWNER IS DUPLICATED
 3b  C                   DO        400           A
 4b  C                   IF        SO(A) <> *ZEROS
     *
     C                   EVAL      OWNER = SO(A)
     C                   EVAL      AOWNER = ASO(A)
     C                   EVAL      B = 1
     C     OWNER         LOOKUP    SO(B)                                  21
 5b  C                   IF        *IN21 = *ON
     *
     *  FIRST TIME IS EXPECTED, LOOK FOR DUP'S
 6b  C                   DOU       *IN21 = *OFF
     C                   ADD       1             B
     C     OWNER         LOOKUP    SO(B)                                  21
 7b  C                   IF        *IN21 = *ON
     C                   EVAL      SO(B) = *ZEROS
     C                   EVAL      ASO(B) = *ZEROS
     C                   EVAL      ST(B) = *BLANKS
     C                   EVAL      AST(B) = *BLANKS
     C                   EVAL      SI(B) = *ZEROS
     C                   EVAL      SP(B) = *ZEROS
 7e  C                   ENDIF
 6e  C                   ENDDO
     *
 5e  C                   ENDIF
 4e  C                   ENDIF
 3e  C                   ENDDO
     *
     *  INITIAL LOAD FROM ARRAYS
 3b  C                   DO        400           A
     *
     C                   EVAL      *IN06 = *OFF
     C                   EVAL      ERRSPL = *BLANKS
     C                   EVAL      ERRALT = *BLANKS
     C                   EVAL      OWNER = *ZEROS
     C                   EVAL      AOWNER = *ZEROS
     C                   EVAL      NAME30 = *BLANKS
     C                   MOVE      *BLANKS       ANAME30          30
     C                   MOVE      *BLANKS       ANAM11           11
     C                   MOVE      *ZEROS        AOWNER            7 0
     C                   MOVE      *BLANKS       UPDALT            1
     C                   MOVE      *BLANKS       ERRALT            2
     C                   EVAL      ANAME30 = *BLANKS
     C                   EVAL      NNAM11 = *BLANKS
     C                   EVAL      ANAM11 = *BLANKS
     C                   EVAL      NEWINT = *ZEROS
     C                   EVAL      SHARE = *ZEROS
     C                   EVAL      *IN86 = *OFF
     C                   EVAL      *IN60 = *OFF
     *
 4b  C                   IF        SO(A) > 0
     *
     *=
 5b  C                   IF        ASO(A) > 0
     C                   EVAL      AOWNER = ASO(A)
     *    #altown       klist
     *                  kfld                    hajob#
     *                  kfld                    aowner
     *                  Eval      *IN21 = *OFF
     *    #altown       chain     MNOLFO                             21
     *                  If        *IN21 = *Off
     *                  Eval      anam11 = name30
     *                  Endif
 5e  C                   Endif
     *=
     C                   EVAL      NAME30 = *BLANKS
     C                   EVAL      JOB = JOBHLD
     C                   EVAL      OWNER = SO(A)
     C                   EVAL      AOWNER = ASO(A)
     C                   EVAL      ANAME30 = AST(A)
     C                   EVAL      ANAM11  = AST(A)
     C                   EVAL      *IN21 = *OFF
     *
     C     OWNKEY        CHAIN     MNOLFO                             21
     C  N21              EXSR      CHKAUT
     C                   MOVEL     NAME30        NNAM11
 5b  C                   IF        *IN21 = *ON
     C                   EVAL      SI(A) = *ZEROS
     C                   EVAL      SP(A) = *ZEROS
 6b  C                   IF        *IN06 = *OFF
     C                   MOVEL     'IO'          ERRSPL
     C                   EVAL      SFREC = A
 6e  C                   ENDIF
     C                   EVAL      *IN06 = *ON
     C                   EVAL      *IN12 = *ON
 5x  C                   ELSE
     C                   EXCEPT    RELO
     C                   MOVE      'N'           LOCKO
 5e  C                   ENDIF
     *
     *  IF SAME AS SPLIT FROM OWNER
 5b  C                   IF        OWNER = OWNHLD
 6b  C                   IF        *IN06 = *OFF
     C                   MOVEL     'SO'          ERRSPL
     C                   EVAL      SFREC = A
 6e  C                   ENDIF
     C                   EVAL      *IN06 = *ON
     C                   EVAL      *IN12 = *ON
     *
 5x  C                   ELSE
     *
     C                   EVAL      LSETYP = LSTHLD
     C     DOWKEY        CHAIN     MNDLFL                             21
 6b  C                   IF        *IN21 = *OFF
     C                   EXCEPT    RELDL
     C                   MOVE      'N'           LOCKDL
 7b  C                   IF        *IN06 = *OFF
     C                   MOVEL     'AI'          ERRSPL
 7e  C                   ENDIF
 6e  C                   ENDIF
     *
 5e  C                   ENDIF
     *
     *  CALC SHARE PERCENTAGE IF ENTERED
 5b  C                   IF        SP(A) <> *ZEROS
     C     SVDECI        MULT(H)   SP(A)         NEWINT
     C     SVDECI        MULT(H)   SP(A)         SI(A)
     C                   EVAL      SHARE = SP(A)
 5x  C                   ELSE
     C                   EVAL      NEWINT = SI(A)
     C                   EVAL      SHARE = *ZEROS
 5e  C                   ENDIF
 5b  C                   IF        NEWINT <= *ZEROS
     C                             OR NEWINT >= 1
 6b  C                   IF        *IN06 = *OFF
     C                   MOVEL     'II'          ERRSPL
     C                   EVAL      SFREC = A
 6e  C                   ENDIF
     C                   EVAL      *IN06 = *ON
     C                   EVAL      *IN12 = *ON
 5e  C                   ENDIF
     *
 4e  C                   ENDIF
     *
     C                   EVAL      OWNRRN = A
     C                   EVAL      UPDALT = 'N'
     C                   WRITE     MNSF06                               95
 3e  C                   ENDDO
     *
     C                   XFOOT     SI            NEWTOT
     C     SVDECI        SUB       NEWTOT        DEC2                   7273
     *
 3b  C                   SELECT
     *
 3x  C                   WHEN      *IN06 = *ON
     C                   EVAL      *IN70 = *OFF
     *
 3x  C                   WHEN      *IN12 = *ON
     C                   EVAL      *IN70 = *OFF
     *
 3x  C                   WHEN      *IN72 = *ON
     C                   EVAL      *IN70 = *OFF
     *
 3x  C                   OTHER
     C                   EVAL      *IN70 = *ON
     *
 3e  C                   ENDSL
     *
     *  ACCUM BEFORE OWNERS/INTEREST
     *
     C                   XFOOT     SO            TSSOBF
     C                   XFOOT     SI            TSSIBF
     C                   XFOOT     SP            TSSPBF
 3b  C                   IF        *IN70 = *ON
     C                   EVAL      *IN70 = TSSOBF > *ZEROS
 3e  C                   ENDIF
 3b  C                   IF        *IN70 = *ON
     C                   EVAL      *IN70 = TSSIBF > *ZEROS
 3e  C                   ENDIF
     *
     C                   EVAL      *IN42 = *ON
     C                   EVAL      *IN43 = *ON
 3b  C                   IF        *IN38 = *OFF
     C                   WRITE     MNSF06ER
 3e  C                   ENDIF
     C                   EXFMT     MNSF05
     C                   EVAL      *IN38 = *ON
     C                   EVAL      *IN06 = *OFF
     C                   EVAL      *IN12 = *OFF
     C                   EVAL      *IN70 = *OFF
     C                   EVAL      *IN72 = *OFF
     C                   EVAL      *IN73 = *OFF
     *
     C     *INKA         CABEQ     *ON           ENCSPL
     C     *INKB         CABEQ     *ON           ENCSPL
     C     *INKC         CABEQ     *ON           ENCSPL
     *
     *  CHECK FOR NEW SCREEN CHANGES
     C                   READC     MNSF06                                 97
 3b  C                   IF        *IN97 = *OFF
     C                   EVAL      SO = 0
     C                   EVAL      SI = 0
     C                   MOVEA     *ALL' '       ST
     C                   EVAL      SP = 0
     C                   EVAL      A = 0
 3e  C                   ENDIF
     *
 3b  C                   DOW       *IN97 = *OFF
     *
 4b  C                   IF        OWNER > *ZEROS
     C                   ADD       1             A
     C                   EVAL      SO(A) = OWNER
     C                   EVAL      ASO(A) = AOWNER
     C                   MOVE      NAME30        ST(A)
     C                   MOVE      ANAME30       AST(A)
     C                   EVAL      SI(A) = NEWINT
     C                   EVAL      SP(A) = SHARE
 4e  C                   ENDIF
     *
     C                   READC     MNSF06                                 97
 3e  C                   ENDDO
     *
     *
     * == START UPDATE ALTERNATE PARCEL
 3b  C                   IF        UPDALT = 'Y'                                 UPDATE ALT PARCEL?
     *    LSEKEY        CHAIN(N)  MNHLFLR                            21
     C                   EVAL      *IN86 = *Off
 4b  C                   IF        UPDALT = 'Y'                                 UPDATE ALT PARCEL?
     C                   EVAL      JOBSV  = JOB
 5b  C                   IF        HAJOB# = 0 OR HALSE# = 0                       ERROR
     C                   EVAL      *IN86 = *ON
 5e  c                   Endif
 4e  c                   Endif
 3e  c                   Endif

     *                  IF        UPDALT = 'Y'                                 UPDATE ALT PARCEL?
     *    LSEKEY        CHAIN(N)  MNALFLR                            21
     *
     *                  EVAL      JOBSV  = JOB
     *                  IF        AJOB# = 0 OR ALSE# = 0 OR ARRC# = 0          ERROR
     *                  EVAL      *IN86 = *ON
     *                  ELSE
     *    ALSEKEY       CHAIN(N)  MNDLFL                             21
     *                  IF        *IN21
     *call window
     *                  CALL      'MNOWFMW2'
     *                  PARM                    JOBSV
     *                  PARM                    AJOB#
     *                  PARM      *ZEROS        OWNIN
     *                  PARM      NAME30        NNAM30
     *                  PARM      'Y'           SELOWN
     *                  PARM      8             STRROW
     *                  PARM      2             STRCOL
     *
     *                  EVAL      AOWNER = OWNIN
     *                  MOVEL     NNAM30        ANAM11
     *                  MOVEL     NNAM30        ANAME30
     *                  ENDIF
     * n21ALSEKEY       CHAIN(N)  MNDLFL                             21
     *                  IF        *IN21
     *                  MOVEL     'IA'          ERRALT
     *                  EVAL      SFREC = A
     *                  ENDIF
     *                  ENDIF
     *
     *  alternate OWNER SELECTED?
     *                  IF        OWNIN <> *ZEROS
     *                            AND NNAM30 <> *BLANKS
     *                  EVAL      ASO(A) = OWNIN
     *                  MOVE      NNAM30        AST(A)
     *                  ENDIF
     *
     *                  ENDIF
     * == END UPDATE ALTERNATE PARCEL
     *
     *  C15 - SEARCH FOR OWNER
 3b  C                   IF        *INKP = *ON
     *
     *  IS SLOT AVAILABLE?
     C                   EVAL      A = 1
     C     *ZEROS        LOOKUP    SO(A)                                  97
 4b  C                   IF        *IN97 = *ON
     *
     C                   EVAL      NNAM30 = *BLANKS
     C                   MOVEL     'A'           NNAM30
     C                   EVAL      JOB = JOBHLD
     C                   CALL      'MNOWFMW1'
     C                   PARM                    JOB
     C                   PARM      *ZEROS        OWNIN
     C                   PARM                    NNAM30
     C                   PARM      'Y'           SELOWN
     C                   PARM      8             STRROW
     C                   PARM      2             STRCOL
     *
     *  OWNER SELECTED?
 5b  C                   IF        OWNIN <> *ZEROS
     C                             AND NNAM30 <> *BLANKS
     C                   EVAL      SO(A) = OWNIN
     C                   MOVE      NNAM30        ST(A)
     C                   EVAL      SI(A) = *ZEROS
     C                   EVAL      SP(A) = *ZEROS
 5e  C                   ENDIF
     *
 4e  C                   ENDIF
 3e  C                   ENDIF
     *
     *
     *  C16 - ELECTRONIC SUPPLIMENTS WINDOW
 3b  C                   IF        *INKQ = *ON
     *
     C                   Eval      *in66 = ELCSUP = 'Y'
 4b  C                   DOU       COREAS <> *BLANKS AND
     C                             COYRAP > 1900 OR
     C                             ELCSUP = 'N'
     C                   EXFMT     WINDOW1
 5b  C                   If        ELCSUP = 'Y'
     C     COREAS        CHAIN     MNTPF13
 6b  C                   If        NOT %FOUND(MNTPF13)
     C                             or COREAS=' ?' OR COREAS='? ' or COREAS='??'
     C                   CALL      'MNFM21'
     C                   PARM      *BLANKS       COREAS
 6e  C                   endif
 5e  C                   ENDIF
 4e  C                   ENDDO
     C                   Eval      *in66 = ELCSUP = 'Y'
     *
 3e  C                   ENDIF
     *
     *  ACCUM AFTER OWNERS/INTEREST
     C                   XFOOT     SO            TSSOAF
     C                   XFOOT     SI            TSSIAF
     C                   XFOOT     SP            TSSPAF
     *
     C     TSSOAF        CABNE     TSSOBF        RELOAD
     C     TSSIAF        CABNE     TSSIBF        RELOAD
     C     TSSPAF        CABNE     TSSPBF        RELOAD
     C     *INKH         CABEQ     *OFF          RELOAD
     *
     *
     * COMMAND 8 ONLY AVAILABLE IF 70 *ON
 3b  C                   IF        *INKH = *ON
     *
     *  SEE IF OWNER BEING SPLIT FROM EXISTS
     C                   EVAL      COJOB = JOB
     C                   EVAL      COTYPR = 1
     C                   EVAL      COLSE# = LSE#
     C                   EVAL      COSOPR = SVSOPR
     C                   EVAL      COLSTY = LSTHLD
     C                   EVAL      COCOWN = OWNHLD
     *
     C                   EVAL      *IN21 = *OFF
     C     COKY7A        CHAIN     MNDLF7A                            21
     *
 4b  C                   IF        *IN21 = *ON
     *
     C                   EVAL      *IN21 = *OFF
     C     JOB           CHAIN     MNDACTPF                           21
 5b  C                   IF        *IN21 = *ON
     C                   EVAL      NACT# = 100
     C                   WRITE     MNDACTPR
 5x  C                   ELSE
     C                   ADD       1             NACT#
     C                   UPDATE    MNDACTPR
 5e  C                   ENDIF
     *
     C                   EVAL      SVCACT = NACT#
 4x  C                   ELSE
     *
     *  SAVE ACCOUNT NUMBER
     C                   EVAL      SVCACT = COCACT
 4e  C                   ENDIF
     *
     *  GET HIGHEST SEQ# USED FOR THIS ACCOUNT NUMBER
     C                   EVAL      COJOB = JOB
     C                   EVAL      COTYPR = 1
     C                   EVAL      COLSE# = LSE#
     C                   EVAL      COCACT = SVCACT
     C                   EVAL      COCSQ# = *ZEROS
     C                   EVAL      *IN21 = *OFF
     C     COKY7B        CHAIN     MNDLF7B                            21
     C                   EVAL      NXCOCS = COCSQ#
     C                   EVAL      @A = *ZEROS
     C                   EVAL      B = *ZEROS
     C                   EVAL      SVSO = *ZEROS
     C                   EVAL      SVSP = *ZEROS
     *
     * WRITE OUT SPLITS TO D/O FILE
 4b  C                   DO        400           A
 5b  C                   IF        SO(A) > 0
     *
     *  IF PERCENTAGE ENTERED, SAVE TO ARRAYS FOR NEXT SPLIT
 6b  C                   IF        SP(A) <> *ZEROS
     C                   ADD       1             B
     C                   EVAL      SVSO(B) = SO(A)
     C                   EVAL      ASVSO(B) = ASO(A)
     C                   EVAL      SVSP(B) = SP(A)
 6e  C                   ENDIF
     *
     C                   EVAL      OWNER = SO(A)
     C     DOWKEY        CHAIN     MNDLFL                             24         MNDLFL      In
     C                   EVAL      PRVOWN = OWNHLD
     C                   EVAL      NEWINT = SI(A)
     C                   EVAL      DJV = 0
     C                   EVAL      DUSRDT = UDATE2
     C                   MOVE      USER          DUSRID
     C                   MOVE      'P'           DUSRCD
     *
     *  UPDATE EXISTING D/O LEASE
 6b  C                   IF        *IN24 = *OFF
     C                   ADD       NEWINT        DECINT
     c     newint        mult      djv1          ckint            11 0
 7b  c                   if        ckint > 0
 8b  c                   if        excd <> 'E'
     *                       tarrant county only
 9b  c                   if        job = 122000
     c                   move      'N'           mndxc1
 9e  c                   endif
     *                       end tarrant county
 8e  c                   endif
 7e  c                   endif
     C                   EVAL      DUSRDT = UDATE2
     C                   MOVE      USER          DUSRID
     C                   UPDATE    MNDPR                                                    Out
     c                   add       1             ark#
     c                   eval      arkl(ark#) = lse#
     *                  if        arkvsw = 'Y'
     *                  eval      flag = 'D' + shosel
     *                  call      'MNARCV003'
     *                  parm                    job
     *                  parm                    lse#
     *                  parm                    sopr
     *                  parm                    lsetyp
     *                  parm                    ownhld
     *                  parm                    flag
     *                  parm                    codate
     *                  parm                    cotime
     *                  parm                    coyrap
     *                  parm                    cocsq#
     *                  parm                    newint
     *                  eval      shosel = 'N'
     *                  eval      flag = ' ' + shosel
     *                  call      'MNARCV003'
     *                  parm                    job
     *                  parm                    lse#
     *                  parm                    sopr
     *                  parm                    lsetyp
     *                  parm                    owner
     *                  parm                    flag
     *                  parm                    codate
     *                  parm                    cotime
     *                  parm                    coyrap
     *                  parm                    cocsq#
     *                  parm                    newint
     *                  eval      shosel = 'N'
     *                  endif
     C                   MOVE      'N'           LOCKDL
     *
     *
 6x  C                   ELSE
     *
     *  ADD NEW D/O LEASE
     C                   EVAL      DECINT = NEWINT
     C                   EVAL      EXCD = *BLANKS
     C                   EVAL      PROCD = *BLANKS
     *                       tarrant county
 7b  c                   if        job = 122000
     C                   EVAL      MNDXC1 = 'N'
 7e  c                   endif
     *                       end tarrant county
     C                   EVAL      MNDXC2 = *BLANKS
     C                   EVAL      DCLCCD = *BLANKS
     C                   EVAL      DCLCDT = *ZEROS
     C                   EVAL      DCLCID = *BLANKS
     C                   EVAL      DUSRDT = UDATE2
     C                   MOVE      USER          DUSRID
     C                   WRITE     MNDPR                                                    Out
     c                   add       1             ark#
     c                   eval      arkl(ark#) = lse#
     *                  if        arkvsw = 'Y'
     *                  eval      flag = ' ' + shosel
     *                  call      'MNARCV003'
     *                  parm                    job
     *                  parm                    lse#
     *                  parm                    sopr
     *                  parm                    lsetyp
     *                  parm                    owner
     *                  parm                    flag
     *                  parm                    codate
     *                  parm                    cotime
     *                  parm                    coyrap
     *                  parm                    cocsq#
     *                  parm                    newint
     *                  eval      shosel = 'N'
     *                  endif
 6e  C                   ENDIF
     *                  ENDIF
     *
     * ALTERNATE
 6b  C                   IF        ASO(A) <> 0
     C                   EVAL      JOBSV  = JOB
     C     *LIKE         DEFINE    LSE#          LSESV
     C                   Z-ADD     LSE#          LSESV
     C     *LIKE         DEFINE    rrc           ARRCSV
     C                   Z-ADD     ARRC          ARRCSV
     C                   Z-ADD     ASO(A)        AOWNER
     ***  LSEKEY        CHAIN(N)  MNALFLR                            21
     C     ALSEKEY       CHAIN     MNDLFL                             21
     C                   EVAL      PRVOWN = OWNHLD
     C                   EVAL      NEWINT = SI(A)
     C                   EVAL      DJV = 0
     C                   EVAL      DUSRDT = UDATE2
     C                   MOVE      USER          DUSRID
     C                   MOVE      'P'           DUSRCD
     *
     *  UPDATE EXISTING D/O LEASE
 7b  C                   IF        *IN21 = *OFF
     C                   ADD       NEWINT        DECINT
     c     newint        mult      djv1          ckint            11 0
 8b  c                   if        ckint > 0
 9b  c                   if        excd <> 'E'
     *                      tarrant county
 10b c                   if        job = 122000
     c                   move      'N'           mndxc1
 10e c                   endif
     *                      end tarrant county
 9e  c                   endif
 8e  c                   endif
     C                   EVAL      DUSRDT = UDATE2
     C                   MOVE      USER          DUSRID
     C                   UPDATE    MNDPR                                                    Out
     c                   add       1             ark#
     c                   eval      arkl(ark#) = lse#
     *                  if        arkvsw = 'Y'
     *                  eval      flag = ' ' + shosel
     *                  call      'MNARCV003'
     *                  parm                    job
     *                  parm                    lse#
     *                  parm                    sopr
     *                  parm                    lsetyp
     *                  parm                    owner
     *                  parm                    flag
     *                  parm                    codate
     *                  parm                    cotime
     *                  parm                    coyrap
     *                  parm                    cocsq#
     *                  parm                    newint
     *                  eval      shosel = 'N'
     *                  endif
     C                   MOVE      'N'           LOCKDL
     *
 7x  C                   ELSE
     *
     *  ADD NEW D/O LEASE
     C                   EVAL      DECINT = NEWINT
     C                   EVAL      EXCD = *BLANKS
     C                   EVAL      PROCD = *BLANKS
     *                       tarrant county
 8b  c                   if        job = 122000
     C                   EVAL      MNDXC1 = 'N'
 8e  c                   endif
     *                       end tarrant county
     C                   EVAL      MNDXC2 = *BLANKS
     C                   EVAL      DCLCCD = *BLANKS
     C                   EVAL      DCLCDT = *ZEROS
     C                   EVAL      DCLCID = *BLANKS
     C                   EVAL      DUSRDT = UDATE2
     C                   MOVE      USER          DUSRID
     C                   WRITE     MNDPR                                                    Out
     c                   add       1             ark#
     c                   eval      arkl(ark#) = lse#
     *                  if        arkvsw = 'Y'
     *                  eval      flag = ' ' + shosel
     *                  call      'MNARCV003'
     *                  parm                    job
     *                  parm                    lse#
     *                  parm                    sopr
     *                  parm                    lsetyp
     *                  parm                    owner
     *                  parm                    flag
     *                  parm                    codate
     *                  parm                    cotime
     *                  parm                    coyrap
     *                  parm                    cocsq#
     *                  parm                    newint
     *                  eval      shosel = 'N'
     *                  endif
 7e  C                   ENDIF
     * SET BACK
     C                   Z-ADD     LSESV         LSE#
     C                   Z-ADD     jobSV         job
     C                   Z-ADD     ARRCSV        ARRC
     *    LSEKEY        CHAIN(N)  MNALFLR                            21
     ***  lsekey        CHAIN     MNDLFL                             21
 6e  C                   ENDIF
     *
     * GO BACK TO NON SPLIT OWNER
     C                   EVAL      OWNER = SO(A)
     *
     *  BEFORE WRITING THIS OWNERS SPLIT TO CHANGE RECORD
     *  GET MOST RECENT OWNER CHANGE RECORD TO SAVE SQ#
     C                   EVAL      COJOB = JOB
     C                   EVAL      COTYPR = 1
     C                   EVAL      COLSE# = LSE#
     C                   EVAL      COSOPR = SOPR
     C                   EVAL      COLSTY = LSETYP
     C                   EVAL      COCOWN = OWNER
     *
     C                   EVAL      COCACT = *ZEROS
     C                   EVAL      COCSQ# = *ZEROS
     C                   EVAL      COCDEC = *ZEROS
     C                   EVAL      SVCSQ# = *ZEROS
     C                   EVAL      SVCDEC = *ZEROS
     C                   EVAL      SVPACT = *ZEROS
     C                   EVAL      *IN21 = *OFF
     C     COKY7A        CHAIN     MNDLF7A                            21
     C                   EVAL      SVPACT = COCACT
     C                   EVAL      SVCDEC = COCDEC
     C                   EVAL      SVCSQ# = COCSQ#
     *
     *  WRITE CHANGE RECORD FOR OWNER BEING SPLIT TO
     C                   EVAL      COJOB = JOB
     C                   EVAL      COLSE# = LSE#
     C                   EVAL      COCACT = SVCACT
     C                   EVAL      COPSQ# = SVCSQ#
 6b  C                   IF        SVPACT <> SVCACT
     C                   EVAL      COPACT = SVPACT
 6x  C                   ELSE
     C                   EVAL      COPACT = *ZEROS
 6e  C                   ENDIF
     C                   EVAL      COTYPR = 1
     C                   EVAL      COSOPR = SOPR
     C                   EVAL      COLSTY = LSETYP
     C                   EVAL      COCOWN = OWNER
     C                   EVAL      COPOWN = OWNHLD
     C                   EVAL      COCDEC = DECINT
 6b  C                   IF        *IN24 = *ON
     C                   EVAL      COPDEC = *ZEROS
     C                   MOVEL     'SPADDOWN'    COTYPE
 6e  C                   ENDIF
 6b  C                   IF        *IN24 = *OFF
     C                   EVAL      COPDEC = SVCDEC
     C                   MOVEL     'CHGINTSP'    COTYPE
 6e  C                   ENDIF
     C                   MOVEL     USER          COUSER
     C                   MOVE      *YEAR         COYR4
     C                   MOVE      *MONTH        COMM2
     C                   MOVE      *DAY          CODD2
     *
     *  @A IS USED TO INCREMENT MULTIPLE SPLIT TO'S
     C                   EVAL      *IN21 = *ON
     C                   ADD       1             @A
 6b  C                   DOU       *IN21 = *OFF
     C     NXCOCS        ADD       @A            COCSQ#
     C                   EXSR      PROTME
     C                   WRITE     MNDPR7                               21
 7b  C                   IF        *IN21 = *ON
     C                   ADD       1             @A
 7e  C                   ENDIF
 6e  C                   ENDDO
     *
     *
     * BUILD SPLIT CHANGES FILE
 6b  C                   If        ELCSUP = 'Y'
     C                   EXSR      BLDMNDPF8
     C                   WRITE     MNDPR8
 6e  C                   ENDIF
     C
 5e  C                   ENDIF
 4e  C                   ENDDO                                                  END DO 56
     *
     *  SAVE LAST CURRENT SEQ# USED IN MULTPLE SPLITS
     C                   EVAL      SVLCSQ = COCSQ#
     *
     * UPDATE COMPLETE, TIME FOR SPLIT FROM OWNER
     C                   EVAL      OWNER = OWNHLD
     C                   EVAL      job   = jobHLD
     C                   EVAL      LSETYP = LSTHLD
     C                   EVAL      LSE#   = LSEHLD
     C     DOWKEY        CHAIN     MNDLFL                             24
     *
     *  BEFORE WRITING THIS OWNERS SPLIT TO CHANGE RECORD
     *  GET MOST RECENT OWNER CHANGE RECORD TO SAVE SQ#
     C                   EVAL      COJOB = JOB
     C                   EVAL      COTYPR = 1
     C                   EVAL      COLSE# = LSE#
     C                   EVAL      COSOPR = SVSOPR
     C                   EVAL      COLSTY = LSETYP
     C                   EVAL      COCOWN = OWNER
     *
     C                   EVAL      COCACT = *ZEROS
     C                   EVAL      COCSQ# = *ZEROS
     C                   EVAL      COCDEC = *ZEROS
     C                   EVAL      SVCSQ# = *ZEROS
     C                   EVAL      SVCDEC = *ZEROS
     C                   EVAL      SVPACT = *ZEROS
     C                   EVAL      *IN21 = *OFF
     C     COKY7A        CHAIN     MNDLF7A                            21
     C                   EVAL      SVPACT = COCACT
     C                   EVAL      SVCDEC = COCDEC
     C                   EVAL      SVCSQ# = COCSQ#
     *
     *  IF SPLIT FROM OWNER HAS A REMAINING DECINT
 4b  C                   IF        DEC2 > 0
     C                   EVAL      DECINT = DEC2
     C                   EVAL      DUSRDT = UDATE2
     C                   MOVE      USER          DUSRID
     C                   MOVE      'P'           DUSRCD
 5b  c                   if        excd <> 'E'
     *                       tarrant county
 6b  c                   if        job = 122000
     c                   move      'N'           mndxc1
 6e  c                   endif
     *                       end tarrant county
 5e  c                   endif
     C                   UPDATE    MNDPR
     *                  if        arkvsw = 'Y'
     *                  eval      flag = ' ' + shosel
     **                 call      'MNARCV003'
     **                 parm                    job
     **                 parm                    lse#
     **                 parm                    sopr
     **                 parm                    lsetyp
     **                 parm                    owner
     **                 parm                    flag
     **                 parm                    codate
     **                 parm                    cotime
     **                 parm                    coyrap
     **                 parm                    cocsq#
     **                 parm                    dec2
     *                  eval      shosel = 'N'
     *                  endif
     C                   EXSR      LDOUP
     C                   MOVE      'N'           LOCKDL
     *
     *  CREATE CHGINTSP CHANGE RECORD FOR SPLIT FROM OWNER W/REMAINING INT
     C                   EVAL      COJOB = JOB
     C                   EVAL      COLSE# = LSE#
     C                   EVAL      COCACT = SVCACT
     C                   EVAL      COPSQ# = SVCSQ#
 5b  C                   IF        SVPACT <> SVCACT
     C                   EVAL      COPACT = SVPACT
 5x  C                   ELSE
     C                   EVAL      COPACT = *ZEROS
 5e  C                   ENDIF
     C                   EVAL      COTYPR = 1
     C                   EVAL      COSOPR = SVSOPR
     C                   EVAL      COLSTY = LSETYP
     C                   EVAL      COCOWN = OWNER
     C                   EVAL      COPOWN = *ZEROS
     C                   EVAL      COCDEC = DEC2
     C                   EVAL      COPDEC = SVCDEC
     C                   MOVEL     'CHGINTSP'    COTYPE
     C                   MOVEL     USER          COUSER
     C                   MOVE      *YEAR         COYR4
     C                   MOVE      *MONTH        COMM2
     C                   MOVE      *DAY          CODD2
     *
     C                   EVAL      *IN21 = *ON
     C                   ADD       1             SVLCSQ
 5b  C                   DOU       *IN21 = *OFF
     C                   EVAL      COCSQ# = SVLCSQ
     C                   EXSR      PROTME
     C                   WRITE     MNDPR7                               21
 6b  C                   IF        *IN21 = *ON
     C                   ADD       1             SVLCSQ
 6e  C                   ENDIF
 5e  C                   ENDDO
     *
 4x  C                   ELSE                                                   DEC2 <=0
     *
     *  ELSE, REMAINING DECINT=0, DELETE FROM LEASE
     C                   DELETE    MNDPR
     *                  if        arkvsw = 'Y'
     *                  eval      flag = 'D' + shosel
     *                  call      'MNARCV003'
     *                  parm                    job
     *                  parm                    lse#
     *                  parm                    sopr
     *                  parm                    lsetyp
     *                  parm                    owner
     *                  parm                    flag
     *                  parm                    codate
     *                  parm                    cotime
     *                  parm                    coyrap
     *                  parm                    cocsq#
     *                  parm                    svpdec
     *                  eval      shosel = 'N'
     *                  endif
     C                   EXSR      LDOUP
     C                   MOVE      'N'           LOCKDL
     *
 4e  C                   ENDIF
     *
 3x  C                   ELSE                                                   INKH=0
     *
 GO  C                   GOTO      RELOAD
     *
 3e  C                   ENDIF                                                  END INKH=1
     *
     C     ENCSPL        ENDSR
     *
     *=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-*
      /EJECT
     *
     C     BLDMNDPF8     BEGSR
     C                   EVAL      #OWNER = COCOWN
     C                   EVAL      @OWNER = COCOWN
     C     COKEY         CHAIN     MNOLFO
     C                   EVAL      COCNAM = NAME30
     C                   EVAL      COCCAR = CARE
     C                   EVAL      COCSTR = STREET
     C                   EVAL      COCCTS = CTST30
     C                   EVAL      @OWNER = COPOWN
     C     COKEY         CHAIN     MNOLFO
     C                   EVAL      COPNAM = NAME30
     C                   EVAL      COPCAR = CARE
     C                   EVAL      COPSTR = STREET
     C                   EVAL      COPCTS = CTST30
     C                   EVAL      COLJR1 = LJR(1)
     C                   EVAL      COLJR2 = LJR(2)
     C                   EVAL      COLJR3 = LJR(3)
     C                   EVAL      COLJR4 = LJR(4)
     C                   EVAL      COLJR5 = LJR(5)
     C                   EVAL      COLJR6 = LJR(6)
     C                   EVAL      COLJR7 = LJR(7)
     C                   EVAL      COLJR8 = LJR(8)
     C                   EVAL      COLJR9 = LJR(9)
     C                   EVAL      CODSC1 = DESC1
     C                   EVAL      CODSC2 = DESC2
     C                   EVAL      COCSUP = ELCSUP
     C                   MOVEL     'CHGINTSP'    COTYPE

     C                   ENDSR
      /EJECT
     *
     C     WOCDLT        BEGSR
     *
     *=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-*
     *  WRITE OWNERSHIP DELETES
     *=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-*
     *
     *  SEE IF OWNER BEING DELETED EXISTS
     C                   EVAL      COJOB = JOB
     C                   EVAL      COTYPR = 1
     C                   EVAL      COLSE# = LSE#
     C                   EVAL      COSOPR = SVSOPR
     C                   EVAL      COLSTY = LSETYP
     C                   EVAL      COCOWN = OWNER
     C                   EVAL      *IN21 = *OFF
     C     COKY7A        CHAIN     MNDLF7A                            21
     *
 3b  C                   IF        *IN21 = *ON
     *
     C                   EVAL      *IN21 = *OFF
     C     JOB           CHAIN     MNDACTPF                           21
 4b  C                   IF        *IN21 = *ON
     C                   EVAL      NACT# = 100
     C                   WRITE     MNDACTPR
 4x  C                   ELSE
     C                   ADD       1             NACT#
     C                   UPDATE    MNDACTPR
 4e  C                   ENDIF
     *
     C                   EVAL      SVCACT = NACT#
     C                   EVAL      SVPSQ# = *ZEROS
     C                   EVAL      SVCDEC = *ZEROS
 3x  C                   ELSE
     *
     *  SAVE ORIGINAL ACCOUNT NUMBER
     C                   EVAL      SVCACT = COCACT
     C                   EVAL      SVPSQ# = COCSQ#
     C                   EVAL      SVCDEC = COCDEC
 3e  C                   ENDIF
     *
     *  GET HIGHEST SEQ# USED FOR THIS ACCOUNT NUMBER
     C                   EVAL      COJOB = JOB
     C                   EVAL      COTYPR = 1
     C                   EVAL      COLSE# = LSE#
     C                   EVAL      COCACT = SVCACT
     C                   EVAL      COCSQ# = *ZEROS
     C                   EVAL      *IN21 = *OFF
     C     COKY7B        CHAIN     MNDLF7B                            21
     C                   EVAL      NXCOCS = COCSQ#
     *
     *  CREATE DELETE CHANGE RECORD
     C                   EVAL      COJOB = JOB
     C                   EVAL      COLSE# = LSE#
     C                   EVAL      COCACT = SVCACT
     C                   EVAL      COCSQ# = NXCOCS
     C                   EVAL      COPSQ# = SVPSQ#
     C                   EVAL      COTYPR = 1
     C                   EVAL      COSOPR = SVSOPR
     C                   EVAL      COLSTY = LSETYP
     C                   EVAL      COCOWN = OWNER
     C                   EVAL      COPOWN = *ZEROS
     C                   EVAL      COCDEC = *ZEROS
     C                   EVAL      COPDEC = SVCDEC
     C                   MOVEL     CODLTY        COTYPE
     C                   MOVEL     USER          COUSER
     C                   MOVE      *YEAR         COYR4
     C                   MOVE      *MONTH        COMM2
     C                   MOVE      *DAY          CODD2
     *
     C                   EVAL      *IN21 = *ON
 3b  C                   DOU       *IN21 = *OFF
     C                   ADD       1             NXCOCS
     C                   EVAL      COCSQ# = NXCOCS
     C                   EXSR      PROTME
     C                   WRITE     MNDPR7                               21
 3e  C                   ENDDO
     *
     C                   ENDSR
     *
      /EJECT
     *
     C     WOCINT        BEGSR
     *
     *=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-*
     *  WRITE OWNERSHIP INTEREST CHANGES
     *=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-*
     *
     *  SEE IF OWNER EXISTS
     C                   EVAL      COJOB = JOB
     C                   EVAL      COTYPR = 1
     C                   EVAL      COLSE# = LSE#
     C                   EVAL      COSOPR = SVSOPR
     C                   EVAL      COLSTY = SVDLTY
     C                   EVAL      COCOWN = OWNER
     *
     C                   EVAL      *IN21 = *OFF
     C     COKY7A        CHAIN     MNDLF7A                            21
     *
 3b  C                   IF        *IN21 = *ON
     *
     C                   EVAL      *IN21 = *OFF
     C     JOB           CHAIN     MNDACTPF                           21
 4b  C                   IF        *IN21 = *ON
     C                   EVAL      NACT# = 100
     C                   WRITE     MNDACTPR
 4x  C                   ELSE
     C                   ADD       1             NACT#
     C                   UPDATE    MNDACTPR
 4e  C                   ENDIF
     *
     C                   EVAL      SVCACT = NACT#
 3x  C                   ELSE
     *
     *  SAVE ORIGINAL ACCOUNT NUMBER
     C                   EVAL      SVCACT = COCACT
 3e  C                   ENDIF
     *
     *  GET HIGHEST SEQ# USED FOR THIS ACCOUNT NUMBER
     C                   EVAL      COJOB = JOB
     C                   EVAL      COTYPR = 1
     C                   EVAL      COLSE# = LSE#
     C                   EVAL      COCACT = SVCACT
     C                   EVAL      COCSQ# = *ZEROS
     C                   EVAL      *IN21 = *OFF
     C     COKY7B        CHAIN     MNDLF7B                            21
     C                   EVAL      NXCOCS = COCSQ#
     *
     *  BEFORE WRITING THIS OWNERS CHGINT RECORD
     *  GET MOST RECENT OWNER CHANGE RECORD TO SAVE SQ#
     C                   EVAL      COJOB = JOB
     C                   EVAL      COTYPR = 1
     C                   EVAL      COLSE# = LSE#
     C                   EVAL      COSOPR = SVSOPR
     C                   EVAL      COLSTY = SVDLTY
     C                   EVAL      COCOWN = OWNER
     *
     C                   EVAL      COCACT = *ZEROS
     C                   EVAL      COCSQ# = *ZEROS
     C                   EVAL      COCDEC = *ZEROS
     C                   EVAL      SVPACT = *ZEROS
     C                   EVAL      SVCSQ# = *ZEROS
     C                   EVAL      SVCDEC = *ZEROS
     C                   EVAL      *IN21 = *OFF
     C     COKY7A        CHAIN     MNDLF7A                            21
     C                   EVAL      SVPACT = COCACT
     C                   EVAL      SVCSQ# = COCSQ#
     C                   EVAL      SVCDEC = COCDEC
     *
     *  CREATE CHGINT CHANGE RECORD
     C                   EVAL      COJOB = JOB
     C                   EVAL      COLSE# = LSE#
     C                   EVAL      COCACT = SVCACT
     C                   EVAL      COPSQ# = SVCSQ#
 3b  C                   IF        SVPACT <> SVCACT
     C                   EVAL      COPACT = SVPACT
 3x  C                   ELSE
     C                   EVAL      COPACT = *ZEROS
 3e  C                   ENDIF
     C                   EVAL      COTYPR = 1
     C                   EVAL      COSOPR = SVSOPR
     C                   EVAL      COLSTY = SVDLTY
     C                   EVAL      COCOWN = OWNER
     C                   EVAL      COPOWN = *ZEROS
     C                   EVAL      COCDEC = DECINT
     C                   EVAL      COPDEC = SVCDEC
     C                   MOVEL     'CHGINTOW'    COTYPE
     C                   MOVEL     USER          COUSER
     C                   MOVE      *YEAR         COYR4
     C                   MOVE      *MONTH        COMM2
     C                   MOVE      *DAY          CODD2
     *
     C                   EVAL      *IN21 = *ON
 3b  C                   DOU       *IN21 = *OFF
     C                   ADD       1             NXCOCS
     C                   EVAL      COCSQ# = NXCOCS
     C                   EXSR      PROTME
     C                   WRITE     MNDPR7                               21
 3e  C                   ENDDO
     *
     C                   ENDSR
     *
      /EJECT
     *
     C     WOCCOW        BEGSR
     *
     *=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-*
     *  WRITE OWNERSHIP CHANGES
     *=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-*
     *
     *  SEE IF ORIGINAL OWNER EXISTS
     C                   EVAL      COJOB = JOB
     C                   EVAL      COTYPR = 1
     C                   EVAL      COLSE# = LSE#
     C                   EVAL      COSOPR = PSOPR
     C                   EVAL      COLSTY = LSETYP
     C                   EVAL      COCOWN = POWN
     *
     C                   EVAL      *IN21 = *OFF
     C     COKY7A        CHAIN     MNDLF7A                            21
     *
 3b  C                   IF        *IN21 = *ON
     *
     C                   EVAL      *IN21 = *OFF
     C     JOB           CHAIN     MNDACTPF                           21
 4b  C                   IF        *IN21 = *ON
     C                   EVAL      NACT# = 100
     C                   WRITE     MNDACTPR
 4x  C                   ELSE
     C                   ADD       1             NACT#
     C                   UPDATE    MNDACTPR
 4e  C                   ENDIF
     *
     C                   EVAL      SVCACT = NACT#
     C                   EVAL      NXCOCS = *ZEROS
 3x  C                   ELSE
     *
     *  SAVE ORIGINAL ACCOUNT NUMBER
     C                   EVAL      SVCACT = COCACT
     C                   EVAL      NXCOCS = COCSQ#
 3e  C                   ENDIF
     *
     *  BEFORE WRITING THIS OWNERS CHGOWNSH RECORD
     *  GET MOST RECENT OWNER CHANGE RECORD TO SAVE FIELDS
     C                   EVAL      COJOB = JOB
     C                   EVAL      COTYPR = 1
     C                   EVAL      COLSE# = LSE#
     C                   EVAL      COSOPR = CSOPR
     C                   EVAL      COLSTY = LSETYP
     C                   EVAL      COCOWN = COWN
     *
     C                   EVAL      COCACT = *ZEROS
     C                   EVAL      COPSQ# = *ZEROS
     C                   EVAL      SVPACT = *ZEROS
     C                   EVAL      SVPSQ# = *ZEROS
     C                   EVAL      *IN21 = *OFF
     C     COKY7A        CHAIN     MNDLF7A                            21
     C                   EVAL      SVPACT = COCACT
     C                   EVAL      SVPSQ# = COPSQ#
     *
     *  IF OWNERSHIP IS BEING CHANGED TO AN OWNER THAT'S ALREADY
     *   ON THIS LEASE, WE HAVE TO BUMP THE COCSQ# UP.
 3b  C                   IF        SVPDEC <> *ZEROS
     *
     *  GET HIGHEST SEQ# USED FOR THIS ACCOUNT NUMBER
     C                   EVAL      COJOB = JOB
     C                   EVAL      COTYPR = 1
     C                   EVAL      COLSE# = LSE#
     C                   EVAL      COCACT = SVCACT
     C                   EVAL      COCSQ# = *ZEROS
     C                   EVAL      *IN21 = *OFF
     C     COKY7B        CHAIN     MNDLF7B                            21
     C                   EVAL      NXCOCS = COCSQ#
     *
 3e  C                   ENDIF
     *
     *  CREATE CHGOWN CHANGE RECORD
     C                   EVAL      COJOB = JOB
     C                   EVAL      COLSE# = LSE#
     C                   EVAL      COCACT = SVCACT
     C                   EVAL      COPSQ# = SVPSQ#
 3b  C                   IF        SVPACT <> SVCACT
     C                   EVAL      COPACT = SVPACT
 3x  C                   ELSE
     C                   EVAL      COPACT = *ZEROS
 3e  C                   ENDIF
     C                   EVAL      COTYPR = 1
     C                   EVAL      COSOPR = CSOPR
     C                   EVAL      COLSTY = LSETYP
     C                   EVAL      COCOWN = COWN
     C                   EVAL      COPOWN = POWN
     C                   EVAL      COCDEC = DECINT
     C                   EVAL      COPDEC = SVPDEC
     C                   MOVEL     'CHGOWNSH'    COTYPE
     C                   MOVEL     USER          COUSER
     C                   MOVE      *YEAR         COYR4
     C                   MOVE      *MONTH        COMM2
     C                   MOVE      *DAY          CODD2
     *
     C                   EVAL      *IN21 = *ON
 3b  C                   DOU       *IN21 = *OFF
     *
     *  IF OWNERSHIP IS BEING CHANGED TO AN OWNER THAT'S ALREADY
     *   ON THIS LEASE, WE HAVE TO BUMP THE COCSQ# UP.
 4b  C                   IF        SVPDEC <> *ZEROS
     C                   ADD       1             NXCOCS
     C                   MOVEL     'CHGINTSP'    COTYPE
 4e  C                   ENDIF
     *
     C                   EVAL      COCSQ# = NXCOCS
     C                   EXSR      PROTME
     C                   WRITE     MNDPR7                               21
 3e  C                   ENDDO
     *
     C                   ENDSR
     *
      /EJECT
     *
     C     WOCAOW        BEGSR
     *
     *=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-*
     *  WRITE OWNERSHIP ADDS
     *=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-*
     *
     *  SEE IF OWNER EXISTS, POSSIBLY UNDER DIFFERENT SOPR#
     C                   EVAL      COJOB = JOB
     C                   EVAL      COCOWN = OWNER
     C                   EVAL      COTYPR = 1
     C                   EVAL      COLSE# = LSE#
     C                   EVAL      COLSTY = LSETYP
     *
     C                   EVAL      *IN21 = *ON
 3b  C                   DOU       *IN21 = *OFF
     C                   OPEN      MNDLF7E                              21
 3e  C                   ENDDO
     *
     C                   EVAL      *IN21 = *OFF
     C     COKY7E        CHAIN     MNDLF7E                            21
     C                   CLOSE     MNDLF7E
     *
     *  OWNER DOESN'T EXIST
 3b  C                   IF        *IN21 = *ON
     *
     C                   EVAL      *IN21 = *OFF
     C     JOB           CHAIN     MNDACTPF                           21
 4b  C                   IF        *IN21 = *ON
     C                   EVAL      NACT# = 100
     C                   WRITE     MNDACTPR
 4x  C                   ELSE
     C                   ADD       1             NACT#
     C                   UPDATE    MNDACTPR
 4e  C                   ENDIF
     *
     C                   EVAL      SVCACT = NACT#
     *
 3x  C                   ELSE
     *
     C                   EVAL      SVCACT = COCACT
     *
 3e  C                   ENDIF
     *
     *  GET HIGHEST SEQ# USED FOR THIS ACCOUNT NUMBER
     C                   EVAL      COJOB = JOB
     C                   EVAL      COTYPR = 1
     C                   EVAL      COLSE# = LSE#
     C                   EVAL      COCACT = SVCACT
     C                   EVAL      COCSQ# = *ZEROS
     C                   EVAL      *IN21 = *OFF
     C     COKY7B        CHAIN     MNDLF7B                            21
     C                   EVAL      NXCOCS = COCSQ#
     *
     *  CREATE ADDOWN CHANGE RECORD
     C                   EVAL      COJOB = JOB
     C                   EVAL      COLSE# = LSE#
     C                   EVAL      COCACT = SVCACT
     C                   EVAL      COPACT = *ZEROS
     C                   EVAL      COPSQ# = *ZEROS
     C                   EVAL      COTYPR = 1
     C                   EVAL      COSOPR = SOPR
     C                   EVAL      COLSTY = LSETYP
     C                   EVAL      COCOWN = OWNER
     C                   EVAL      COPOWN = pown
     C                   EVAL      COCDEC = DECINT
     C                   EVAL      COPDEC = *ZEROS
     C                   MOVEL     'ADDOWN  '    COTYPE
     C                   MOVEL     USER          COUSER
     C                   MOVE      *YEAR         COYR4
     C                   MOVE      *MONTH        COMM2
     C                   MOVE      *DAY          CODD2
     *
     C                   EVAL      *IN21 = *ON
 3b  C                   DOU       *IN21 = *OFF
     C                   ADD       1             NXCOCS
     C                   EVAL      COCSQ# = NXCOCS
     C                   EXSR      PROTME
     C                   WRITE     MNDPR7                               21
 3e  C                   ENDDO
     *
     C                   ENDSR
     *
      /EJECT
     *
     C     WOCCTY        BEGSR
     *
     *=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-*
     *  WRITE OWNERSHIP LEASE TYPE CHANGES
     *=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-*
     *
     *  SEE IF OWNER EXISTS
     C                   EVAL      COJOB = JOB
     C                   EVAL      COTYPR = 1
     C                   EVAL      COLSE# = LSE#
     C                   EVAL      COSOPR = SVSOPR
     C                   EVAL      COLSTY = SVDLTY
     C                   EVAL      COCOWN = OWNER
     *
     C                   EVAL      *IN21 = *OFF
     C     COKY7A        CHAIN     MNDLF7A                            21
     *
 3b  C                   IF        *IN21 = *ON
     *
     C                   EVAL      *IN21 = *OFF
     C     JOB           CHAIN     MNDACTPF                           21
 4b  C                   IF        *IN21 = *ON
     C                   EVAL      NACT# = 100
     C                   WRITE     MNDACTPR
 4x  C                   ELSE
     C                   ADD       1             NACT#
     C                   UPDATE    MNDACTPR
 4e  C                   ENDIF
     *
     C                   EVAL      SVCACT = NACT#
     C                   EVAL      SVPACT = *ZEROS
     C                   EVAL      SVPSQ# = *ZEROS
     C                   EVAL      SVPDEC = *ZEROS
 3x  C                   ELSE
     *
     *  SAVE ORIGINAL ACCOUNT NUMBER
     C                   EVAL      SVCACT = COCACT
     C                   EVAL      SVPACT = COCACT
     C                   EVAL      SVPSQ# = COCSQ#
     C                   EVAL      SVPDEC = COCDEC
 3e  C                   ENDIF
     *
     *  GET HIGHEST SEQ# USED FOR THIS ACCOUNT NUMBER
     C                   EVAL      COJOB = JOB
     C                   EVAL      COTYPR = 1
     C                   EVAL      COLSE# = LSE#
     C                   EVAL      COCACT = SVCACT
     C                   EVAL      COCSQ# = *ZEROS
     C                   EVAL      *IN21 = *OFF
     C     COKY7B        CHAIN     MNDLF7B                            21
     C                   EVAL      NXCOCS = COCSQ#
     *
     *  BEFORE WRITING THIS OWNERS CHGINT RECORD
     *  GET MOST RECENT OWNER CHANGE RECORD TO SAVE SQ#
     *                    Z-ADDJOB       COJOB
     *                    Z-ADD1         COTYPR
     *                    Z-ADDLSE#      COLSE#
     *                    Z-ADDSOPR      COSOPR
     *                    Z-ADDSVDLTY    COLSTY
     *                    Z-ADDOWNER     COCOWN
     *
     *                    Z-ADD*ZEROS    COCACT
     *                    Z-ADD*ZEROS    COCSQ#
     *                    Z-ADD*ZEROS    COCDEC
     *                    Z-ADD*ZEROS    SVPACT
     *                    Z-ADD*ZEROS    SVCSQ#
     *                    Z-ADD*ZEROS    SVCDEC
     *                    SETOF                     21
     *          COKY7A    CHAINMNDLF7A              21
     *                    Z-ADDCOCACT    SVPACT
     *                    Z-ADDCOCSQ#    SVCSQ#
     *                    Z-ADDCOCDEC    SVCDEC
     *
     *  CREATE CHGTYP CHANGE RECORD
     C                   EVAL      COJOB = JOB
     C                   EVAL      COLSE# = LSE#
     C                   EVAL      COCACT = SVCACT
     C                   EVAL      COPSQ# = SVPSQ#
 3b  C                   IF        SVPACT <> SVCACT
     C                             AND SVPACT > *ZEROS
     C                   EVAL      COPACT = SVPACT
 3x  C                   ELSE
     C                   EVAL      COPACT = *ZEROS
 3e  C                   ENDIF
     C                   EVAL      COTYPR = 1
     C                   EVAL      COSOPR = SOPR
     C                   EVAL      COLSTY = LSETYP
     C                   EVAL      COCOWN = OWNER
     C                   EVAL      COPOWN = pown
     C                   EVAL      COCDEC = DECINT
 3b  C                   IF        SVPDEC > *ZEROS
     C                   EVAL      COPDEC = SVPDEC
 3x  C                   ELSE
     C                   EVAL      COPDEC = *ZEROS
 3e  C                   ENDIF
     C                   MOVEL     'CHGLSETY'    COTYPE
     C                   MOVEL     USER          COUSER
     C                   MOVE      *YEAR         COYR4
     C                   MOVE      *MONTH        COMM2
     C                   MOVE      *DAY          CODD2
     *
     C                   EVAL      *IN21 = *ON
 3b  C                   DOU       *IN21 = *OFF
     C                   ADD       1             NXCOCS
     C                   EVAL      COCSQ# = NXCOCS
     C                   EXSR      PROTME
     C                   WRITE     MNDPR7                               21
 3e  C                   ENDDO
     *
     C                   ENDSR
     *
      /EJECT
     *
     C     PGILSE        BEGSR
     *
     *=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-*
     *  CALC INDIVIDUAL LEASE
     *=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-*
     *
     C                   MOVEL     'MNUP02AC'    CLCLSE
     C                   MOVE      'L '          CLCLSE
     C                   CALL      CLCLSE
     C                   PARM                    JOB
     C                   PARM                    LSE#
     *
     C                   ENDSR
     *
      /EJECT
     *
     C     SRINIT        BEGSR
     *
     *=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-*
     *  PROGRAM INITIALIZATION
     *=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-*
     *
     C                   MOVE      *ON           @IN01
     C                   EVAL      @L = *ZEROS                                  LEVEL POINTER
     C                   EVAL      #L = *ZEROS
     C                   EVAL      DUPLS# = *ZEROS
     C                   EVAL      RTNCDE = *BLANKS
     C                   EVAL      SVSO = *ZEROS
     C                   EVAL      SVSP = *ZEROS
     *
     ***SETUP CENTURY DIGIT 19TH=0, 20TH=1
     ***
     ***        UYEAR     IFLT 37
     ***                  Z-ADD1         CNTURY  10
     ***                  ELSE
     ***                  Z-ADD0         CNTURY
     ***                  ENDIF
     *
     *  GET USER DATA AREA THAT HAS THE MINERAL LIBRARY NAME
     *   IN POS. 101-104.
     C     *DTAARA       DEFINE                  USRDTA          256
     C                   IN        USRDTA
     C                   MOVEL     USRDTA        DSUSR
     *
     C     *DTAARA       DEFINE                  MATXYR            4 0
     C                   IN        MATXYR
     C                   IF        MATXYR <= *ZEROS
     C                   EVAL      MATXYR = *YEAR
     C                   ENDIF

     *
     *  SET START TIMES
     C                   TIME                    STRTME
     C                   TIME                    @PF3TM
     C                   EVAL      MPF3TM = @PF3TM
     C                   MOVEA     PR1(1)        PARM1                          CLR MNDPF1
     C                   MOVEA     PR1(2)        PARM9                          CLR MNDWPF1
     C                   EVAL      MM = UMONTH
     C                   EVAL      DD = UDAY
     ***                  Z-ADDUYEAR     YY
     C                   EVAL      YY = *YEAR
     C                   MOVEL     'MNFM01'      SEL1
     *
     *  BITDSP USED WITH SFLMSG
     C                   BITOFF    '01234567'    NULL
     C                   MOVE      NULL          BITDSP
     *
     C                   MOVE      'N'           SFBOV
     C                   MOVE      'N'           SFDSP
     C                   MOVE      *ZEROS        DELSE#
     C                   MOVE      *ZEROS        DEUSDT
     C                   EVAL      DEUSID = *BLANKS
     C                   EVAL      *IN33 = *OFF
     C                   EVAL      *IN34 = *OFF
     *
     *  SEE IF OWNERSHIP CHANGES EXIST FOR OWNER
     C                   EVAL      COJOB = JOB
     C                   EVAL      COCOWN = OWNER
     C                   EVAL      COTYPR = 1
     *
     *  CHECK MNDLF5OA FILE FIRST (OLD CHANGE FILE)
     C                   EVAL      *IN95 = *OFF
     C     COKY7C        CHAIN     MNDLF5OA                           95
 3b  C                   IF        *IN95 = *ON
     C                   MOVE      'N'           PF5FLG
 3e  C                   ENDIF
 3b  C                   IF        *IN95 = *OFF
     C                   MOVE      'Y'           PF5FLG
 3e  C                   ENDIF
     *
     *  CHECK MNDLF7C FILE SECOND (NEW CHANGE FILE)
     C                   EVAL      *IN95 = *OFF
     C     COKY7C        CHAIN     MNDLF7C                            95
 3b  C                   IF        *IN95 = *ON
     C                   MOVE      'N'           PF7FLG
 3e  C                   ENDIF
 3b  C                   IF        *IN95 = *OFF
     C                   MOVE      'Y'           PF7FLG
 3e  C                   ENDIF
     *
 3b  C                   IF        PF5FLG = 'Y'
     C                             OR PF7FLG = 'Y'
     C                   MOVE      'Y'           OWSCHG
 3x  C                   ELSE
     C                   MOVE      ' '           OWSCHG
 3e  C                   ENDIF
     *
     C                   ENDSR
     *
      /EJECT
     *=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-*
     *
     C     SRDEFN        BEGSR
     *
     *=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-*
     *  PROGRAM DEFINITIONS
     *=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-*
     *
     *
     C     OWNKEY        KLIST
     C                   KFLD                    JOB
     C                   KFLD                    OWNER
     *
     C     AOWNKEY       KLIST
     C                   KFLD                    ALTJOB
     C                   KFLD                    OWNER
     *
     C     COKEY         KLIST
     C                   KFLD                    JOB
     C                   KFLD                    @OWNER
     *
     C     AGTKEY        KLIST
     C                   KFLD                    JOB
     C                   KFLD                    AGENT#
     *
     C     AGTKY2        KLIST
     C                   KFLD                    JOB
     C                   KFLD                    AGENT#
     C                   KFLD                    NAME20
     C                   KFLD                    OWNER
     *
     C     INVKEY        KLIST
     C                   KFLD                    JOB
     C                   KFLD                    OWNER
     *
     C     NMEKEY        KLIST
     C                   KFLD                    JOB
     C                   KFLD                    NAME20
     C                   KFLD                    OWNER
     *
     C     LSEKEY        KLIST
     C                   KFLD                    JOB
     C                   KFLD                    LSE#
     *
     C     altkey        KLIST
     C                   KFLD                    HAJOB#
     C                   KFLD                    HALSE#
     *
     C     ALSEKEY       KLIST
     C                   KFLD                    HAJOB#
     C                   KFLD                    HALSE#
     C                   KFLD                    SOPR
     C                   KFLD                    LSETYP
     C                   KFLD                    AOWNER
     *
     C     UNTKEY        KLIST
     C                   KFLD                    JOB
     C                   KFLD                    UNIT
     *
     C     LSNKEY        KLIST
     C                   KFLD                    JOB
     C                   KFLD                    LSRT
     C                   KFLD                    LNAM20
     C                   KFLD                    LSE#
     *
     C     LSDKEY        KLIST
     C                   KFLD                    JOB
     C                   KFLD                    LSRT
     C                   KFLD                    DSC120
     C                   KFLD                    LNAM20
     C                   KFLD                    LSE#
     *
     C     LSOKEY        KLIST
     C                   KFLD                    JOB
     C                   KFLD                    LSRT
     C                   KFLD                    OPRN
     C                   KFLD                    LNAM20
     C                   KFLD                    LSE#
     *
     C     RRCKEY        KLIST
     C                   KFLD                    JOB
     C                   KFLD                    RRC
     *
     C     OWLKEY        KLIST
     C                   KFLD                    JOB
     C                   KFLD                    OWNER
     C                   KFLD                    LSE#
     *
     C     OWDKEY        KLIST
     C                   KFLD                    JOB
     C                   KFLD                    OWNER
     C                   KFLD                    LSE#
     C                   KFLD                    LSETYP
     C                   KFLD                    SOPR
     *
     C     S@KEY         KLIST
     C                   KFLD                    JOB
     C                   KFLD                    OWNER
     C                   KFLD                    S@LSE#
     C                   KFLD                    S@LSET
     C                   KFLD                    S@SOPR
     *
     C     DOWKEY        KLIST
     C                   KFLD                    JOB
     C                   KFLD                    LSE#
     C                   KFLD                    SOPR
     C                   KFLD                    LSETYP
     C                   KFLD                    OWNER
     *
     C     DNMKEY        KLIST
     C                   KFLD                    LSE#
     C                   KFLD                    SOPR
     C                   KFLD                    LSETYP
     C                   KFLD                    NAME30
     C                   KFLD                    OWNER
     *
     C     UTNKEY        KLIST
     C                   KFLD                    SEL1
     C                   KFLD                    SEL2
     C                   KFLD                    NBR1
     C                   KFLD                    NBR2
     C                   KFLD                    NBR3
     *
     C     P13KEY        KLIST
     C                   KFLD                    MT13LB
     C                   KFLD                    MT13RS
     *
     C     DPLKEY        KLIST
     C                   KFLD                    JOB
     C                   KFLD                    DUPTLS
     *
     C     COKY7A        KLIST
     C                   KFLD                    COJOB
     C                   KFLD                    COTYPR
     C                   KFLD                    COLSE#
     C                   KFLD                    COSOPR
     C                   KFLD                    COLSTY
     C                   KFLD                    COCOWN
     *
     C     COKY7B        KLIST
     C                   KFLD                    COJOB
     C                   KFLD                    COTYPR
     C                   KFLD                    COLSE#
     C                   KFLD                    COCACT
     *
     C     COKY7C        KLIST
     C                   KFLD                    COJOB
     C                   KFLD                    COCOWN
     *
     C     COKY7E        KLIST
     C                   KFLD                    COJOB
     C                   KFLD                    COCOWN
     C                   KFLD                    COTYPR
     C                   KFLD                    COLSE#
     C                   KFLD                    COLSTY
     *
     C     ACCKEE        KLIST
     C                   KFLD                    JOB
     C                   KFLD                    ACCNUM
     *
     C     GRPKEE        KLIST
     C                   KFLD                    JOB
     C                   KFLD                    GRPNUM
     c     #altown       klist
     c                   kfld                    hajob#
     c                   kfld                    aowner
     C                   ENDSR
     *
     *=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-*
     * CHECK AUTHORITY, IF USE AUTH ONLY, & RECORD IS RESTRICTED THEN BLANK OUT ADDRESS.
     C     CHKAUT        BEGSR
 3b  C                   IF        @AUTH  = ' ' OR @AUTH = 'U'
 4b  C                   IF        PRIVCD = 'Y'
     C                   EVAL      CARE   = *BLANKS
     C                   EVAL      CITY16 = *BLANKS
     C                   EVAL      ALTCSZ = *BLANKS
     C                   EVAL      STREET = *BLANKS
     C                   EVAL      STE2A  = *BLANKS
     C                   EVAL      ZIPA   = *BLANKS
     C                   EVAL      ZDASH  = *BLANKS
     C                   EVAL      PLUS4  = *BLANKS
     C                   EVAL      CARE   = '*RESTRICTED*'
     C                   EVAL      CITY16 = '*RESTRICTED*'
     *                  EVAL      ALTCSZ = '*RESTRICTED*'
     C                   EVAL      STREET = '*RESTRICTED*'
 4e  C                   ENDIF
 3e  C                   ENDIF

     C                   ENDSR
     *
     *=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-*
     C     *inzsr        begsr
     * DETERMINE AUTHORITY LEVEL OF USER.
     C                   CALL      'SYAU001CL'                          93
     C                   PARM                    @OBJ
     C                   PARM                    @TYPE
     C                   PARM                    @AUTH
     C                   EVAL      *IN58 = @AUTH <> 'C'
     c                   call      'ADDMAIL'
     **
     c                   call      'GETLIB'
     c                   parm                    libl             10
 3b  c                   if        libl = 'MNRL'
     c                   clear                   libwrk
 3x  c                   else
     c                   eval      libwrk = 'ARKV-' + %subst(libl:1:4)
 3e  c                   endif
     c                   open      mnolf3a
     c                   open      mnolf3g
     C                   endsr
     *=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-*
     *
     c     addpf3        begsr
     c                   clear                   hcadac
     c                   clear                   hcadgr
     c                   clear                   usernm
     c                   clear                   chgdte
     c                   write     mnopr3
     c     ownkey        chain     mnopf3
     c                   endsr
     ******************************************************
      /EJECT
     ******************************************
     c     cpyall        begsr
 3b  c     1             do        ark#          vv                5 0
     c                   eval      lse# = arkl(vv)
     c                   clear                   owner
     c                   clear                   lsetyp
     c                   eval      flag = 'C '
 4b  C                   IF        VV > 1
     C                   MOVE      'N'           FLAG
 4e  C                   ENDIF
     c                   call      'MNARCV003'
     c                   parm                    job
     c                   parm                    lse#
     c                   parm                    sopr
     c                   parm                    lsetyp
     c                   parm                    owner
     c                   parm                    flag              2
     c                   parm                    codate
     c                   parm                    cotime
     c                   parm                    coyrap
     c                   parm                    cocsq#
     c                   parm                    decsav
     c                   eval      shosel = 'N'
 3e  c                   enddo
     ***  TO CLOSE PGM - MNARCV003
     c                   eval      flag = 'EN'
     c                   call      'MNARCV003'
     c                   parm                    job
     c                   parm                    lse#
     c                   parm                    sopr
     c                   parm                    lsetyp
     c                   parm                    owner
     c                   parm                    flag              2
     c                   parm                    codate
     c                   parm                    cotime
     c                   parm                    coyrap
     c                   parm                    cocsq#
     c                   parm                    decsav
     c                   eval      shosel = 'N'
     c                   eval      owner = ownsav
     c                   endsr
     ******************************************
     c     cpyonr        begsr
     c                   clear                   ark#
     c                   clear                   arkl
     c     invkey        setll     mndlfo
     c     invkey        reade     mndlfo                               9292
 3b  c                   dow       *in92 = *off
 3v  c   92              leave
     c                   add       1             ark#
     c                   eval      arkl(ark#) = lse#
     c     invkey        reade     mndlfo                               9292
 3e  c                   enddo
     c                   exsr      cpyall
     c                   clear                   ark#
     c                   clear                   arkl
     c                   clear                   arkvall
     c                   clear                   arkvsw
     c                   clear                   arkv1
     c                   endsr
     **********************************************
     c     chgaldo       begsr
     c                   clear                   aowner
 3b  c                   if        altchg <> 'Y'
 LV  c                   leavesr
 3e  c                   endif
     c                   z-add     job           jobba             7 0
     c                   z-add     lse#          lseba             7 0
     c                   eval      ajob = hajob#
     c                   eval      alse = halse#
     c                   eval      aowner = owner
     c                   eval      nuint = decint
     c                   eval      olri = stypp
     c                   eval      nuri = inta
     c                   eval      olopr = ssopr
     c                   eval      nuopr = sopr
     c                   eval      nuxm = excd
     c                   eval      nupro = procd
     c                   eval      nucd1 = mndxc1
     c                   eval      nucd2 = mndxc2
     c                   eval      nureas = reas
     c                   call      'MNFM01ALDL'
     C                   PARM                    job
     c                   parm                    lse#
     c                   parm                    ajob              7 0
     c                   parm                    alse              7 0
     c     aowner        parm                    aowner            7 0
     c                   parm                    nuint             7 6
     c                   parm                    olri              1 0
     c                   parm                    nuri              2
     c                   parm                    olopr             3 0
     c                   parm                    nuopr             3 0
     c                   parm                    nuxm              1
     c                   parm                    nupro             1
     c                   parm                    nucd1             1
     c                   parm                    nucd2             3
     c                   parm                    nureas            2
 3b  c                   if        nucd2 = 'BAD'
     c                   exfmt     badalt
     c                   clear                   aowner
 3e  c                   endif
     c                   z-add     jobba         job
     c                   z-add     lseba         lse#
     c                   endsr
     ***************************************************
     c     chgalnm       begsr
     *
     c     altoke        klist
     c                   kfld                    hajob#
     c                   kfld                    altonr            7 0
     *
 3b  c                   if        altchg <> 'Y'
 LV  c                   leavesr
 3e  c                   endif
     c                   z-add     job           jobba             7 0
     c                   z-add     lse#          lseba             7 0
     c                   z-add     owner         vbonr             7 0
     c                   eval      ajob = hajob#
     c                   eval      alse = halse#
     **  vb2/13/14      eval      altonr = owner
     c                   eval      altonr = owner
     ***                eval      aowner = owner
 3b  c                   if        aowner = 0
     ****               eval      altonr = 0
     c                   call      'OWNRXREF'
     c                   parm                    job
     c                   parm                    lse#
     c                   parm                    hajob#
     c                   parm                    halse#
     c     altonr        parm                    altonr
 3x  c                   else
     c                   eval      altonr = aowner
 3e  c                   endif
 3b  c                   if        altonr = 0
     c                   exfmt     badalt
 LV  c                   leavesr
 3e  c                   endif
     c     altoke        chain(E)  mnolfo
 3b  c                   if        not %found(mnolfo)
     c                   exfmt     badalt
     c                   z-add     jobba         job
     c                   z-add     lseba         lse#
 LV  c                   leavesr
 3e  c                   endif
     c                   exsr      save3
     c                   read      mndr05
     c                   eval      owner = altonr
     c                   update    mnopr
     C                   EXSR      chgcomm
     c                   exsr      save4
     c                   z-add     vbonr         owner
     c     ownkey        chain(E)  mnolfo
     c                   z-add     jobba         job
     c                   z-add     lseba         lse#
     c                   endsr
     ***************************************************
     c     resoncd       begsr
     *  IF OWNER HAS REASON CODE, GET DESCRIPTION
     C                   MOVE      REAS          MT13RS
     C                   MOVE      REAS          SVREAS
     C                   EVAL      MT13DS = *BLANKS
     C                   EVAL      *IN21 = *OFF
     C                   MOVE      REAS          MT13RS
     C     REAS          CHAIN     MNTPF13                            21
 3b  C                   IF        *IN21 = *OFF
     C                   MOVEL     MT13DS        CHGRSN
 3x  C                   ELSE
     C                   CLEAR                   CHGRSN
 3e  C                   ENDIF
     c                   endsr
     ***************************************************
     c     chgcomm       begsr
     C                   MOVE      M#EMLADR      @EMLADR          60
     C                   MOVE      M#SNDFILE     @SNDFILE          1
            m#job = job;
            m#owner = owner;
           chain(E) (job:owner) mnopf4;
           if %found(mnopf4);
           if      M#SNDFILE = ' ' ;
                   M#SNDFILE = 'N' ;
           endif;
            M#EMLADR = @emladr;
            M#SNDFILE = @sndfile;
            M#SNDFILE = @sndfile;
            M#MINREL  = 'M';
     C     *DATE         MULT      10000.0001    M#CHGDTE
            M#USERNM = @USER;
           UPDATE    MNOPR4;
           ELSE;
            m#job = job;
            m#owner = owner;
            M#EMLADR = @emladr;
            M#SNDFILE = @sndfile;
            M#MINREL  = 'M';
     C     *DATE         MULT      10000.0001    M#CHGDTE
            M#USERNM = @USER;
           WRITE     MNOPR4;
 3e        ENDIF;
     c                   endsr
     ***************************************
     c     resonsl       begsr
     *  CHANGE REASON CODE SELECT/MAINTENANCE
 3b  C                   IF        REAS = *BLANKS
     *
     *  REASON CODE CHANGED TO BLANKS
 4b  C                   IF        *IN46 = *ON
     C                   EVAL      *IN15 = *ON
 4e  C                   ENDIF
     *
 3x  C                   ELSE
     *
     C                   EVAL      MT13DS = *BLANKS
     *
     C                   EVAL      *IN21 = *OFF
 4b  C                   IF        REAS = '? '
     C                             OR REAS = '??'
     C                             OR REAS = ' ?'
     C                   EVAL      *IN21 = *ON
 4x  C                   ELSE
     C                   MOVE      REAS          MT13RS
     ****               MOVEL     RSNLIB        MT13LB
     *    P13KEY        CHAIN     MNTPF13                            21
     C     REAS          CHAIN     MNTPF13                            21
 4e  C                   ENDIF
     *
 4b  C                   IF        *IN21 = *ON
     *
     C                   EVAL      RSCDIN = *BLANKS
     C                   CALL      'MNFM21'
     C                   PARM      *BLANKS       RSCDIN
     *
 5b  C                   IF        RSCDIN <> *BLANKS
     C                   MOVEL     RSCDIN        REAS
 5x  C                   ELSE
     C                   MOVE      SVREAS        REAS
 5e  C                   ENDIF
     ** 8/31/06  VB
 4e  C                   ENDIF
     *
     C                   EVAL      MT13DS = *BLANKS
 4b  C                   IF        REAS <> *BLANKS
     C                   EVAL      *IN21 = *OFF
     C                   MOVE      REAS          MT13RS
     *    P13KEY        CHAIN     MNTPF13                            21
     C     REAS          CHAIN     MNTPF13                            21
     C  N21              MOVEL     MT13DS        CHGRSN
     C   21              EVAL      CHGRSN = 'UNKNOWN'
 4e  C                   ENDIF
     *
 3e  C                   ENDIF
     ***VB 8/31/06      ENDIF
     *
     *  WAS REASON CODE CHANGED ALONE?
 3b  C                   IF        *IN46 = *ON
     C                             AND *IN15 = *OFF
     C                   EVAL      *IN15 = SVREAS <> REAS
 3e  C                   ENDIF
     c                   endsr

     C     OWNJUR        BEGSR

      *==================================================================*
      *  DISPLAY OWNER JUR TOTALS
      *==================================================================*

     C                   CALL      'MXFM05J'                            90
     C                   PARM      *BLANKS       RTNCDE
     C                   PARM                    JOB
     C                   PARM                    OWNER

     C                   ENDSR

      /EJECT
     *************************************************
     ** vb 09/14
     c     getnotc       begsr
     c     xmlkee        klist
     c                   kfld                    job
     c                   kfld                    notcyr
     c                   kfld                    owner
     c                   kfld                    lsetyp
     c                   kfld                    lse#
     *
     c                   clear                   notcyr            4 0
     c                   eval      notcyr = yy
     c     xmlkee        chain(E)  XMLMPF2
 3b  c                   if        not %found(xmlmpf2)
     c                   clear                   Qtodmdy
     c                   clear                   Qthisval1
 3e  c                   endif
     c                   eval      notcdt = %editw(Qtodmdy:'  /  /    ')
     c                   eval      notcval = Qthisval1
     c                   endsr
     ** vb 09/14
     ****************************************************
     *
     OQPRINT    E            HDG            1 17
     O                       #NAME30             43
     O          E            HDG            1
     O                       #CARE               43
     O          E            HDG            1
     O                       #STREET             43
     O          E            HDG            1
     O                       #CITYSTZP           43
      /EJECT
     *
     OMNOPR     E            RELO
     OMNHPR     E            RELH
     OMNDPR     E            RELDL
     OMNDLRO    E            RELDO
     *
**CTDATA PR1
CLRPFM MNDPF1
CLRPFM MNDWPF1
**CTDATA PR2
MNLT04 J(       ) JSC(  ) OPT( ) BEG1(       )
**CTDATA PR3
UTFM01 SEL1(MNFM01) SEL2(  ) NBR1(       ) NBR2(       ) NBR3(       )
**CTDATA PR4
MNLT17EM J(       ) BEG(       ) EMAIL(                                        )
